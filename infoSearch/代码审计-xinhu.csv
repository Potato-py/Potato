ID,敏感函数,漏洞描述,文件路径,漏洞代码行,漏洞详情
1,file_get_contents,文件操作函数中存在变量，可能存在任意文件读取/删除/修改/写入等漏洞,D:\phpstudy_pro\WWW\cms\xinhu\addons\jy_alipay\alipay\aop\AopCertClient.php,第89行,"        $cert = file_get_contents($certPath);
"
2,file_get_contents,文件操作函数中存在变量，可能存在任意文件读取/删除/修改/写入等漏洞,D:\phpstudy_pro\WWW\cms\xinhu\addons\jy_alipay\alipay\aop\AopCertClient.php,第89行,"        $cert = file_get_contents($certPath);
"
3,file_get_contents,文件操作函数中存在变量，可能存在任意文件读取/删除/修改/写入等漏洞,D:\phpstudy_pro\WWW\cms\xinhu\addons\jy_alipay\alipay\aop\AopCertClient.php,第89行,"        $cert = file_get_contents($certPath);
"
4,file_get_contents,文件操作函数中存在变量，可能存在任意文件读取/删除/修改/写入等漏洞,D:\phpstudy_pro\WWW\cms\xinhu\addons\jy_alipay\alipay\aop\AopCertClient.php,第273行,"            $pubKey = file_get_contents($rsaPublicKeyFilePath);
"
5,file_get_contents,文件操作函数中存在变量，可能存在任意文件读取/删除/修改/写入等漏洞,D:\phpstudy_pro\WWW\cms\xinhu\addons\jy_alipay\alipay\aop\AopCertClient.php,第306行,"            $priKey = file_get_contents($this->rsaPrivateKeyFilePath);
"
6,simplexml_load_string,可能存在信息泄露漏洞，读取任意文件,D:\phpstudy_pro\WWW\cms\xinhu\addons\jy_alipay\alipay\aop\AopCertClient.php,第603行,"            $respObject = @ simplexml_load_string($resp);
"
7,simplexml_load_string,可能存在信息泄露漏洞，读取任意文件,D:\phpstudy_pro\WWW\cms\xinhu\addons\jy_alipay\alipay\aop\AopCertClient.php,第632行,"                $respObject = @ simplexml_load_string($r);
"
8,file_get_contents,文件操作函数中存在变量，可能存在任意文件读取/删除/修改/写入等漏洞,D:\phpstudy_pro\WWW\cms\xinhu\addons\jy_alipay\alipay\aop\AopCertClient.php,第306行,"            $priKey = file_get_contents($this->rsaPrivateKeyFilePath);
"
9,file_get_contents,文件操作函数中存在变量，可能存在任意文件读取/删除/修改/写入等漏洞,D:\phpstudy_pro\WWW\cms\xinhu\addons\jy_alipay\alipay\aop\AopCertClient.php,第748行,"            $priKey = file_get_contents($privatekey);
"
10,file_get_contents,文件操作函数中存在变量，可能存在任意文件读取/删除/修改/写入等漏洞,D:\phpstudy_pro\WWW\cms\xinhu\addons\jy_alipay\alipay\aop\AopCertClient.php,第273行,"            $pubKey = file_get_contents($rsaPublicKeyFilePath);
"
11,file_get_contents,文件操作函数中存在变量，可能存在任意文件读取/删除/修改/写入等漏洞,D:\phpstudy_pro\WWW\cms\xinhu\addons\jy_alipay\alipay\aop\AopClient.php,第136行,"            $priKey = file_get_contents($this->rsaPrivateKeyFilePath);
"
12,file_get_contents,文件操作函数中存在变量，可能存在任意文件读取/删除/修改/写入等漏洞,D:\phpstudy_pro\WWW\cms\xinhu\addons\jy_alipay\alipay\aop\AopClient.php,第172行,"            $priKey = file_get_contents($privatekey);
"
13,simplexml_load_string,可能存在信息泄露漏洞，读取任意文件,D:\phpstudy_pro\WWW\cms\xinhu\addons\jy_alipay\alipay\aop\AopClient.php,第564行,"            $respObject = @ simplexml_load_string($resp);
"
14,simplexml_load_string,可能存在信息泄露漏洞，读取任意文件,D:\phpstudy_pro\WWW\cms\xinhu\addons\jy_alipay\alipay\aop\AopClient.php,第600行,"                $respObject = @ simplexml_load_string($r);
"
15,exec,命令执行函数中存在变量，可能存在任意命令执行漏洞,D:\phpstudy_pro\WWW\cms\xinhu\addons\jy_alipay\alipay\aop\AopClient.php,第630行,"    public function exec($paramsArray)
"
16,file_get_contents,文件操作函数中存在变量，可能存在任意文件读取/删除/修改/写入等漏洞,D:\phpstudy_pro\WWW\cms\xinhu\addons\jy_alipay\alipay\aop\AopClient.php,第730行,"            $pubKey = file_get_contents($rsaPublicKeyFilePath);
"
17,file_get_contents,文件操作函数中存在变量，可能存在任意文件读取/删除/修改/写入等漏洞,D:\phpstudy_pro\WWW\cms\xinhu\addons\jy_alipay\alipay\aop\AopClient.php,第730行,"            $pubKey = file_get_contents($rsaPublicKeyFilePath);
"
18,file_get_contents,文件操作函数中存在变量，可能存在任意文件读取/删除/修改/写入等漏洞,D:\phpstudy_pro\WWW\cms\xinhu\addons\jy_alipay\alipay\aop\AopClient.php,第136行,"            $priKey = file_get_contents($this->rsaPrivateKeyFilePath);
"
19,include,"文件包含函数中存在变量,可能存在文件包含漏洞",D:\phpstudy_pro\WWW\cms\xinhu\addons\jy_alipay\alipay\lotusphp_runtime\Autoloader\Autoloader.php,第79行,"				include($functionFile);
"
20,include,"文件包含函数中存在变量,可能存在文件包含漏洞",D:\phpstudy_pro\WWW\cms\xinhu\addons\jy_alipay\alipay\lotusphp_runtime\Autoloader\Autoloader.php,第88行,"			include($classFile);
"
21,file_get_contents,文件操作函数中存在变量，可能存在任意文件读取/删除/修改/写入等漏洞,D:\phpstudy_pro\WWW\cms\xinhu\addons\jy_alipay\alipay\lotusphp_runtime\Autoloader\Autoloader.php,第280行,"				$libNames = $this->parseLibNames(trim(file_get_contents($file)));
"
22,file_get_contents,文件操作函数中存在变量，可能存在任意文件读取/删除/修改/写入等漏洞,D:\phpstudy_pro\WWW\cms\xinhu\addons\jy_alipay\alipay\lotusphp_runtime\Autoloader\Autoloader.php,第293行,"			$libNames = $this->parseLibNames(trim(file_get_contents($file)));
"
23,unserialize,序列化函数，可能存在反序列化漏洞,D:\phpstudy_pro\WWW\cms\xinhu\addons\jy_alipay\alipay\lotusphp_runtime\Cache\Adapter\CacheAdapterEAccelerator.php,第25行,"			return unserialize($value);
"
24,unserialize,序列化函数，可能存在反序列化漏洞,D:\phpstudy_pro\WWW\cms\xinhu\addons\jy_alipay\alipay\lotusphp_runtime\Cache\Adapter\CacheAdapterPhps.php,第53行,"		return unserialize($str);
"
25,copy,文件操作函数中存在变量，可能存在任意文件读取/删除/修改/写入等漏洞,D:\phpstudy_pro\WWW\cms\xinhu\addons\jy_alipay\alipay\lotusphp_runtime\Captcha\CaptchaImageEngine.php,第168行,"            imagecopy($this->im, $this->im,
"
26,copy,文件操作函数中存在变量，可能存在任意文件读取/删除/修改/写入等漏洞,D:\phpstudy_pro\WWW\cms\xinhu\addons\jy_alipay\alipay\lotusphp_runtime\Captcha\CaptchaImageEngine.php,第168行,"            imagecopy($this->im, $this->im,
"
27,foreach,"函数中存在变量,可能存在变量覆盖漏洞",D:\phpstudy_pro\WWW\cms\xinhu\addons\jy_alipay\alipay\lotusphp_runtime\Cookie\Cookie.php,第74行,"				foreach($_COOKIE[$name] as $k => $v)
"
28,foreach,"函数中存在变量,可能存在变量覆盖漏洞",D:\phpstudy_pro\WWW\cms\xinhu\addons\jy_alipay\alipay\lotusphp_runtime\Cookie\Cookie.php,第74行,"				foreach($_COOKIE[$name] as $k => $v)
"
29,exec,命令执行函数中存在变量，可能存在任意命令执行漏洞,D:\phpstudy_pro\WWW\cms\xinhu\addons\jy_alipay\alipay\lotusphp_runtime\DB\Adapter\ConnectionAdapter\DbConnectionAdapter.php,第8行,"	public function exec($sql, $connResource);
"
30,exec,命令执行函数中存在变量，可能存在任意命令执行漏洞,D:\phpstudy_pro\WWW\cms\xinhu\addons\jy_alipay\alipay\lotusphp_runtime\DB\Adapter\ConnectionAdapter\DbConnectionAdapterMysql.php,第9行,"	public function exec($sql, $connResource)
"
31,exec,命令执行函数中存在变量，可能存在任意命令执行漏洞,D:\phpstudy_pro\WWW\cms\xinhu\addons\jy_alipay\alipay\lotusphp_runtime\DB\Adapter\ConnectionAdapter\DbConnectionAdapterMysqli.php,第9行,"	public function exec($sql, $connResource)
"
32,exec,命令执行函数中存在变量，可能存在任意命令执行漏洞,D:\phpstudy_pro\WWW\cms\xinhu\addons\jy_alipay\alipay\lotusphp_runtime\DB\Adapter\ConnectionAdapter\DbConnectionAdapterPdo.php,第41行,"	public function exec($sql, $connResource)
"
33,exec,命令执行函数中存在变量，可能存在任意命令执行漏洞,D:\phpstudy_pro\WWW\cms\xinhu\addons\jy_alipay\alipay\lotusphp_runtime\DB\Adapter\ConnectionAdapter\DbConnectionAdapterPgsql.php,第17行,"	public function exec($sql, $connResource)
"
34,exec,命令执行函数中存在变量，可能存在任意命令执行漏洞,D:\phpstudy_pro\WWW\cms\xinhu\addons\jy_alipay\alipay\lotusphp_runtime\DB\Adapter\ConnectionAdapter\DbConnectionAdapterSqlite.php,第41行,"	public function exec($sql, $connResource)
"
35,fopen,读取文件函数中存在变量，可能存在任意文件读取漏洞,D:\phpstudy_pro\WWW\cms\xinhu\addons\jy_alipay\alipay\lotusphp_runtime\Logger\Logger.php,第24行,"			$this->fileHandle = fopen($this->conf[""log_file""], ""a"");
"
36,fwrite,读取文件函数中存在变量，可能存在任意文件读取漏洞,D:\phpstudy_pro\WWW\cms\xinhu\addons\jy_alipay\alipay\lotusphp_runtime\Logger\Logger.php,第40行,"		fwrite($this->getFileHandle(), $logData);
"
37,$_SERVER['HTTP_X_FORWARDED_FOR'],获取IP地址方式可伪造，HTTP_REFERER可伪造，常见引发SQL注入等漏洞,D:\phpstudy_pro\WWW\cms\xinhu\addons\jy_alipay\alipay\lotusphp_runtime\MVC\Context.php,第83行,"			if (isset($_SERVER['HTTP_X_FORWARDED_FOR']))
"
38,$_SERVER['HTTP_X_FORWARDED_FOR'],获取IP地址方式可伪造，HTTP_REFERER可伪造，常见引发SQL注入等漏洞,D:\phpstudy_pro\WWW\cms\xinhu\addons\jy_alipay\alipay\lotusphp_runtime\MVC\Context.php,第85行,"				$clientIp = $_SERVER['HTTP_X_FORWARDED_FOR'];
"
39,include,"文件包含函数中存在变量,可能存在文件包含漏洞",D:\phpstudy_pro\WWW\cms\xinhu\addons\jy_alipay\alipay\lotusphp_runtime\MVC\TemplateView.php,第76行,"				$tpl_include_files = include($objfile);
"
40,file_get_contents,文件操作函数中存在变量，可能存在任意文件读取/删除/修改/写入等漏洞,D:\phpstudy_pro\WWW\cms\xinhu\addons\jy_alipay\alipay\lotusphp_runtime\MVC\TemplateView.php,第109行,"			$str = file_get_contents($tplfile);
"
41,copy,文件操作函数中存在变量，可能存在任意文件读取/删除/修改/写入等漏洞,D:\phpstudy_pro\WWW\cms\xinhu\addons\jy_alipay\alipay\lotusphp_runtime\MVC\TemplateView.php,第131行,"					copy($objfile . '.tmp', $objfile); // win下不能重命名已经存在的文件
"
42,unlink,文件操作函数中存在变量，可能存在任意文件读取/删除/修改/写入等漏洞,D:\phpstudy_pro\WWW\cms\xinhu\addons\jy_alipay\alipay\lotusphp_runtime\MVC\TemplateView.php,第132行,"					unlink($objfile . '.tmp');
"
43,file_get_contents,文件操作函数中存在变量，可能存在任意文件读取/删除/修改/写入等漏洞,D:\phpstudy_pro\WWW\cms\xinhu\addons\jy_alipay\alipay\lotusphp_runtime\MVC\TemplateView.php,第331行,"					$subTpl = file_get_contents($findfile);
"
44,file_get_contents,文件操作函数中存在变量，可能存在任意文件读取/删除/修改/写入等漏洞,D:\phpstudy_pro\WWW\cms\xinhu\addons\jy_alipay\alipay\lotusphp_runtime\MVC\TemplateView.php,第360行,"					$subTpl = file_get_contents($comfile);
"
45,include,"文件包含函数中存在变量,可能存在文件包含漏洞",D:\phpstudy_pro\WWW\cms\xinhu\addons\jy_alipay\alipay\lotusphp_runtime\MVC\View.php,第19行,"			include($this->layoutDir . $this->layout . '.php');
"
46,include,"文件包含函数中存在变量,可能存在文件包含漏洞",D:\phpstudy_pro\WWW\cms\xinhu\addons\jy_alipay\alipay\lotusphp_runtime\MVC\View.php,第23行,"			include($this->templateDir . $this->template . '.php');
"
47,foreach,"函数中存在变量,可能存在变量覆盖漏洞",D:\phpstudy_pro\WWW\cms\xinhu\addons\jy_alipay\alipay\lotusphp_runtime\Router\Router.php,第83行,"					foreach($_GET as $v)
"
48,foreach,"函数中存在变量,可能存在变量覆盖漏洞",D:\phpstudy_pro\WWW\cms\xinhu\addons\jy_alipay\alipay\lotusphp_runtime\Router\Router.php,第92行,"				foreach($_GET as $v)
"
49,include,"文件包含函数中存在变量,可能存在文件包含漏洞",D:\phpstudy_pro\WWW\cms\xinhu\addons\jy_alipay\alipay\lotusphp_runtime\Config.php,第55行,"			$this->conf = include($configFile);
"
50,file_put_contents,文件操作函数中存在变量，可能存在任意文件读取/删除/修改/写入等漏洞,D:\phpstudy_pro\WWW\cms\xinhu\addons\jy_alipay\alipay\lotusphp_runtime\StoreFile.php,第48行,"		$length = file_put_contents($file, '<?php exit;?>' . $value);
"
51,unlink,文件操作函数中存在变量，可能存在任意文件读取/删除/修改/写入等漏洞,D:\phpstudy_pro\WWW\cms\xinhu\addons\jy_alipay\alipay\lotusphp_runtime\StoreFile.php,第66行,"			return @unlink($file);
"
52,file_get_contents,文件操作函数中存在变量，可能存在任意文件读取/删除/修改/写入等漏洞,D:\phpstudy_pro\WWW\cms\xinhu\addons\jy_alipay\alipay\lotusphp_runtime\StoreFile.php,第83行,"		$str = file_get_contents($file);
"
53,unserialize,序列化函数，可能存在反序列化漏洞,D:\phpstudy_pro\WWW\cms\xinhu\addons\jy_alipay\alipay\lotusphp_runtime\StoreFile.php,第87行,"			$value = unserialize($value);
"
54,file_put_contents,文件操作函数中存在变量，可能存在任意文件读取/删除/修改/写入等漏洞,D:\phpstudy_pro\WWW\cms\xinhu\addons\jy_alipay\alipay\lotusphp_runtime\StoreFile.php,第111行,"			$length = file_put_contents($file, '<?php exit;?>' . $value);
"
55,include,"文件包含函数中存在变量,可能存在文件包含漏洞",D:\phpstudy_pro\WWW\cms\xinhu\addons\jy_alipay\alipay\AopSdk.php,第38行,"include($lotusHome . ""Lotus.php"");
"
56,file_get_contents,文件操作函数中存在变量，可能存在任意文件读取/删除/修改/写入等漏洞,D:\phpstudy_pro\WWW\cms\xinhu\addons\jy_alisms\alisms\Regions\EndpointConfig.php,第21行,"$xml = simplexml_load_string(file_get_contents($endpoint_filename));
"
57,simplexml_load_string,可能存在信息泄露漏洞，读取任意文件,D:\phpstudy_pro\WWW\cms\xinhu\addons\jy_alisms\alisms\Regions\EndpointConfig.php,第21行,"$xml = simplexml_load_string(file_get_contents($endpoint_filename));
"
58,file_get_contents,文件操作函数中存在变量，可能存在任意文件读取/删除/修改/写入等漏洞,D:\phpstudy_pro\WWW\cms\xinhu\addons\jy_alisms\aliyun-php-sdk-core\Regions\EndpointConfig.php,第21行,"$xml = simplexml_load_string(file_get_contents($endpoint_filename));
"
59,simplexml_load_string,可能存在信息泄露漏洞，读取任意文件,D:\phpstudy_pro\WWW\cms\xinhu\addons\jy_alisms\aliyun-php-sdk-core\Regions\EndpointConfig.php,第21行,"$xml = simplexml_load_string(file_get_contents($endpoint_filename));
"
60,require_once,"文件包含函数中存在变量,可能存在文件包含漏洞",D:\phpstudy_pro\WWW\cms\xinhu\addons\jy_alisms\model\send.php,第7行,"require_once($this->plugin_root .'/alisms/sms.php');
"
61,require,"文件包含函数中存在变量,可能存在文件包含漏洞",D:\phpstudy_pro\WWW\cms\xinhu\addons\jy_h5game\custom\actions\welcome.php,第77行,"			require($game_condition_file);
"
62,require,"文件包含函数中存在变量,可能存在文件包含漏洞",D:\phpstudy_pro\WWW\cms\xinhu\addons\jy_h5game\custom\actions\welcome.php,第181行,"			require($game_php_file);
"
63,require,"文件包含函数中存在变量,可能存在文件包含漏洞",D:\phpstudy_pro\WWW\cms\xinhu\addons\jy_h5game\custom\actions\welcome.php,第227行,"				require($game_pc_file);
"
64,require,"文件包含函数中存在变量,可能存在文件包含漏洞",D:\phpstudy_pro\WWW\cms\xinhu\addons\jy_h5game\custom\actions\welcome.php,第292行,"		require($game_php_file);
"
65,unserialize,序列化函数，可能存在反序列化漏洞,D:\phpstudy_pro\WWW\cms\xinhu\addons\jy_weishop\class\goods.php,第425行,"				$labelname = unserialize($goods['labelname']);
"
66,unserialize,序列化函数，可能存在反序列化漏洞,D:\phpstudy_pro\WWW\cms\xinhu\addons\jy_weishop\custom\actions\goods\detail.php,第196行,"			$labelname = unserialize($goods['labelname']);
"
67,extract,函数中存在变量，可能存在变量覆盖漏洞,D:\phpstudy_pro\WWW\cms\xinhu\addons\jy_weishop\custom\actions\verify\page.php,第63行,"		extract($allow);
"
68,unserialize,序列化函数，可能存在反序列化漏洞,D:\phpstudy_pro\WWW\cms\xinhu\addons\jy_weishop\manage\actions\goods\virtual_temp.php,第229行,"			$value=unserialize($item['fields']);
"
69,unserialize,序列化函数，可能存在反序列化漏洞,D:\phpstudy_pro\WWW\cms\xinhu\addons\jy_weishop\manage\actions\goods\virtual_temp.php,第268行,"	$item['fields']=unserialize($item['fields']);
"
70,file_get_contents,文件操作函数中存在变量，可能存在任意文件读取/删除/修改/写入等漏洞,D:\phpstudy_pro\WWW\cms\xinhu\addons\jy_weishop\manage\actions\goods\virtual_temp.php,第405行,"	$data=file_get_contents($file);
"
71,unserialize,序列化函数，可能存在反序列化漏洞,D:\phpstudy_pro\WWW\cms\xinhu\addons\jy_weishop\manage\actions\shop\peisong.php,第185行,"	$areas=unserialize($areas);
"
72,extract,函数中存在变量，可能存在变量覆盖漏洞,D:\phpstudy_pro\WWW\cms\xinhu\addons\jy_weishop\manage\actions\shoph5\verify\page.php,第63行,"		extract($allow);
"
73,copy,文件操作函数中存在变量，可能存在任意文件读取/删除/修改/写入等漏洞,D:\phpstudy_pro\WWW\cms\xinhu\addons\jy_weishop\model\wxcard\updateimg.php,第9行,"			copy($source,$temp);
"
74,require,"文件包含函数中存在变量,可能存在文件包含漏洞",D:\phpstudy_pro\WWW\cms\xinhu\addons\jy_weishop\customfunc.php,第19行,"	require($file);
"
75,file_get_contents,文件操作函数中存在变量，可能存在任意文件读取/删除/修改/写入等漏洞,D:\phpstudy_pro\WWW\cms\xinhu\addons\jy_xiu\custom\actions\scene.php,第7行,"		$fh = file_get_contents($posturl);
"
76,file_get_contents,文件操作函数中存在变量，可能存在任意文件读取/删除/修改/写入等漏洞,D:\phpstudy_pro\WWW\cms\xinhu\addons\jy_xiu\custom\actions\scene.php,第240行,"			//$fh = file_get_contents($posturl);
"
77,file_get_contents,文件操作函数中存在变量，可能存在任意文件读取/删除/修改/写入等漏洞,D:\phpstudy_pro\WWW\cms\xinhu\addons\jy_xiu\custom\actions\scene.php,第252行,"		$fh = file_get_contents($posturl); 
"
78,parse_str,"函数中存在变量,可能存在变量覆盖漏洞",D:\phpstudy_pro\WWW\cms\xinhu\api\uc.php,第34行,"	parse_str(_authcode($code, 'DECODE', UC_KEY), $get);
"
79,unserialize,序列化函数，可能存在反序列化漏洞,D:\phpstudy_pro\WWW\cms\xinhu\api\uc.php,第49行,"	$post = xml_unserialize(file_get_contents('php://input'));
"
80,fopen,读取文件函数中存在变量，可能存在任意文件读取漏洞,D:\phpstudy_pro\WWW\cms\xinhu\api\uc.php,第152行,"		$fp = fopen($cachefile, 'w');
"
81,fwrite,读取文件函数中存在变量，可能存在任意文件读取漏洞,D:\phpstudy_pro\WWW\cms\xinhu\api\uc.php,第162行,"		fwrite($fp, $s);
"
82,fopen,读取文件函数中存在变量，可能存在任意文件读取漏洞,D:\phpstudy_pro\WWW\cms\xinhu\api\uc.php,第152行,"		$fp = fopen($cachefile, 'w');
"
83,fwrite,读取文件函数中存在变量，可能存在任意文件读取漏洞,D:\phpstudy_pro\WWW\cms\xinhu\api\uc.php,第162行,"		fwrite($fp, $s);
"
84,fopen,读取文件函数中存在变量，可能存在任意文件读取漏洞,D:\phpstudy_pro\WWW\cms\xinhu\api\uc.php,第152行,"		$fp = fopen($cachefile, 'w');
"
85,fwrite,读取文件函数中存在变量，可能存在任意文件读取漏洞,D:\phpstudy_pro\WWW\cms\xinhu\api\uc.php,第162行,"		fwrite($fp, $s);
"
86,file_get_contents,文件操作函数中存在变量，可能存在任意文件读取/删除/修改/写入等漏洞,D:\phpstudy_pro\WWW\cms\xinhu\api\uc.php,第196行,"			$configfile = trim(file_get_contents($this->appdir.'./config.inc.php'));
"
87,fopen,读取文件函数中存在变量，可能存在任意文件读取漏洞,D:\phpstudy_pro\WWW\cms\xinhu\api\uc.php,第199行,"			if($fp = @fopen($this->appdir.'./config.inc.php', 'w')) {
"
88,fwrite,读取文件函数中存在变量，可能存在任意文件读取漏洞,D:\phpstudy_pro\WWW\cms\xinhu\api\uc.php,第200行,"				@fwrite($fp, trim($configfile));
"
89,fopen,读取文件函数中存在变量，可能存在任意文件读取漏洞,D:\phpstudy_pro\WWW\cms\xinhu\api\uc.php,第152行,"		$fp = fopen($cachefile, 'w');
"
90,fwrite,读取文件函数中存在变量，可能存在任意文件读取漏洞,D:\phpstudy_pro\WWW\cms\xinhu\api\uc.php,第162行,"		fwrite($fp, $s);
"
91,require_once,"文件包含函数中存在变量,可能存在文件包含漏洞",D:\phpstudy_pro\WWW\cms\xinhu\api\wxapi.php,第664行,"			require_once($dir);
"
92,require_once,"文件包含函数中存在变量,可能存在文件包含漏洞",D:\phpstudy_pro\WWW\cms\xinhu\api\wxapi.php,第672行,"				require_once($dir);
"
93,require_once,"文件包含函数中存在变量,可能存在文件包含漏洞",D:\phpstudy_pro\WWW\cms\xinhu\api\wxapi.php,第677行,"					require_once($file);
"
94,unlink,文件操作函数中存在变量，可能存在任意文件读取/删除/修改/写入等漏洞,D:\phpstudy_pro\WWW\cms\xinhu\common\actions\tools\file.php,第103行,"		@unlink($tempfile);
"
95,file_get_contents,文件操作函数中存在变量，可能存在任意文件读取/删除/修改/写入等漏洞,D:\phpstudy_pro\WWW\cms\xinhu\common\actions\tools\file_upload.php,第69行,"			$data=file_get_contents($first_url);
"
96,file_get_contents,文件操作函数中存在变量，可能存在任意文件读取/删除/修改/写入等漏洞,D:\phpstudy_pro\WWW\cms\xinhu\common\actions\tools\file_upload.php,第69行,"			$data=file_get_contents($first_url);
"
97,file_get_contents,文件操作函数中存在变量，可能存在任意文件读取/删除/修改/写入等漏洞,D:\phpstudy_pro\WWW\cms\xinhu\common\actions\tools\get_template.php,第37行,"				$template=array('template'=>file_get_contents($template_file));
"
98,file_get_contents,文件操作函数中存在变量，可能存在任意文件读取/删除/修改/写入等漏洞,D:\phpstudy_pro\WWW\cms\xinhu\common\actions\tools\get_template.php,第46行,"						$common['list_shows'][$name]=file_get_contents($show_file);
"
99,file_get_contents,文件操作函数中存在变量，可能存在任意文件读取/删除/修改/写入等漏洞,D:\phpstudy_pro\WWW\cms\xinhu\common\actions\tools\get_template.php,第56行,"						$common['list_edits'][$name]=file_get_contents($edit_file);
"
100,file_get_contents,文件操作函数中存在变量，可能存在任意文件读取/删除/修改/写入等漏洞,D:\phpstudy_pro\WWW\cms\xinhu\common\actions\tools\get_template.php,第63行,"					$template['template']=file_get_contents($file);
"
101,file_get_contents,文件操作函数中存在变量，可能存在任意文件读取/删除/修改/写入等漏洞,D:\phpstudy_pro\WWW\cms\xinhu\common\actions\tools\get_template.php,第82行,"				$template=array('template'=>file_get_contents($template_dir.'edit_show/'.$name.'.html'));
"
102,file_get_contents,文件操作函数中存在变量，可能存在任意文件读取/删除/修改/写入等漏洞,D:\phpstudy_pro\WWW\cms\xinhu\common\index.php,第126行,"$html=file_get_contents($mainsource);
"
103,require,"文件包含函数中存在变量,可能存在文件包含漏洞",D:\phpstudy_pro\WWW\cms\xinhu\config\config.php,第60行,"	$_tempconf	= require($_confpath);
"
104,require,"文件包含函数中存在变量,可能存在文件包含漏洞",D:\phpstudy_pro\WWW\cms\xinhu\config\config.php,第70行,"	$config['authorkey'] = require($_confpath);
"
105,include_once,"文件包含函数中存在变量,可能存在文件包含漏洞",D:\phpstudy_pro\WWW\cms\xinhu\config\config.php,第97行,"if(file_exists($_confpath))include_once($_confpath);
"
106,require,"文件包含函数中存在变量,可能存在文件包含漏洞",D:\phpstudy_pro\WWW\cms\xinhu\config\iplogs.php,第9行,"		$iparr 	= require($iplist);
"
107,foreach,"函数中存在变量,可能存在变量覆盖漏洞",D:\phpstudy_pro\WWW\cms\xinhu\config\iplogs.php,第51行,"		foreach($_GET as $k=>$v)$str1.='['.$k.']:'.$v.chr(10).'';
"
108,foreach,"函数中存在变量,可能存在变量覆盖漏洞",D:\phpstudy_pro\WWW\cms\xinhu\config\iplogs.php,第54行,"		foreach($_POST as $k=>$v)$str2.='['.$k.']:'.$v.chr(10).'';
"
109,copy,文件操作函数中存在变量，可能存在任意文件读取/删除/修改/写入等漏洞,D:\phpstudy_pro\WWW\cms\xinhu\core\class\account.php,第231行,"			copy($source,$temp);
"
110,unlink,文件操作函数中存在变量，可能存在任意文件读取/删除/修改/写入等漏洞,D:\phpstudy_pro\WWW\cms\xinhu\core\class\account.php,第238行,"			@unlink($temp);
"
111,unlink,文件操作函数中存在变量，可能存在任意文件读取/删除/修改/写入等漏洞,D:\phpstudy_pro\WWW\cms\xinhu\core\class\account.php,第238行,"			@unlink($temp);
"
112,copy,文件操作函数中存在变量，可能存在任意文件读取/删除/修改/写入等漏洞,D:\phpstudy_pro\WWW\cms\xinhu\core\class\account.php,第231行,"			copy($source,$temp);
"
113,unlink,文件操作函数中存在变量，可能存在任意文件读取/删除/修改/写入等漏洞,D:\phpstudy_pro\WWW\cms\xinhu\core\class\account.php,第238行,"			@unlink($temp);
"
114,file_get_contents,文件操作函数中存在变量，可能存在任意文件读取/删除/修改/写入等漏洞,D:\phpstudy_pro\WWW\cms\xinhu\core\class\account.php,第356行,"						$content=file_get_contents($response['down_url']);
"
115,file_get_contents,文件操作函数中存在变量，可能存在任意文件读取/删除/修改/写入等漏洞,D:\phpstudy_pro\WWW\cms\xinhu\core\class\account.php,第416行,"						$content=file_get_contents($media['url']);	
"
116,copy,文件操作函数中存在变量，可能存在任意文件读取/删除/修改/写入等漏洞,D:\phpstudy_pro\WWW\cms\xinhu\core\class\account.php,第476行,"		copy($source,$temp);
"
117,unlink,文件操作函数中存在变量，可能存在任意文件读取/删除/修改/写入等漏洞,D:\phpstudy_pro\WWW\cms\xinhu\core\class\account.php,第479行,"		@unlink($temp);
"
118,unserialize,序列化函数，可能存在反序列化漏洞,D:\phpstudy_pro\WWW\cms\xinhu\core\class\core.php,第554行,"		$result=@unserialize(base64_decode($bak['content']));
"
119,`$,``反引号中包含变量，变量可控会导致命令执行漏洞,D:\phpstudy_pro\WWW\cms\xinhu\core\class\db.php,第534行,"					$operator = "" = `$fields` + "";
"
120,`$,``反引号中包含变量，变量可控会导致命令执行漏洞,D:\phpstudy_pro\WWW\cms\xinhu\core\class\db.php,第536行,"					$operator = "" = `$fields` - "";
"
121,`$,``反引号中包含变量，变量可控会导致命令执行漏洞,D:\phpstudy_pro\WWW\cms\xinhu\core\class\db.php,第556行,"						$result['fields'] []= ""`$fields` {$operator} "".implode("" and "", $insql);
"
122,`$,``反引号中包含变量，变量可控会导致命令执行漏洞,D:\phpstudy_pro\WWW\cms\xinhu\core\class\db.php,第562行,"						$result['fields'] []= ""`$fields` {$operator} ("".implode("","", $insql)."")"";
"
123,`$,``反引号中包含变量，变量可控会导致命令执行漏洞,D:\phpstudy_pro\WWW\cms\xinhu\core\class\db.php,第572行,"						$result['fields'][]= ""`$fields` {$operator}  :{$suffix}{$fields}1"";
"
124,`$,``反引号中包含变量，变量可控会导致命令执行漏洞,D:\phpstudy_pro\WWW\cms\xinhu\core\class\db.php,第575行,"						$result['fields'][]=  "" FIND_IN_SET(`$fields` ,:{$suffix}$fields )"";
"
125,`$,``反引号中包含变量，变量可控会导致命令执行漏洞,D:\phpstudy_pro\WWW\cms\xinhu\core\class\db.php,第580行,"						$result['fields'][]=  ""`$fields` {$operator}  :{$suffix}$fields"";
"
126,file_get_contents,文件操作函数中存在变量，可能存在任意文件读取/删除/修改/写入等漏洞,D:\phpstudy_pro\WWW\cms\xinhu\core\class\develop.php,第14行,"				$data=file_get_contents($path.$file);
"
127,unlink,文件操作函数中存在变量，可能存在任意文件读取/删除/修改/写入等漏洞,D:\phpstudy_pro\WWW\cms\xinhu\core\class\develop.php,第29行,"						unlink($path.$file);
"
128,unlink,文件操作函数中存在变量，可能存在任意文件读取/删除/修改/写入等漏洞,D:\phpstudy_pro\WWW\cms\xinhu\core\class\develop.php,第29行,"						unlink($path.$file);
"
129,unlink,文件操作函数中存在变量，可能存在任意文件读取/删除/修改/写入等漏洞,D:\phpstudy_pro\WWW\cms\xinhu\core\class\develop.php,第29行,"						unlink($path.$file);
"
130,unlink,文件操作函数中存在变量，可能存在任意文件读取/删除/修改/写入等漏洞,D:\phpstudy_pro\WWW\cms\xinhu\core\class\develop.php,第29行,"						unlink($path.$file);
"
131,unlink,文件操作函数中存在变量，可能存在任意文件读取/删除/修改/写入等漏洞,D:\phpstudy_pro\WWW\cms\xinhu\core\class\develop.php,第29行,"						unlink($path.$file);
"
132,unlink,文件操作函数中存在变量，可能存在任意文件读取/删除/修改/写入等漏洞,D:\phpstudy_pro\WWW\cms\xinhu\core\class\develop.php,第29行,"						unlink($path.$file);
"
133,file_get_contents,文件操作函数中存在变量，可能存在任意文件读取/删除/修改/写入等漏洞,D:\phpstudy_pro\WWW\cms\xinhu\core\class\develop.php,第14行,"				$data=file_get_contents($path.$file);
"
134,unlink,文件操作函数中存在变量，可能存在任意文件读取/删除/修改/写入等漏洞,D:\phpstudy_pro\WWW\cms\xinhu\core\class\develop.php,第197行,"					unlink($path.$file);
"
135,unlink,文件操作函数中存在变量，可能存在任意文件读取/删除/修改/写入等漏洞,D:\phpstudy_pro\WWW\cms\xinhu\core\class\develop.php,第197行,"					unlink($path.$file);
"
136,file_get_contents,文件操作函数中存在变量，可能存在任意文件读取/删除/修改/写入等漏洞,D:\phpstudy_pro\WWW\cms\xinhu\core\class\develop.php,第249行,"				$page_data=file_get_contents($page_html_file);
"
137,file_get_contents,文件操作函数中存在变量，可能存在任意文件读取/删除/修改/写入等漏洞,D:\phpstudy_pro\WWW\cms\xinhu\core\class\develop.php,第255行,"				$pagejs_data=file_get_contents($page_dir.'/index.js');
"
138,file_get_contents,文件操作函数中存在变量，可能存在任意文件读取/删除/修改/写入等漏洞,D:\phpstudy_pro\WWW\cms\xinhu\core\class\develop.php,第263行,"		$app_json=file_get_contents($temp_dir.'/app.json');
"
139,file_get_contents,文件操作函数中存在变量，可能存在任意文件读取/删除/修改/写入等漏洞,D:\phpstudy_pro\WWW\cms\xinhu\core\class\develop.php,第270行,"		$css_json=file_get_contents($temp_dir.'/app.wxss');
"
140,file_get_contents,文件操作函数中存在变量，可能存在任意文件读取/删除/修改/写入等漏洞,D:\phpstudy_pro\WWW\cms\xinhu\core\class\develop.php,第284行,"		$app_js=file_get_contents($temp_dir.'/app.js');
"
141,file_get_contents,文件操作函数中存在变量，可能存在任意文件读取/删除/修改/写入等漏洞,D:\phpstudy_pro\WWW\cms\xinhu\core\class\fans_api.php,第15行,"		$result=file_get_contents($url);
"
142,file_get_contents,文件操作函数中存在变量，可能存在任意文件读取/删除/修改/写入等漏洞,D:\phpstudy_pro\WWW\cms\xinhu\core\class\fans_api.php,第15行,"		$result=file_get_contents($url);
"
143,file_get_contents,文件操作函数中存在变量，可能存在任意文件读取/删除/修改/写入等漏洞,D:\phpstudy_pro\WWW\cms\xinhu\core\class\fans_api.php,第15行,"		$result=file_get_contents($url);
"
144,file_get_contents,文件操作函数中存在变量，可能存在任意文件读取/删除/修改/写入等漏洞,D:\phpstudy_pro\WWW\cms\xinhu\core\class\fans_api.php,第15行,"		$result=file_get_contents($url);
"
145,file_get_contents,文件操作函数中存在变量，可能存在任意文件读取/删除/修改/写入等漏洞,D:\phpstudy_pro\WWW\cms\xinhu\core\class\files.php,第43行,"			$return=file_get_contents($temp);
"
146,unlink,文件操作函数中存在变量，可能存在任意文件读取/删除/修改/写入等漏洞,D:\phpstudy_pro\WWW\cms\xinhu\core\class\files.php,第49行,"		@unlink($temp);
"
147,copy,文件操作函数中存在变量，可能存在任意文件读取/删除/修改/写入等漏洞,D:\phpstudy_pro\WWW\cms\xinhu\core\class\files.php,第164行,"	public function file_copy($src, $des) {
"
148,copy,文件操作函数中存在变量，可能存在任意文件读取/删除/修改/写入等漏洞,D:\phpstudy_pro\WWW\cms\xinhu\core\class\files.php,第170行,"					$this->file_copy($src . '/' . $file, $des . '/' . $file);
"
149,copy,文件操作函数中存在变量，可能存在任意文件读取/删除/修改/写入等漏洞,D:\phpstudy_pro\WWW\cms\xinhu\core\class\files.php,第172行,"					copy($src . '/' . $file, $des . '/' . $file);
"
150,rmdirs,文件操作函数中存在变量，可能存在任意文件读取/删除/修改/写入等漏洞,D:\phpstudy_pro\WWW\cms\xinhu\core\class\files.php,第179行,"	public function rmdirs($path, $hold = false) {
"
151,unlink,文件操作函数中存在变量，可能存在任意文件读取/删除/修改/写入等漏洞,D:\phpstudy_pro\WWW\cms\xinhu\core\class\files.php,第186行,"				is_dir($file) ? $this->rmdirs($file) : @unlink($file);
"
152,rmdirs,文件操作函数中存在变量，可能存在任意文件读取/删除/修改/写入等漏洞,D:\phpstudy_pro\WWW\cms\xinhu\core\class\files.php,第186行,"				is_dir($file) ? $this->rmdirs($file) : @unlink($file);
"
153,file_get_contents,文件操作函数中存在变量，可能存在任意文件读取/删除/修改/写入等漏洞,D:\phpstudy_pro\WWW\cms\xinhu\core\class\files.php,第227行,"		return file_get_contents($file);
"
154,file_get_contents,文件操作函数中存在变量，可能存在任意文件读取/删除/修改/写入等漏洞,D:\phpstudy_pro\WWW\cms\xinhu\core\class\files.php,第230行,"		$data=file_get_contents($url);
"
155,copy,文件操作函数中存在变量，可能存在任意文件读取/删除/修改/写入等漏洞,D:\phpstudy_pro\WWW\cms\xinhu\core\class\files.php,第329行,"			copy($from,ROOT_AT.$filename);
"
156,unlink,文件操作函数中存在变量，可能存在任意文件读取/删除/修改/写入等漏洞,D:\phpstudy_pro\WWW\cms\xinhu\core\class\files.php,第368行,"			@unlink($temp);
"
157,unlink,文件操作函数中存在变量，可能存在任意文件读取/删除/修改/写入等漏洞,D:\phpstudy_pro\WWW\cms\xinhu\core\class\files.php,第371行,"			@unlink($from);
"
158,copy,文件操作函数中存在变量，可能存在任意文件读取/删除/修改/写入等漏洞,D:\phpstudy_pro\WWW\cms\xinhu\core\class\files.php,第460行,"		copy($from,ROOT_AT.$temp);
"
159,unserialize,序列化函数，可能存在反序列化漏洞,D:\phpstudy_pro\WWW\cms\xinhu\core\class\files.php,第499行,"		$res=@unserialize(base64_decode($res));
"
160,copy,文件操作函数中存在变量，可能存在任意文件读取/删除/修改/写入等漏洞,D:\phpstudy_pro\WWW\cms\xinhu\core\class\files.php,第599行,"			copy($srcfile, $desfile);
"
161,copy,文件操作函数中存在变量，可能存在任意文件读取/删除/修改/写入等漏洞,D:\phpstudy_pro\WWW\cms\xinhu\core\class\files.php,第599行,"			copy($srcfile, $desfile);
"
162,fwrite,读取文件函数中存在变量，可能存在任意文件读取漏洞,D:\phpstudy_pro\WWW\cms\xinhu\core\class\http.php,第136行,"			fwrite($fp, $fdata);
"
163,fgets,读取文件函数中存在变量，可能存在任意文件读取漏洞,D:\phpstudy_pro\WWW\cms\xinhu\core\class\http.php,第139行,"				$content .= fgets($fp, 512);
"
164,file_get_contents,文件操作函数中存在变量，可能存在任意文件读取/删除/修改/写入等漏洞,D:\phpstudy_pro\WWW\cms\xinhu\core\class\made_page.php,第51行,"				$temp=file_get_contents($this->root_windows.$item['type'].'.html');
"
165,file_get_contents,文件操作函数中存在变量，可能存在任意文件读取/删除/修改/写入等漏洞,D:\phpstudy_pro\WWW\cms\xinhu\core\class\made_page.php,第79行,"				$temp=file_get_contents($this->root_windows.'modal_search_one.html');
"
166,file_get_contents,文件操作函数中存在变量，可能存在任意文件读取/删除/修改/写入等漏洞,D:\phpstudy_pro\WWW\cms\xinhu\core\class\made_page.php,第81行,"				$temp=file_get_contents($this->root_windows.'search_one.html');
"
167,file_get_contents,文件操作函数中存在变量，可能存在任意文件读取/删除/修改/写入等漏洞,D:\phpstudy_pro\WWW\cms\xinhu\core\class\made_page.php,第100行,"					$temp=file_get_contents($this->root_windows_list_edit.$item['type'].'.html');
"
168,file_get_contents,文件操作函数中存在变量，可能存在任意文件读取/删除/修改/写入等漏洞,D:\phpstudy_pro\WWW\cms\xinhu\core\class\made_page.php,第102行,"					$temp=file_get_contents($this->root_windows_list_show.$item['type'].'.html');
"
169,file_get_contents,文件操作函数中存在变量，可能存在任意文件读取/删除/修改/写入等漏洞,D:\phpstudy_pro\WWW\cms\xinhu\core\class\made_page.php,第100行,"					$temp=file_get_contents($this->root_windows_list_edit.$item['type'].'.html');
"
170,file_get_contents,文件操作函数中存在变量，可能存在任意文件读取/删除/修改/写入等漏洞,D:\phpstudy_pro\WWW\cms\xinhu\core\class\made_page.php,第102行,"					$temp=file_get_contents($this->root_windows_list_show.$item['type'].'.html');
"
171,file_get_contents,文件操作函数中存在变量，可能存在任意文件读取/删除/修改/写入等漏洞,D:\phpstudy_pro\WWW\cms\xinhu\core\class\made_page.php,第129行,"		$list_temp=file_get_contents($this->root_windows.'list.html');
"
172,file_get_contents,文件操作函数中存在变量，可能存在任意文件读取/删除/修改/写入等漏洞,D:\phpstudy_pro\WWW\cms\xinhu\core\class\made_page.php,第170行,"						$temp=file_get_contents($this->root_windows_list_show.$row['type'].'.html');
"
173,file_get_contents,文件操作函数中存在变量，可能存在任意文件读取/删除/修改/写入等漏洞,D:\phpstudy_pro\WWW\cms\xinhu\core\class\made_page.php,第184行,"						$temp=file_get_contents($this->root_windows.$row['type'].'.html');
"
174,file_get_contents,文件操作函数中存在变量，可能存在任意文件读取/删除/修改/写入等漏洞,D:\phpstudy_pro\WWW\cms\xinhu\core\class\made_page.php,第51行,"				$temp=file_get_contents($this->root_windows.$item['type'].'.html');
"
175,file_get_contents,文件操作函数中存在变量，可能存在任意文件读取/删除/修改/写入等漏洞,D:\phpstudy_pro\WWW\cms\xinhu\core\class\made_page.php,第250行,"			$temp=file_get_contents($this->root_windows.'edit_show/'.$item['type'].'.html');
"
176,file_get_contents,文件操作函数中存在变量，可能存在任意文件读取/删除/修改/写入等漏洞,D:\phpstudy_pro\WWW\cms\xinhu\core\class\made_page.php,第279行,"		$temp=file_get_contents($this->root_mobile.$html['type'].'.html');
"
177,file_get_contents,文件操作函数中存在变量，可能存在任意文件读取/删除/修改/写入等漏洞,D:\phpstudy_pro\WWW\cms\xinhu\core\class\made_page.php,第293行,"		$temp=file_get_contents($this->root_windows.$html['type'].'.html');
"
178,file_get_contents,文件操作函数中存在变量，可能存在任意文件读取/删除/修改/写入等漏洞,D:\phpstudy_pro\WWW\cms\xinhu\core\class\module.php,第28行,"			$image=file_get_contents($module['image']);
"
179,require,"文件包含函数中存在变量,可能存在文件包含漏洞",D:\phpstudy_pro\WWW\cms\xinhu\core\class\module.php,第201行,"						require($modulepath . $manifest['uninstall']);
"
180,file_get_contents,文件操作函数中存在变量，可能存在任意文件读取/删除/修改/写入等漏洞,D:\phpstudy_pro\WWW\cms\xinhu\core\class\module.php,第278行,"		$xml = file_get_contents($filename);
"
181,require,"文件包含函数中存在变量,可能存在文件包含漏洞",D:\phpstudy_pro\WWW\cms\xinhu\core\class\plugin.php,第24行,"				$this->default_setting_data=require($default_setting_file);
"
182,require_once,"文件包含函数中存在变量,可能存在文件包含漏洞",D:\phpstudy_pro\WWW\cms\xinhu\core\class\plugin.php,第29行,"				require_once($init_file);
"
183,require,"文件包含函数中存在变量,可能存在文件包含漏洞",D:\phpstudy_pro\WWW\cms\xinhu\core\class\plugin.php,第63行,"				require($init_file);
"
184,require,"文件包含函数中存在变量,可能存在文件包含漏洞",D:\phpstudy_pro\WWW\cms\xinhu\core\class\plugin.php,第72行,"						require($init_file);
"
185,require,"文件包含函数中存在变量,可能存在文件包含漏洞",D:\phpstudy_pro\WWW\cms\xinhu\core\class\plugin.php,第83行,"			return require($file);
"
186,require,"文件包含函数中存在变量,可能存在文件包含漏洞",D:\phpstudy_pro\WWW\cms\xinhu\core\class\plugin.php,第95行,"			$result=require($file);
"
187,file_get_contents,文件操作函数中存在变量，可能存在任意文件读取/删除/修改/写入等漏洞,D:\phpstudy_pro\WWW\cms\xinhu\core\class\plugin.php,第158行,"		$str=file_get_contents($file);
"
188,require_once,"文件包含函数中存在变量,可能存在文件包含漏洞",D:\phpstudy_pro\WWW\cms\xinhu\core\class\plugin.php,第213行,"				require_once($file);
"
189,file_get_contents,文件操作函数中存在变量，可能存在任意文件读取/删除/修改/写入等漏洞,D:\phpstudy_pro\WWW\cms\xinhu\core\class\session_file.php,第32行,"			$row=file_get_contents($file);
"
190,unlink,文件操作函数中存在变量，可能存在任意文件读取/删除/修改/写入等漏洞,D:\phpstudy_pro\WWW\cms\xinhu\core\class\session_file.php,第50行,"		@unlink($file);
"
191,file_get_contents,文件操作函数中存在变量，可能存在任意文件读取/删除/修改/写入等漏洞,D:\phpstudy_pro\WWW\cms\xinhu\core\class\syskefu.php,第14行,"			$res=file_get_contents($url);
"
192,file_get_contents,文件操作函数中存在变量，可能存在任意文件读取/删除/修改/写入等漏洞,D:\phpstudy_pro\WWW\cms\xinhu\core\class\template.php,第98行,"		$html=file_get_contents($mainsource);
"
193,file_get_contents,文件操作函数中存在变量，可能存在任意文件读取/删除/修改/写入等漏洞,D:\phpstudy_pro\WWW\cms\xinhu\core\class\template.php,第172行,"				$search['plugin_head']=file_get_contents($file);
"
194,$_SERVER['HTTP_REFERER'],获取IP地址方式可伪造，HTTP_REFERER可伪造，常见引发SQL注入等漏洞,D:\phpstudy_pro\WWW\cms\xinhu\core\class\tools.php,第169行,"		$_SESSION['referer'] = !empty($_RQ['referer']) ? $_RQ['referer'] : $_SERVER['HTTP_REFERER'];;
"
195,unserialize,序列化函数，可能存在反序列化漏洞,D:\phpstudy_pro\WWW\cms\xinhu\core\class\tools.php,第622行,"		$res=unserialize($res);
"
196,file_get_contents,文件操作函数中存在变量，可能存在任意文件读取/删除/修改/写入等漏洞,D:\phpstudy_pro\WWW\cms\xinhu\core\class\tools.php,第775行,"		$contents = file_get_contents($url);
"
197,file_get_contents,文件操作函数中存在变量，可能存在任意文件读取/删除/修改/写入等漏洞,D:\phpstudy_pro\WWW\cms\xinhu\core\class\tools.php,第799行,"			$qr = file_get_contents($filename);
"
198,unlink,文件操作函数中存在变量，可能存在任意文件读取/删除/修改/写入等漏洞,D:\phpstudy_pro\WWW\cms\xinhu\core\class\tools.php,第801行,"		unlink($filename);
"
199,require,"文件包含函数中存在变量,可能存在文件包含漏洞",D:\phpstudy_pro\WWW\cms\xinhu\core\class\url_diy.php,第16行,"			$url_config=require($config_file);
"
200,unserialize,序列化函数，可能存在反序列化漏洞,D:\phpstudy_pro\WWW\cms\xinhu\core\class\user.php,第82行,"			$config=unserialize(cfc('tools')->base64_decode($config));
"
201,copy,文件操作函数中存在变量，可能存在任意文件读取/删除/修改/写入等漏洞,D:\phpstudy_pro\WWW\cms\xinhu\core\class\wxapp_api.php,第549行,"			copy($source,$temp);
"
202,unlink,文件操作函数中存在变量，可能存在任意文件读取/删除/修改/写入等漏洞,D:\phpstudy_pro\WWW\cms\xinhu\core\class\wxapp_api.php,第556行,"			@unlink($temp);
"
203,unserialize,序列化函数，可能存在反序列化漏洞,D:\phpstudy_pro\WWW\cms\xinhu\core\function\cache.mysql.php,第21行,"		return unserialize($val);
"
204,$_SERVER['HTTP_X_FORWARDED_FOR'],获取IP地址方式可伪造，HTTP_REFERER可伪造，常见引发SQL注入等漏洞,D:\phpstudy_pro\WWW\cms\xinhu\core\function\global.php,第18行,"	} elseif(isset($_SERVER['HTTP_X_FORWARDED_FOR']) AND preg_match_all('#\d{1,3}\.\d{1,3}\.\d{1,3}\.\d{1,3}#s', $_SERVER['HTTP_X_FORWARDED_FOR'], $matches)) {
"
205,file_get_contents,文件操作函数中存在变量，可能存在任意文件读取/删除/修改/写入等漏洞,D:\phpstudy_pro\WWW\cms\xinhu\core\function\global.php,第44行,"	$res=file_get_contents($api_url);
"
206,unserialize,序列化函数，可能存在反序列化漏洞,D:\phpstudy_pro\WWW\cms\xinhu\core\function\global.php,第200行,"	$data=unserialize(cfc('tools')->base64_decode($data));
"
207,require_once,"文件包含函数中存在变量,可能存在文件包含漏洞",D:\phpstudy_pro\WWW\cms\xinhu\core\function\global.php,第335行,"		require_once($plugin_dir.'/core.php');
"
208,unserialize,序列化函数，可能存在反序列化漏洞,D:\phpstudy_pro\WWW\cms\xinhu\core\function\global.php,第433行,"	$result=@unserialize(base64_decode($bak));
"
209,simplexml_load_string,可能存在信息泄露漏洞，读取任意文件,D:\phpstudy_pro\WWW\cms\xinhu\core\function\global.php,第877行,"	return simplexml_load_string($string, $class_name, $options, $ns, $is_prefix);
"
210,simplexml_load_string,可能存在信息泄露漏洞，读取任意文件,D:\phpstudy_pro\WWW\cms\xinhu\core\function\global.php,第877行,"	return simplexml_load_string($string, $class_name, $options, $ns, $is_prefix);
"
211,foreach,"函数中存在变量,可能存在变量覆盖漏洞",D:\phpstudy_pro\WWW\cms\xinhu\core\function\global.php,第1043行,"		foreach($_GET as $k=>$v){
"
212,require_once,"文件包含函数中存在变量,可能存在文件包含漏洞",D:\phpstudy_pro\WWW\cms\xinhu\core\function\global.php,第1293行,"	require_once($dir);
"
213,require_once,"文件包含函数中存在变量,可能存在文件包含漏洞",D:\phpstudy_pro\WWW\cms\xinhu\core\function\global.php,第1330行,"		   require_once($file);
"
214,extract,函数中存在变量，可能存在变量覆盖漏洞,D:\phpstudy_pro\WWW\cms\xinhu\core\library\aes\wxBizMsgCrypt.php,第112行,"		$array = $xmlparse->extract($postData);
"
215,extract,函数中存在变量，可能存在变量覆盖漏洞,D:\phpstudy_pro\WWW\cms\xinhu\core\library\aes\xmlparse.php,第17行,"	public function extract($xmltext)
"
216,file_get_contents,文件操作函数中存在变量，可能存在任意文件读取/删除/修改/写入等漏洞,D:\phpstudy_pro\WWW\cms\xinhu\core\library\alioss\samples\Object.php,第295行,"    if (file_get_contents($localfile) === file_get_contents(__FILE__)) {
"
217,unlink,文件操作函数中存在变量，可能存在任意文件读取/删除/修改/写入等漏洞,D:\phpstudy_pro\WWW\cms\xinhu\core\library\alioss\samples\Object.php,第301行,"        unlink($localfile);
"
218,fopen,读取文件函数中存在变量，可能存在任意文件读取漏洞,D:\phpstudy_pro\WWW\cms\xinhu\core\library\alioss\src\OSS\Core\OssUtil.php,第229行,"        $fp = fopen($filename, ""w"");
"
219,fwrite,读取文件函数中存在变量，可能存在任意文件读取漏洞,D:\phpstudy_pro\WWW\cms\xinhu\core\library\alioss\src\OSS\Core\OssUtil.php,第245行,"                $flag = fwrite($fp, $content);
"
220,fopen,读取文件函数中存在变量，可能存在任意文件读取漏洞,D:\phpstudy_pro\WWW\cms\xinhu\core\library\alioss\src\OSS\Core\OssUtil.php,第283行,"        if (false === $fh = fopen($filename, 'rb')) {
"
221,fread,读取文件函数中存在变量，可能存在任意文件读取漏洞,D:\phpstudy_pro\WWW\cms\xinhu\core\library\alioss\src\OSS\Core\OssUtil.php,第298行,"                $data .= fread($fh, $read_length);
"
222,`$,``反引号中包含变量，变量可控会导致命令执行漏洞,D:\phpstudy_pro\WWW\cms\xinhu\core\library\alioss\src\OSS\Http\RequestCore.php,第390行,"     * EOF or `$size` bytes have been read. If `$size` is not given it will be determined by <php:fstat()> and
"
223,fopen,读取文件函数中存在变量，可能存在任意文件读取漏洞,D:\phpstudy_pro\WWW\cms\xinhu\core\library\alioss\src\OSS\Http\RequestCore.php,第425行,"        $read_file_handle = fopen($location, 'r');
"
224,fopen,读取文件函数中存在变量，可能存在任意文件读取漏洞,D:\phpstudy_pro\WWW\cms\xinhu\core\library\alioss\src\OSS\Http\RequestCore.php,第496行,"            $this->write_file_handle = fopen($this->write_file, 'w');
"
225,fread,读取文件函数中存在变量，可能存在任意文件读取漏洞,D:\phpstudy_pro\WWW\cms\xinhu\core\library\alioss\src\OSS\Http\RequestCore.php,第581行,"        $read = fread($this->read_stream, min($this->read_stream_size - $this->read_stream_read, $length)); // Remaining upload data or cURL's requested chunk size
"
226,fwrite,读取文件函数中存在变量，可能存在任意文件读取漏洞,D:\phpstudy_pro\WWW\cms\xinhu\core\library\alioss\src\OSS\Http\RequestCore.php,第616行,"            $written_last = fwrite($this->write_stream, substr($data, $written_total));
"
227,simplexml_load_string,可能存在信息泄露漏洞，读取任意文件,D:\phpstudy_pro\WWW\cms\xinhu\core\library\alioss\src\OSS\Model\CnameConfig.php,第63行,"        $xml = simplexml_load_string($strXml);
"
228,simplexml_load_string,可能存在信息泄露漏洞，读取任意文件,D:\phpstudy_pro\WWW\cms\xinhu\core\library\alioss\src\OSS\Model\CorsConfig.php,第58行,"        $xml = simplexml_load_string($strXml);
"
229,simplexml_load_string,可能存在信息泄露漏洞，读取任意文件,D:\phpstudy_pro\WWW\cms\xinhu\core\library\alioss\src\OSS\Model\GetLiveChannelHistory.php,第17行,"        $xml = simplexml_load_string($strXml);
"
230,simplexml_load_string,可能存在信息泄露漏洞，读取任意文件,D:\phpstudy_pro\WWW\cms\xinhu\core\library\alioss\src\OSS\Model\GetLiveChannelInfo.php,第42行,"        $xml = simplexml_load_string($strXml);
"
231,simplexml_load_string,可能存在信息泄露漏洞，读取任意文件,D:\phpstudy_pro\WWW\cms\xinhu\core\library\alioss\src\OSS\Model\GetLiveChannelStatus.php,第62行,"        $xml = simplexml_load_string($strXml);
"
232,simplexml_load_string,可能存在信息泄露漏洞，读取任意文件,D:\phpstudy_pro\WWW\cms\xinhu\core\library\alioss\src\OSS\Model\LifecycleConfig.php,第25行,"        $xml = simplexml_load_string($strXml);
"
233,simplexml_load_string,可能存在信息泄露漏洞，读取任意文件,D:\phpstudy_pro\WWW\cms\xinhu\core\library\alioss\src\OSS\Model\LiveChannelConfig.php,第66行,"        $xml = simplexml_load_string($strXml);
"
234,simplexml_load_string,可能存在信息泄露漏洞，读取任意文件,D:\phpstudy_pro\WWW\cms\xinhu\core\library\alioss\src\OSS\Model\LiveChannelHistory.php,第47行,"        $xml = simplexml_load_string($strXml);
"
235,simplexml_load_string,可能存在信息泄露漏洞，读取任意文件,D:\phpstudy_pro\WWW\cms\xinhu\core\library\alioss\src\OSS\Model\LiveChannelInfo.php,第92行,"        $xml = simplexml_load_string($strXml);
"
236,simplexml_load_string,可能存在信息泄露漏洞，读取任意文件,D:\phpstudy_pro\WWW\cms\xinhu\core\library\alioss\src\OSS\Model\LiveChannelListInfo.php,第78行,"        $xml = simplexml_load_string($strXml);
"
237,simplexml_load_string,可能存在信息泄露漏洞，读取任意文件,D:\phpstudy_pro\WWW\cms\xinhu\core\library\alioss\src\OSS\Model\LoggingConfig.php,第30行,"        $xml = simplexml_load_string($strXml);
"
238,simplexml_load_string,可能存在信息泄露漏洞，读取任意文件,D:\phpstudy_pro\WWW\cms\xinhu\core\library\alioss\src\OSS\Model\RefererConfig.php,第19行,"        $xml = simplexml_load_string($strXml);
"
239,simplexml_load_string,可能存在信息泄露漏洞，读取任意文件,D:\phpstudy_pro\WWW\cms\xinhu\core\library\alioss\src\OSS\Model\WebsiteConfig.php,第33行,"        $xml = simplexml_load_string($strXml);
"
240,simplexml_load_string,可能存在信息泄露漏洞，读取任意文件,D:\phpstudy_pro\WWW\cms\xinhu\core\library\alioss\src\OSS\Result\AclResult.php,第25行,"        $xml = simplexml_load_string($content);
"
241,simplexml_load_string,可能存在信息泄露漏洞，读取任意文件,D:\phpstudy_pro\WWW\cms\xinhu\core\library\alioss\src\OSS\Result\CopyObjectResult.php,第18行,"        $xml = simplexml_load_string($body); 
"
242,simplexml_load_string,可能存在信息泄露漏洞，读取任意文件,D:\phpstudy_pro\WWW\cms\xinhu\core\library\alioss\src\OSS\Result\DeleteObjectsResult.php,第18行,"        $xml = simplexml_load_string($body); 
"
243,simplexml_load_string,可能存在信息泄露漏洞，读取任意文件,D:\phpstudy_pro\WWW\cms\xinhu\core\library\alioss\src\OSS\Result\GetLocationResult.php,第27行,"        $xml = simplexml_load_string($content);
"
244,simplexml_load_string,可能存在信息泄露漏洞，读取任意文件,D:\phpstudy_pro\WWW\cms\xinhu\core\library\alioss\src\OSS\Result\GetStorageCapacityResult.php,第27行,"        $xml = simplexml_load_string($content);
"
245,simplexml_load_string,可能存在信息泄露漏洞，读取任意文件,D:\phpstudy_pro\WWW\cms\xinhu\core\library\alioss\src\OSS\Result\InitiateMultipartUploadResult.php,第23行,"        $xml = simplexml_load_string($content);
"
246,simplexml_load_string,可能存在信息泄露漏洞，读取任意文件,D:\phpstudy_pro\WWW\cms\xinhu\core\library\alioss\src\OSS\Result\ListMultipartUploadResult.php,第24行,"        $xml = simplexml_load_string($content);
"
247,simplexml_load_string,可能存在信息泄露漏洞，读取任意文件,D:\phpstudy_pro\WWW\cms\xinhu\core\library\alioss\src\OSS\Result\ListPartsResult.php,第23行,"        $xml = simplexml_load_string($content);
"
248,simplexml_load_string,可能存在信息泄露漏洞，读取任意文件,D:\phpstudy_pro\WWW\cms\xinhu\core\library\alioss\src\OSS\Result\Result.php,第112行,"        $xml = simplexml_load_string($body);
"
249,simplexml_load_string,可能存在信息泄露漏洞，读取任意文件,D:\phpstudy_pro\WWW\cms\xinhu\core\library\alioss\src\OSS\Result\Result.php,第112行,"        $xml = simplexml_load_string($body);
"
250,parse_str,"函数中存在变量,可能存在变量覆盖漏洞",D:\phpstudy_pro\WWW\cms\xinhu\core\library\alioss\tests\OSS\Tests\BucketLiveChannelTest.php,第190行,"        parse_str($ret['query'], $query);
"
251,exec,命令执行函数中存在变量，可能存在任意命令执行漏洞,D:\phpstudy_pro\WWW\cms\xinhu\core\library\alioss\tests\OSS\Tests\ContentTypeTest.php,第13行,"        exec($cmd . ' 2>/dev/null', $output, $status);
"
252,unlink,文件操作函数中存在变量，可能存在任意文件读取/删除/修改/写入等漏洞,D:\phpstudy_pro\WWW\cms\xinhu\core\library\alioss\tests\OSS\Tests\OssClientMultipartUploadTest.php,第40行,"        unlink($bigFileName);
"
253,unlink,文件操作函数中存在变量，可能存在任意文件读取/删除/修改/写入等漏洞,D:\phpstudy_pro\WWW\cms\xinhu\core\library\alioss\tests\OSS\Tests\OssClientMultipartUploadTest.php,第41行,"        unlink($localFilename);
"
254,unlink,文件操作函数中存在变量，可能存在任意文件读取/删除/修改/写入等漏洞,D:\phpstudy_pro\WWW\cms\xinhu\core\library\alioss\tests\OSS\Tests\OssClientMultipartUploadTest.php,第63行,"    	unlink($bigFileName);
"
255,unlink,文件操作函数中存在变量，可能存在任意文件读取/删除/修改/写入等漏洞,D:\phpstudy_pro\WWW\cms\xinhu\core\library\alioss\tests\OSS\Tests\OssClientMultipartUploadTest.php,第64行,"    	unlink($localFilename);
"
256,file_get_contents,文件操作函数中存在变量，可能存在任意文件读取/删除/修改/写入等漏洞,D:\phpstudy_pro\WWW\cms\xinhu\core\library\alioss\tests\OSS\Tests\OssClientObjectTest.php,第185行,"        $this->assertTrue(file_get_contents($localfile) === file_get_contents(__FILE__));
"
257,unlink,文件操作函数中存在变量，可能存在任意文件读取/删除/修改/写入等漏洞,D:\phpstudy_pro\WWW\cms\xinhu\core\library\alioss\tests\OSS\Tests\OssClientObjectTest.php,第187行,"            unlink($localfile);
"
258,unlink,文件操作函数中存在变量，可能存在任意文件读取/删除/修改/写入等漏洞,D:\phpstudy_pro\WWW\cms\xinhu\core\library\alioss\tests\OSS\Tests\OssUtilTest.php,第155行,"        unlink($path);
"
259,fwrite,读取文件函数中存在变量，可能存在任意文件读取漏洞,D:\phpstudy_pro\WWW\cms\xinhu\core\library\alipay\lib\alipay_core.function.php,第79行,"	fwrite($fp,""执行日期："".strftime(""%Y%m%d%H%M%S"",time()).""\n"".$word.""\n"");
"
260,file_put_contents,文件操作函数中存在变量，可能存在任意文件读取/删除/修改/写入等漏洞,D:\phpstudy_pro\WWW\cms\xinhu\core\library\barcode\class\drawer\BCGDrawJPG.php,第14行,"    function file_put_contents($filename, $data) {
"
261,fopen,读取文件函数中存在变量，可能存在任意文件读取漏洞,D:\phpstudy_pro\WWW\cms\xinhu\core\library\barcode\class\drawer\BCGDrawJPG.php,第15行,"        $f = @fopen($filename, 'w');
"
262,fwrite,读取文件函数中存在变量，可能存在任意文件读取漏洞,D:\phpstudy_pro\WWW\cms\xinhu\core\library\barcode\class\drawer\BCGDrawJPG.php,第19行,"            $bytes = fwrite($f, $data);
"
263,ob_start,"函数中存在变量,可能存在变量覆盖漏洞",D:\phpstudy_pro\WWW\cms\xinhu\core\library\barcode\class\drawer\BCGDrawJPG.php,第65行,"        ob_start();
"
264,file_put_contents,文件操作函数中存在变量，可能存在任意文件读取/删除/修改/写入等漏洞,D:\phpstudy_pro\WWW\cms\xinhu\core\library\barcode\class\drawer\BCGDrawJPG.php,第75行,"            file_put_contents($this->filename, $bin);
"
265,file_put_contents,文件操作函数中存在变量，可能存在任意文件读取/删除/修改/写入等漏洞,D:\phpstudy_pro\WWW\cms\xinhu\core\library\barcode\class\drawer\BCGDrawPNG.php,第14行,"    function file_put_contents($filename, $data) {
"
266,fopen,读取文件函数中存在变量，可能存在任意文件读取漏洞,D:\phpstudy_pro\WWW\cms\xinhu\core\library\barcode\class\drawer\BCGDrawPNG.php,第15行,"        $f = @fopen($filename, 'w');
"
267,fwrite,读取文件函数中存在变量，可能存在任意文件读取漏洞,D:\phpstudy_pro\WWW\cms\xinhu\core\library\barcode\class\drawer\BCGDrawPNG.php,第19行,"            $bytes = fwrite($f, $data);
"
268,ob_start,"函数中存在变量,可能存在变量覆盖漏洞",D:\phpstudy_pro\WWW\cms\xinhu\core\library\barcode\class\drawer\BCGDrawPNG.php,第55行,"        ob_start();
"
269,file_put_contents,文件操作函数中存在变量，可能存在任意文件读取/删除/修改/写入等漏洞,D:\phpstudy_pro\WWW\cms\xinhu\core\library\barcode\class\drawer\BCGDrawPNG.php,第65行,"            file_put_contents($this->filename, $bin);
"
270,copy,文件操作函数中存在变量，可能存在任意文件读取/删除/修改/写入等漏洞,D:\phpstudy_pro\WWW\cms\xinhu\core\library\barcode\class\BCGDrawing.php,第222行,"            imagecopy($newimg, $this->im, 0, 0, 0, 0, $w, $h);
"
271,copy,文件操作函数中存在变量，可能存在任意文件读取/删除/修改/写入等漏洞,D:\phpstudy_pro\WWW\cms\xinhu\core\library\barcode\class\BCGFontPhp.php,第147行,"            imagecopy($im, $gd, $x, $y, 0, 0, imagesx($gd), imagesy($gd));
"
272,copy,文件操作函数中存在变量，可能存在任意文件读取/删除/修改/写入等漏洞,D:\phpstudy_pro\WWW\cms\xinhu\core\library\barcode\class\JoinDraw.php,第181行,"        imagecopy($this->im, $this->image1, $posX1, $posY1, 0, 0, $w1, $h1);
"
273,copy,文件操作函数中存在变量，可能存在任意文件读取/删除/修改/写入等漏洞,D:\phpstudy_pro\WWW\cms\xinhu\core\library\barcode\class\JoinDraw.php,第182行,"        imagecopy($this->im, $this->image2, $posX2, $posY2, 0, 0, $w2, $h2);
"
274,file_get_contents,文件操作函数中存在变量，可能存在任意文件读取/删除/修改/写入等漏洞,D:\phpstudy_pro\WWW\cms\xinhu\core\library\cos\src\qcloud\cos\Api.php,第401行,"        $data['filecontent'] = file_get_contents($srcPath);
"
275,fopen,读取文件函数中存在变量，可能存在任意文件读取漏洞,D:\phpstudy_pro\WWW\cms\xinhu\core\library\cos\src\qcloud\cos\HttpClient.php,第170行,"        $fp = fopen($dstPath, 'wb');
"
276,file_get_contents,文件操作函数中存在变量，可能存在任意文件读取/删除/修改/写入等漏洞,D:\phpstudy_pro\WWW\cms\xinhu\core\library\cos\src\qcloud\cos\SliceUploading.php,第137行,"            $sliceContent = file_get_contents($this->srcFpath, false, null, $this->offset, $this->sliceSize);
"
277,file_get_contents,文件操作函数中存在变量，可能存在任意文件读取/删除/修改/写入等漏洞,D:\phpstudy_pro\WWW\cms\xinhu\core\library\cos\src\qcloud\cos\SliceUploading.php,第284行,"        $nextSliceContent = file_get_contents($this->srcFpath, false, null, $this->offset, $this->sliceSize);
"
278,fopen,读取文件函数中存在变量，可能存在任意文件读取漏洞,D:\phpstudy_pro\WWW\cms\xinhu\core\library\ftp\ftp.php,第185行,"		if($fp = @fopen($localpath, 'rb')) {
"
279,unserialize,序列化函数，可能存在反序列化漏洞,D:\phpstudy_pro\WWW\cms\xinhu\core\library\phpexcel\PHPExcel\CachedObjectStorage\APC.php,第156行,"        $this->_currentObject = unserialize($obj);
"
280,fwrite,读取文件函数中存在变量，可能存在任意文件读取漏洞,D:\phpstudy_pro\WWW\cms\xinhu\core\library\phpexcel\PHPExcel\CachedObjectStorage\DiscISAM.php,第73行,"			fwrite($this->_fileHandle, serialize($this->_currentObject));
"
281,fread,读取文件函数中存在变量，可能存在任意文件读取漏洞,D:\phpstudy_pro\WWW\cms\xinhu\core\library\phpexcel\PHPExcel\CachedObjectStorage\DiscISAM.php,第126行,"		$this->_currentObject = unserialize(fread($this->_fileHandle,$this->_cellCache[$pCoord]['sz']));
"
282,unserialize,序列化函数，可能存在反序列化漏洞,D:\phpstudy_pro\WWW\cms\xinhu\core\library\phpexcel\PHPExcel\CachedObjectStorage\DiscISAM.php,第126行,"		$this->_currentObject = unserialize(fread($this->_fileHandle,$this->_cellCache[$pCoord]['sz']));
"
283,fopen,读取文件函数中存在变量，可能存在任意文件读取漏洞,D:\phpstudy_pro\WWW\cms\xinhu\core\library\phpexcel\PHPExcel\CachedObjectStorage\DiscISAM.php,第164行,"		$this->_fileHandle = fopen($this->_fileName,'a+');
"
284,fopen,读取文件函数中存在变量，可能存在任意文件读取漏洞,D:\phpstudy_pro\WWW\cms\xinhu\core\library\phpexcel\PHPExcel\CachedObjectStorage\DiscISAM.php,第203行,"			$this->_fileHandle = fopen($this->_fileName,'a+');
"
285,unlink,文件操作函数中存在变量，可能存在任意文件读取/删除/修改/写入等漏洞,D:\phpstudy_pro\WWW\cms\xinhu\core\library\phpexcel\PHPExcel\CachedObjectStorage\DiscISAM.php,第214行,"			unlink($this->_fileName);
"
286,unserialize,序列化函数，可能存在反序列化漏洞,D:\phpstudy_pro\WWW\cms\xinhu\core\library\phpexcel\PHPExcel\CachedObjectStorage\Igbinary.php,第98行,"		$this->_currentObject = igbinary_unserialize($this->_cellCache[$pCoord]);
"
287,unserialize,序列化函数，可能存在反序列化漏洞,D:\phpstudy_pro\WWW\cms\xinhu\core\library\phpexcel\PHPExcel\CachedObjectStorage\Memcache.php,第160行,"		$this->_currentObject = unserialize($obj);
"
288,unserialize,序列化函数，可能存在反序列化漏洞,D:\phpstudy_pro\WWW\cms\xinhu\core\library\phpexcel\PHPExcel\CachedObjectStorage\MemoryGZip.php,第98行,"		$this->_currentObject = unserialize(gzinflate($this->_cellCache[$pCoord]));
"
289,unserialize,序列化函数，可能存在反序列化漏洞,D:\phpstudy_pro\WWW\cms\xinhu\core\library\phpexcel\PHPExcel\CachedObjectStorage\MemorySerialized.php,第98行,"		$this->_currentObject = unserialize($this->_cellCache[$pCoord]);
"
290,fwrite,读取文件函数中存在变量，可能存在任意文件读取漏洞,D:\phpstudy_pro\WWW\cms\xinhu\core\library\phpexcel\PHPExcel\CachedObjectStorage\PHPTemp.php,第65行,"			fwrite($this->_fileHandle, serialize($this->_currentObject));
"
291,fread,读取文件函数中存在变量，可能存在任意文件读取漏洞,D:\phpstudy_pro\WWW\cms\xinhu\core\library\phpexcel\PHPExcel\CachedObjectStorage\PHPTemp.php,第118行,"		$this->_currentObject = unserialize(fread($this->_fileHandle,$this->_cellCache[$pCoord]['sz']));
"
292,unserialize,序列化函数，可能存在反序列化漏洞,D:\phpstudy_pro\WWW\cms\xinhu\core\library\phpexcel\PHPExcel\CachedObjectStorage\PHPTemp.php,第118行,"		$this->_currentObject = unserialize(fread($this->_fileHandle,$this->_cellCache[$pCoord]['sz']));
"
293,fwrite,读取文件函数中存在变量，可能存在任意文件读取漏洞,D:\phpstudy_pro\WWW\cms\xinhu\core\library\phpexcel\PHPExcel\CachedObjectStorage\PHPTemp.php,第154行,"			fwrite($newFileHandle,fread($this->_fileHandle, 1024));
"
294,fread,读取文件函数中存在变量，可能存在任意文件读取漏洞,D:\phpstudy_pro\WWW\cms\xinhu\core\library\phpexcel\PHPExcel\CachedObjectStorage\PHPTemp.php,第154行,"			fwrite($newFileHandle,fread($this->_fileHandle, 1024));
"
295,unserialize,序列化函数，可能存在反序列化漏洞,D:\phpstudy_pro\WWW\cms\xinhu\core\library\phpexcel\PHPExcel\CachedObjectStorage\SQLite.php,第118行,"		$this->_currentObject = unserialize($cellResult);
"
296,unserialize,序列化函数，可能存在反序列化漏洞,D:\phpstudy_pro\WWW\cms\xinhu\core\library\phpexcel\PHPExcel\CachedObjectStorage\SQLite3.php,第150行,"		$this->_currentObject = unserialize($cellData['value']);
"
297,unserialize,序列化函数，可能存在反序列化漏洞,D:\phpstudy_pro\WWW\cms\xinhu\core\library\phpexcel\PHPExcel\CachedObjectStorage\Wincache.php,第160行,"		$this->_currentObject = unserialize($obj);
"
298,array_map,参数包含变量，变量可控可能会导致代码执行漏洞,D:\phpstudy_pro\WWW\cms\xinhu\core\library\phpexcel\PHPExcel\Calculation\Database.php,第69行,"		$fieldNames = array_map('strtoupper',array_shift($database));
"
299,fopen,读取文件函数中存在变量，可能存在任意文件读取漏洞,D:\phpstudy_pro\WWW\cms\xinhu\core\library\phpexcel\PHPExcel\Reader\Abstract.php,第200行,"		$this->_fileHandle = fopen($pFilename, 'r');
"
300,fgets,读取文件函数中存在变量，可能存在任意文件读取漏洞,D:\phpstudy_pro\WWW\cms\xinhu\core\library\phpexcel\PHPExcel\Reader\CSV.php,第151行,"				fgets($this->_fileHandle, 4) == ""\xEF\xBB\xBF"" ?
"
301,fgets,读取文件函数中存在变量，可能存在任意文件读取漏洞,D:\phpstudy_pro\WWW\cms\xinhu\core\library\phpexcel\PHPExcel\Reader\CSV.php,第155行,"				fgets($this->_fileHandle, 3) == ""\xFF\xFE"" ?
"
302,fgets,读取文件函数中存在变量，可能存在任意文件读取漏洞,D:\phpstudy_pro\WWW\cms\xinhu\core\library\phpexcel\PHPExcel\Reader\CSV.php,第159行,"				fgets($this->_fileHandle, 3) == ""\xFE\xFF"" ?
"
303,fgets,读取文件函数中存在变量，可能存在任意文件读取漏洞,D:\phpstudy_pro\WWW\cms\xinhu\core\library\phpexcel\PHPExcel\Reader\CSV.php,第163行,"				fgets($this->_fileHandle, 5) == ""\xFF\xFE\x00\x00"" ?
"
304,fgets,读取文件函数中存在变量，可能存在任意文件读取漏洞,D:\phpstudy_pro\WWW\cms\xinhu\core\library\phpexcel\PHPExcel\Reader\CSV.php,第167行,"				fgets($this->_fileHandle, 5) == ""\x00\x00\xFE\xFF"" ?
"
305,fread,读取文件函数中存在变量，可能存在任意文件读取漏洞,D:\phpstudy_pro\WWW\cms\xinhu\core\library\phpexcel\PHPExcel\Reader\Excel2003XML.php,第100行,"		$data = fread($fileHandle, 2048);
"
306,simplexml_load_string,可能存在信息泄露漏洞，读取任意文件,D:\phpstudy_pro\WWW\cms\xinhu\core\library\phpexcel\PHPExcel\Reader\Excel2007.php,第95行,"			$rels = simplexml_load_string($this->_getFromZipArchive($zip, ""_rels/.rels""));
"
307,simplexml_load_string,可能存在信息泄露漏洞，读取任意文件,D:\phpstudy_pro\WWW\cms\xinhu\core\library\phpexcel\PHPExcel\Reader\Excel2007.php,第134行,"		$rels = simplexml_load_string(
"
308,simplexml_load_string,可能存在信息泄露漏洞，读取任意文件,D:\phpstudy_pro\WWW\cms\xinhu\core\library\phpexcel\PHPExcel\Reader\Excel2007.php,第140行,"					$xmlWorkbook = simplexml_load_string(
"
309,simplexml_load_string,可能存在信息泄露漏洞，读取任意文件,D:\phpstudy_pro\WWW\cms\xinhu\core\library\phpexcel\PHPExcel\Reader\Excel2007.php,第177行,"		$rels = simplexml_load_string($this->_getFromZipArchive($zip, ""_rels/.rels"")); //~ http://schemas.openxmlformats.org/package/2006/relationships"");
"
310,simplexml_load_string,可能存在信息泄露漏洞，读取任意文件,D:\phpstudy_pro\WWW\cms\xinhu\core\library\phpexcel\PHPExcel\Reader\Excel2007.php,第181行,"				$relsWorkbook = simplexml_load_string($this->_getFromZipArchive($zip, ""$dir/_rels/"" . basename($rel[""Target""]) . "".rels""));  //~ http://schemas.openxmlformats.org/package/2006/relationships"");
"
311,simplexml_load_string,可能存在信息泄露漏洞，读取任意文件,D:\phpstudy_pro\WWW\cms\xinhu\core\library\phpexcel\PHPExcel\Reader\Excel2007.php,第191行,"				$xmlWorkbook = simplexml_load_string($this->_getFromZipArchive($zip, ""{$rel['Target']}""));  //~ http://schemas.openxmlformats.org/spreadsheetml/2006/main"");
"
312,simplexml_load_string,可能存在信息泄露漏洞，读取任意文件,D:\phpstudy_pro\WWW\cms\xinhu\core\library\phpexcel\PHPExcel\Reader\Excel2007.php,第357行,"		$wbRels = simplexml_load_string($this->_getFromZipArchive($zip, ""xl/_rels/workbook.xml.rels"")); //~ http://schemas.openxmlformats.org/package/2006/relationships"");
"
313,simplexml_load_string,可能存在信息泄露漏洞，读取任意文件,D:\phpstudy_pro\WWW\cms\xinhu\core\library\phpexcel\PHPExcel\Reader\Excel2007.php,第364行,"					$xmlTheme = simplexml_load_string($this->_getFromZipArchive($zip, ""xl/{$rel['Target']}""));
"
314,simplexml_load_string,可能存在信息泄露漏洞，读取任意文件,D:\phpstudy_pro\WWW\cms\xinhu\core\library\phpexcel\PHPExcel\Reader\Excel2007.php,第177行,"		$rels = simplexml_load_string($this->_getFromZipArchive($zip, ""_rels/.rels"")); //~ http://schemas.openxmlformats.org/package/2006/relationships"");
"
315,simplexml_load_string,可能存在信息泄露漏洞，读取任意文件,D:\phpstudy_pro\WWW\cms\xinhu\core\library\phpexcel\PHPExcel\Reader\Excel2007.php,第398行,"					$xmlCore = simplexml_load_string($this->_getFromZipArchive($zip, ""{$rel['Target']}""));
"
316,simplexml_load_string,可能存在信息泄露漏洞，读取任意文件,D:\phpstudy_pro\WWW\cms\xinhu\core\library\phpexcel\PHPExcel\Reader\Excel2007.php,第398行,"					$xmlCore = simplexml_load_string($this->_getFromZipArchive($zip, ""{$rel['Target']}""));
"
317,simplexml_load_string,可能存在信息泄露漏洞，读取任意文件,D:\phpstudy_pro\WWW\cms\xinhu\core\library\phpexcel\PHPExcel\Reader\Excel2007.php,第398行,"					$xmlCore = simplexml_load_string($this->_getFromZipArchive($zip, ""{$rel['Target']}""));
"
318,simplexml_load_string,可能存在信息泄露漏洞，读取任意文件,D:\phpstudy_pro\WWW\cms\xinhu\core\library\phpexcel\PHPExcel\Reader\Excel2007.php,第448行,"					$relsWorkbook = simplexml_load_string($this->_getFromZipArchive($zip, ""$dir/_rels/"" . basename($rel[""Target""]) . "".rels""));  //~ http://schemas.openxmlformats.org/package/2006/relationships"");
"
319,simplexml_load_string,可能存在信息泄露漏洞，读取任意文件,D:\phpstudy_pro\WWW\cms\xinhu\core\library\phpexcel\PHPExcel\Reader\Excel2007.php,第453行,"					$xmlStrings = simplexml_load_string($this->_getFromZipArchive($zip, ""$dir/$xpath[Target]""));  //~ http://schemas.openxmlformats.org/spreadsheetml/2006/main"");
"
320,simplexml_load_string,可能存在信息泄露漏洞，读取任意文件,D:\phpstudy_pro\WWW\cms\xinhu\core\library\phpexcel\PHPExcel\Reader\Excel2007.php,第474行,"					$xmlStyles = simplexml_load_string($this->_getFromZipArchive($zip, ""$dir/$xpath[Target]"")); //~ http://schemas.openxmlformats.org/spreadsheetml/2006/main"");
"
321,simplexml_load_string,可能存在信息泄露漏洞，读取任意文件,D:\phpstudy_pro\WWW\cms\xinhu\core\library\phpexcel\PHPExcel\Reader\Excel2007.php,第572行,"					$xmlWorkbook = simplexml_load_string($this->_getFromZipArchive($zip, ""{$rel['Target']}""));  //~ http://schemas.openxmlformats.org/spreadsheetml/2006/main"");
"
322,simplexml_load_string,可能存在信息泄露漏洞，读取任意文件,D:\phpstudy_pro\WWW\cms\xinhu\core\library\phpexcel\PHPExcel\Reader\Excel2007.php,第615行,"							$xmlSheet = simplexml_load_string($this->_getFromZipArchive($zip, ""$dir/$fileWorksheet""));  //~ http://schemas.openxmlformats.org/spreadsheetml/2006/main"");
"
323,simplexml_load_string,可能存在信息泄露漏洞，读取任意文件,D:\phpstudy_pro\WWW\cms\xinhu\core\library\phpexcel\PHPExcel\Reader\Excel2007.php,第1197行,"									$relsWorksheet = simplexml_load_string($this->_getFromZipArchive($zip,  dirname(""$dir/$fileWorksheet"") . ""/_rels/"" . basename($fileWorksheet) . "".rels"") ); //~ http://schemas.openxmlformats.org/package/2006/relationships"");
"
324,simplexml_load_string,可能存在信息泄露漏洞，读取任意文件,D:\phpstudy_pro\WWW\cms\xinhu\core\library\phpexcel\PHPExcel\Reader\Excel2007.php,第1197行,"									$relsWorksheet = simplexml_load_string($this->_getFromZipArchive($zip,  dirname(""$dir/$fileWorksheet"") . ""/_rels/"" . basename($fileWorksheet) . "".rels"") ); //~ http://schemas.openxmlformats.org/package/2006/relationships"");
"
325,simplexml_load_string,可能存在信息泄露漏洞，读取任意文件,D:\phpstudy_pro\WWW\cms\xinhu\core\library\phpexcel\PHPExcel\Reader\Excel2007.php,第1253行,"									$commentsFile = simplexml_load_string($this->_getFromZipArchive($zip, $relPath) );
"
326,simplexml_load_string,可能存在信息泄露漏洞，读取任意文件,D:\phpstudy_pro\WWW\cms\xinhu\core\library\phpexcel\PHPExcel\Reader\Excel2007.php,第1274行,"									$vmlCommentsFile = simplexml_load_string( $this->_getFromZipArchive($zip, $relPath) );
"
327,simplexml_load_string,可能存在信息泄露漏洞，读取任意文件,D:\phpstudy_pro\WWW\cms\xinhu\core\library\phpexcel\PHPExcel\Reader\Excel2007.php,第1325行,"										$relsWorksheet = simplexml_load_string($this->_getFromZipArchive($zip,  dirname(""$dir/$fileWorksheet"") . ""/_rels/"" . basename($fileWorksheet) . "".rels"") ); //~ http://schemas.openxmlformats.org/package/2006/relationships"");
"
328,simplexml_load_string,可能存在信息泄露漏洞，读取任意文件,D:\phpstudy_pro\WWW\cms\xinhu\core\library\phpexcel\PHPExcel\Reader\Excel2007.php,第1336行,"											$relsVML = simplexml_load_string($this->_getFromZipArchive($zip,  dirname($vmlRelationship) . '/_rels/' . basename($vmlRelationship) . '.rels' )); //~ http://schemas.openxmlformats.org/package/2006/relationships"");
"
329,simplexml_load_string,可能存在信息泄露漏洞，读取任意文件,D:\phpstudy_pro\WWW\cms\xinhu\core\library\phpexcel\PHPExcel\Reader\Excel2007.php,第1345行,"											$vmlDrawing = simplexml_load_string($this->_getFromZipArchive($zip, $vmlRelationship));
"
330,simplexml_load_string,可能存在信息泄露漏洞，读取任意文件,D:\phpstudy_pro\WWW\cms\xinhu\core\library\phpexcel\PHPExcel\Reader\Excel2007.php,第1382行,"								$relsWorksheet = simplexml_load_string($this->_getFromZipArchive($zip,  dirname(""$dir/$fileWorksheet"") . ""/_rels/"" . basename($fileWorksheet) . "".rels"") ); //~ http://schemas.openxmlformats.org/package/2006/relationships"");
"
331,simplexml_load_string,可能存在信息泄露漏洞，读取任意文件,D:\phpstudy_pro\WWW\cms\xinhu\core\library\phpexcel\PHPExcel\Reader\Excel2007.php,第1392行,"										$relsDrawing = simplexml_load_string($this->_getFromZipArchive($zip,  dirname($fileDrawing) . ""/_rels/"" . basename($fileDrawing) . "".rels"") ); //~ http://schemas.openxmlformats.org/package/2006/relationships"");
"
332,simplexml_load_string,可能存在信息泄露漏洞，读取任意文件,D:\phpstudy_pro\WWW\cms\xinhu\core\library\phpexcel\PHPExcel\Reader\Excel2007.php,第1408行,"										$xmlDrawing = simplexml_load_string($this->_getFromZipArchive($zip, $fileDrawing))->children(""http://schemas.openxmlformats.org/drawingml/2006/spreadsheetDrawing"");
"
333,simplexml_load_string,可能存在信息泄露漏洞，读取任意文件,D:\phpstudy_pro\WWW\cms\xinhu\core\library\phpexcel\PHPExcel\Reader\Excel2007.php,第1672行,"			$contentTypes = simplexml_load_string($this->_getFromZipArchive($zip, ""[Content_Types].xml""));
"
334,simplexml_load_string,可能存在信息泄露漏洞，读取任意文件,D:\phpstudy_pro\WWW\cms\xinhu\core\library\phpexcel\PHPExcel\Reader\Excel2007.php,第1678行,"							$chartElements = simplexml_load_string($this->_getFromZipArchive($zip, $chartEntryRef));
"
335,fopen,读取文件函数中存在变量，可能存在任意文件读取漏洞,D:\phpstudy_pro\WWW\cms\xinhu\core\library\phpexcel\PHPExcel\Reader\Gnumeric.php,第93行,"		$fh = fopen($pFilename, 'r');
"
336,fread,读取文件函数中存在变量，可能存在任意文件读取漏洞,D:\phpstudy_pro\WWW\cms\xinhu\core\library\phpexcel\PHPExcel\Reader\Gnumeric.php,第94行,"		$data = fread($fh, 2);
"
337,simplexml_load_string,可能存在信息泄露漏洞，读取任意文件,D:\phpstudy_pro\WWW\cms\xinhu\core\library\phpexcel\PHPExcel\Reader\Gnumeric.php,第246行,"		$xml = simplexml_load_string($gFileData);
"
338,fread,读取文件函数中存在变量，可能存在任意文件读取漏洞,D:\phpstudy_pro\WWW\cms\xinhu\core\library\phpexcel\PHPExcel\Reader\HTML.php,第119行,"		$data = fread($this->_fileHandle, 2048);
"
339,simplexml_load_string,可能存在信息泄露漏洞，读取任意文件,D:\phpstudy_pro\WWW\cms\xinhu\core\library\phpexcel\PHPExcel\Reader\OOCalc.php,第91行,"		        $xml = simplexml_load_string($zip->getFromName('META-INF/manifest.xml'));
"
340,simplexml_load_string,可能存在信息泄露漏洞，读取任意文件,D:\phpstudy_pro\WWW\cms\xinhu\core\library\phpexcel\PHPExcel\Reader\OOCalc.php,第340行,"		$xml = simplexml_load_string($zip->getFromName(""meta.xml""));
"
341,simplexml_load_string,可能存在信息泄露漏洞，读取任意文件,D:\phpstudy_pro\WWW\cms\xinhu\core\library\phpexcel\PHPExcel\Reader\OOCalc.php,第424行,"		$xml = simplexml_load_string($zip->getFromName(""content.xml""));
"
342,fread,读取文件函数中存在变量，可能存在任意文件读取漏洞,D:\phpstudy_pro\WWW\cms\xinhu\core\library\phpexcel\PHPExcel\Reader\SYLK.php,第90行,"		$data = fread($this->_fileHandle, 2048);
"
343,fgets,读取文件函数中存在变量，可能存在任意文件读取漏洞,D:\phpstudy_pro\WWW\cms\xinhu\core\library\phpexcel\PHPExcel\Reader\SYLK.php,第157行,"		while (($rowData = fgets($fileHandle)) !== FALSE) {
"
344,fgets,读取文件函数中存在变量，可能存在任意文件读取漏洞,D:\phpstudy_pro\WWW\cms\xinhu\core\library\phpexcel\PHPExcel\Reader\SYLK.php,第157行,"		while (($rowData = fgets($fileHandle)) !== FALSE) {
"
345,array_map,参数包含变量，变量可控可能会导致代码执行漏洞,D:\phpstudy_pro\WWW\cms\xinhu\core\library\phpexcel\PHPExcel\Shared\JAMA\Matrix.php,第69行,"			$match = implode("","", array_map('gettype', $args));
"
346,array_map,参数包含变量，变量可控可能会导致代码执行漏洞,D:\phpstudy_pro\WWW\cms\xinhu\core\library\phpexcel\PHPExcel\Shared\JAMA\Matrix.php,第69行,"			$match = implode("","", array_map('gettype', $args));
"
347,array_map,参数包含变量，变量可控可能会导致代码执行漏洞,D:\phpstudy_pro\WWW\cms\xinhu\core\library\phpexcel\PHPExcel\Shared\JAMA\Matrix.php,第69行,"			$match = implode("","", array_map('gettype', $args));
"
348,array_map,参数包含变量，变量可控可能会导致代码执行漏洞,D:\phpstudy_pro\WWW\cms\xinhu\core\library\phpexcel\PHPExcel\Shared\JAMA\Matrix.php,第69行,"			$match = implode("","", array_map('gettype', $args));
"
349,array_map,参数包含变量，变量可控可能会导致代码执行漏洞,D:\phpstudy_pro\WWW\cms\xinhu\core\library\phpexcel\PHPExcel\Shared\JAMA\Matrix.php,第69行,"			$match = implode("","", array_map('gettype', $args));
"
350,array_map,参数包含变量，变量可控可能会导致代码执行漏洞,D:\phpstudy_pro\WWW\cms\xinhu\core\library\phpexcel\PHPExcel\Shared\JAMA\Matrix.php,第69行,"			$match = implode("","", array_map('gettype', $args));
"
351,array_map,参数包含变量，变量可控可能会导致代码执行漏洞,D:\phpstudy_pro\WWW\cms\xinhu\core\library\phpexcel\PHPExcel\Shared\JAMA\Matrix.php,第69行,"			$match = implode("","", array_map('gettype', $args));
"
352,array_map,参数包含变量，变量可控可能会导致代码执行漏洞,D:\phpstudy_pro\WWW\cms\xinhu\core\library\phpexcel\PHPExcel\Shared\JAMA\Matrix.php,第69行,"			$match = implode("","", array_map('gettype', $args));
"
353,array_map,参数包含变量，变量可控可能会导致代码执行漏洞,D:\phpstudy_pro\WWW\cms\xinhu\core\library\phpexcel\PHPExcel\Shared\JAMA\Matrix.php,第69行,"			$match = implode("","", array_map('gettype', $args));
"
354,array_map,参数包含变量，变量可控可能会导致代码执行漏洞,D:\phpstudy_pro\WWW\cms\xinhu\core\library\phpexcel\PHPExcel\Shared\JAMA\Matrix.php,第69行,"			$match = implode("","", array_map('gettype', $args));
"
355,array_map,参数包含变量，变量可控可能会导致代码执行漏洞,D:\phpstudy_pro\WWW\cms\xinhu\core\library\phpexcel\PHPExcel\Shared\JAMA\Matrix.php,第69行,"			$match = implode("","", array_map('gettype', $args));
"
356,array_map,参数包含变量，变量可控可能会导致代码执行漏洞,D:\phpstudy_pro\WWW\cms\xinhu\core\library\phpexcel\PHPExcel\Shared\JAMA\Matrix.php,第69行,"			$match = implode("","", array_map('gettype', $args));
"
357,array_map,参数包含变量，变量可控可能会导致代码执行漏洞,D:\phpstudy_pro\WWW\cms\xinhu\core\library\phpexcel\PHPExcel\Shared\JAMA\Matrix.php,第69行,"			$match = implode("","", array_map('gettype', $args));
"
358,array_map,参数包含变量，变量可控可能会导致代码执行漏洞,D:\phpstudy_pro\WWW\cms\xinhu\core\library\phpexcel\PHPExcel\Shared\JAMA\Matrix.php,第69行,"			$match = implode("","", array_map('gettype', $args));
"
359,array_map,参数包含变量，变量可控可能会导致代码执行漏洞,D:\phpstudy_pro\WWW\cms\xinhu\core\library\phpexcel\PHPExcel\Shared\JAMA\Matrix.php,第69行,"			$match = implode("","", array_map('gettype', $args));
"
360,fopen,读取文件函数中存在变量，可能存在任意文件读取漏洞,D:\phpstudy_pro\WWW\cms\xinhu\core\library\phpexcel\PHPExcel\Shared\OLE\PPS\Root.php,第85行,"			$this->_FILEH_ = fopen($this->_tmp_filename,""w+b"");
"
361,fopen,读取文件函数中存在变量，可能存在任意文件读取漏洞,D:\phpstudy_pro\WWW\cms\xinhu\core\library\phpexcel\PHPExcel\Shared\OLE\PPS\Root.php,第90行,"			$this->_FILEH_ = fopen($filename, ""wb"");
"
362,fwrite,读取文件函数中存在变量，可能存在任意文件读取漏洞,D:\phpstudy_pro\WWW\cms\xinhu\core\library\phpexcel\PHPExcel\Shared\OLE\PPS\Root.php,第208行,"		fwrite($FILE,
"
363,fwrite,读取文件函数中存在变量，可能存在任意文件读取漏洞,D:\phpstudy_pro\WWW\cms\xinhu\core\library\phpexcel\PHPExcel\Shared\OLE\PPS\Root.php,第231行,"			fwrite($FILE,
"
364,fwrite,读取文件函数中存在变量，可能存在任意文件读取漏洞,D:\phpstudy_pro\WWW\cms\xinhu\core\library\phpexcel\PHPExcel\Shared\OLE\PPS\Root.php,第236行,"			fwrite($FILE, pack(""V"", $iAll+$iBdCnt) . pack(""V"", $iBdExL));
"
365,fwrite,读取文件函数中存在变量，可能存在任意文件读取漏洞,D:\phpstudy_pro\WWW\cms\xinhu\core\library\phpexcel\PHPExcel\Shared\OLE\PPS\Root.php,第241行,"			fwrite($FILE, pack(""V"", $iAll+$i));
"
366,fwrite,读取文件函数中存在变量，可能存在任意文件读取漏洞,D:\phpstudy_pro\WWW\cms\xinhu\core\library\phpexcel\PHPExcel\Shared\OLE\PPS\Root.php,第246行,"				fwrite($FILE, (pack(""V"", -1)));
"
367,fread,读取文件函数中存在变量，可能存在任意文件读取漏洞,D:\phpstudy_pro\WWW\cms\xinhu\core\library\phpexcel\PHPExcel\Shared\OLE\PPS\Root.php,第274行,"					//	while($sBuff = fread($raList[$i]->_PPS_FILE, 4096)) {
"
368,fwrite,读取文件函数中存在变量，可能存在任意文件读取漏洞,D:\phpstudy_pro\WWW\cms\xinhu\core\library\phpexcel\PHPExcel\Shared\OLE\PPS\Root.php,第276行,"					//		fwrite($FILE, $sBuff);
"
369,fwrite,读取文件函数中存在变量，可能存在任意文件读取漏洞,D:\phpstudy_pro\WWW\cms\xinhu\core\library\phpexcel\PHPExcel\Shared\OLE\PPS\Root.php,第279行,"						fwrite($FILE, $raList[$i]->_data);
"
370,fwrite,读取文件函数中存在变量，可能存在任意文件读取漏洞,D:\phpstudy_pro\WWW\cms\xinhu\core\library\phpexcel\PHPExcel\Shared\OLE\PPS\Root.php,第283行,"						fwrite($FILE, str_repeat(""\x00"", $this->_BIG_BLOCK_SIZE - ($raList[$i]->Size % $this->_BIG_BLOCK_SIZE)));
"
371,unlink,文件操作函数中存在变量，可能存在任意文件读取/删除/修改/写入等漏洞,D:\phpstudy_pro\WWW\cms\xinhu\core\library\phpexcel\PHPExcel\Shared\OLE\PPS\Root.php,第295行,"				//	unlink($raList[$i]->_tmp_filename);
"
372,fwrite,读取文件函数中存在变量，可能存在任意文件读取漏洞,D:\phpstudy_pro\WWW\cms\xinhu\core\library\phpexcel\PHPExcel\Shared\OLE\PPS\Root.php,第326行,"						fwrite($FILE, pack(""V"", $j+$iSmBlk+1));
"
373,fwrite,读取文件函数中存在变量，可能存在任意文件读取漏洞,D:\phpstudy_pro\WWW\cms\xinhu\core\library\phpexcel\PHPExcel\Shared\OLE\PPS\Root.php,第328行,"					fwrite($FILE, pack(""V"", -2));
"
374,fread,读取文件函数中存在变量，可能存在任意文件读取漏洞,D:\phpstudy_pro\WWW\cms\xinhu\core\library\phpexcel\PHPExcel\Shared\OLE\PPS\Root.php,第333行,"					//	while ($sBuff = fread($raList[$i]->_PPS_FILE, 4096)) {
"
375,fwrite,读取文件函数中存在变量，可能存在任意文件读取漏洞,D:\phpstudy_pro\WWW\cms\xinhu\core\library\phpexcel\PHPExcel\Shared\OLE\PPS\Root.php,第352行,"				fwrite($FILE, pack(""V"", -1));
"
376,fwrite,读取文件函数中存在变量，可能存在任意文件读取漏洞,D:\phpstudy_pro\WWW\cms\xinhu\core\library\phpexcel\PHPExcel\Shared\OLE\PPS\Root.php,第369行,"			fwrite($this->_FILEH_, $raList[$i]->_getPpsWk());
"
377,fwrite,读取文件函数中存在变量，可能存在任意文件读取漏洞,D:\phpstudy_pro\WWW\cms\xinhu\core\library\phpexcel\PHPExcel\Shared\OLE\PPS\Root.php,第375行,"			fwrite($this->_FILEH_, str_repeat(""\x00"",($iBCnt - ($iCnt % $iBCnt)) * PHPExcel_Shared_OLE::OLE_PPS_SIZE));
"
378,fwrite,读取文件函数中存在变量，可能存在任意文件读取漏洞,D:\phpstudy_pro\WWW\cms\xinhu\core\library\phpexcel\PHPExcel\Shared\OLE\PPS\Root.php,第416行,"				fwrite($FILE, pack(""V"", $i+1));
"
379,fwrite,读取文件函数中存在变量，可能存在任意文件读取漏洞,D:\phpstudy_pro\WWW\cms\xinhu\core\library\phpexcel\PHPExcel\Shared\OLE\PPS\Root.php,第418行,"			fwrite($FILE, pack(""V"", -2));
"
380,fwrite,读取文件函数中存在变量，可能存在任意文件读取漏洞,D:\phpstudy_pro\WWW\cms\xinhu\core\library\phpexcel\PHPExcel\Shared\OLE\PPS\Root.php,第422行,"			fwrite($FILE, pack(""V"", $i+$iSbdSize+1));
"
381,fwrite,读取文件函数中存在变量，可能存在任意文件读取漏洞,D:\phpstudy_pro\WWW\cms\xinhu\core\library\phpexcel\PHPExcel\Shared\OLE\PPS\Root.php,第424行,"		fwrite($FILE, pack(""V"", -2));
"
382,fwrite,读取文件函数中存在变量，可能存在任意文件读取漏洞,D:\phpstudy_pro\WWW\cms\xinhu\core\library\phpexcel\PHPExcel\Shared\OLE\PPS\Root.php,第428行,"			fwrite($FILE, pack(""V"", $i+$iSbdSize+$iBsize+1));
"
383,fwrite,读取文件函数中存在变量，可能存在任意文件读取漏洞,D:\phpstudy_pro\WWW\cms\xinhu\core\library\phpexcel\PHPExcel\Shared\OLE\PPS\Root.php,第424行,"		fwrite($FILE, pack(""V"", -2));
"
384,fwrite,读取文件函数中存在变量，可能存在任意文件读取漏洞,D:\phpstudy_pro\WWW\cms\xinhu\core\library\phpexcel\PHPExcel\Shared\OLE\PPS\Root.php,第433行,"			fwrite($FILE, pack(""V"", 0xFFFFFFFD));
"
385,fwrite,读取文件函数中存在变量，可能存在任意文件读取漏洞,D:\phpstudy_pro\WWW\cms\xinhu\core\library\phpexcel\PHPExcel\Shared\OLE\PPS\Root.php,第437行,"			fwrite($FILE, pack(""V"", 0xFFFFFFFC));
"
386,fwrite,读取文件函数中存在变量，可能存在任意文件读取漏洞,D:\phpstudy_pro\WWW\cms\xinhu\core\library\phpexcel\PHPExcel\Shared\OLE\PPS\Root.php,第352行,"				fwrite($FILE, pack(""V"", -1));
"
387,fwrite,读取文件函数中存在变量，可能存在任意文件读取漏洞,D:\phpstudy_pro\WWW\cms\xinhu\core\library\phpexcel\PHPExcel\Shared\OLE\PPS\Root.php,第454行,"					fwrite($FILE, pack(""V"", $iAll+$iBdCnt+$iNb));
"
388,fwrite,读取文件函数中存在变量，可能存在任意文件读取漏洞,D:\phpstudy_pro\WWW\cms\xinhu\core\library\phpexcel\PHPExcel\Shared\OLE\PPS\Root.php,第456行,"				fwrite($FILE, pack(""V"", $iBsize+$iSbdSize+$iPpsCnt+$i));
"
389,fwrite,读取文件函数中存在变量，可能存在任意文件读取漏洞,D:\phpstudy_pro\WWW\cms\xinhu\core\library\phpexcel\PHPExcel\Shared\OLE\PPS\Root.php,第461行,"					fwrite($FILE, pack(""V"", -1));
"
390,fwrite,读取文件函数中存在变量，可能存在任意文件读取漏洞,D:\phpstudy_pro\WWW\cms\xinhu\core\library\phpexcel\PHPExcel\Shared\OLE\PPS\Root.php,第418行,"			fwrite($FILE, pack(""V"", -2));
"
391,parse_str,"函数中存在变量,可能存在变量覆盖漏洞",D:\phpstudy_pro\WWW\cms\xinhu\core\library\phpexcel\PHPExcel\Shared\OLE\ChainedBlockStream.php,第85行,"		parse_str(substr($path, 25), $this->params);
"
392,fread,读取文件函数中存在变量，可能存在任意文件读取漏洞,D:\phpstudy_pro\WWW\cms\xinhu\core\library\phpexcel\PHPExcel\Shared\OLE\ChainedBlockStream.php,第109行,"				$this->data .= fread($this->ole->_file_handle, $this->ole->bigBlockSize);
"
393,fread,读取文件函数中存在变量，可能存在任意文件读取漏洞,D:\phpstudy_pro\WWW\cms\xinhu\core\library\phpexcel\PHPExcel\Shared\OLE\ChainedBlockStream.php,第109行,"				$this->data .= fread($this->ole->_file_handle, $this->ole->bigBlockSize);
"
394,extract,函数中存在变量，可能存在变量覆盖漏洞,D:\phpstudy_pro\WWW\cms\xinhu\core\library\phpexcel\PHPExcel\Shared\PCLZip\pclzip.lib.php,第187行,"  //   extract() : Extract the content of the archive
"
395,extract,函数中存在变量，可能存在变量覆盖漏洞,D:\phpstudy_pro\WWW\cms\xinhu\core\library\phpexcel\PHPExcel\Shared\PCLZip\pclzip.lib.php,第670行,"  //   extract($p_path=""./"", $p_remove_path="""")
"
396,extract,函数中存在变量，可能存在变量覆盖漏洞,D:\phpstudy_pro\WWW\cms\xinhu\core\library\phpexcel\PHPExcel\Shared\PCLZip\pclzip.lib.php,第671行,"  //   extract([$p_option, $p_option_value, ...])
"
397,extract,函数中存在变量，可能存在变量覆盖漏洞,D:\phpstudy_pro\WWW\cms\xinhu\core\library\phpexcel\PHPExcel\Shared\PCLZip\pclzip.lib.php,第700行,"  function extract()
"
398,fopen,读取文件函数中存在变量，可能存在任意文件读取漏洞,D:\phpstudy_pro\WWW\cms\xinhu\core\library\phpexcel\PHPExcel\Shared\PCLZip\pclzip.lib.php,第1114行,"      if (($this->zip_fd = @fopen($this->zipname, 'rb')) == 0)
"
399,fopen,读取文件函数中存在变量，可能存在任意文件读取漏洞,D:\phpstudy_pro\WWW\cms\xinhu\core\library\phpexcel\PHPExcel\Shared\PCLZip\pclzip.lib.php,第2203行,"    if (($v_zip_temp_fd = @fopen($v_zip_temp_name, 'wb')) == 0)
"
400,fread,读取文件函数中存在变量，可能存在任意文件读取漏洞,D:\phpstudy_pro\WWW\cms\xinhu\core\library\phpexcel\PHPExcel\Shared\PCLZip\pclzip.lib.php,第2220行,"      $v_buffer = fread($this->zip_fd, $v_read_size);
"
401,fwrite,读取文件函数中存在变量，可能存在任意文件读取漏洞,D:\phpstudy_pro\WWW\cms\xinhu\core\library\phpexcel\PHPExcel\Shared\PCLZip\pclzip.lib.php,第2221行,"      @fwrite($v_zip_temp_fd, $v_buffer, $v_read_size);
"
402,unlink,文件操作函数中存在变量，可能存在任意文件读取/删除/修改/写入等漏洞,D:\phpstudy_pro\WWW\cms\xinhu\core\library\phpexcel\PHPExcel\Shared\PCLZip\pclzip.lib.php,第2238行,"      @unlink($v_zip_temp_name);
"
403,fread,读取文件函数中存在变量，可能存在任意文件读取漏洞,D:\phpstudy_pro\WWW\cms\xinhu\core\library\phpexcel\PHPExcel\Shared\PCLZip\pclzip.lib.php,第2253行,"      $v_buffer = @fread($v_zip_temp_fd, $v_read_size);
"
404,fwrite,读取文件函数中存在变量，可能存在任意文件读取漏洞,D:\phpstudy_pro\WWW\cms\xinhu\core\library\phpexcel\PHPExcel\Shared\PCLZip\pclzip.lib.php,第2254行,"      @fwrite($this->zip_fd, $v_buffer, $v_read_size);
"
405,unlink,文件操作函数中存在变量，可能存在任意文件读取/删除/修改/写入等漏洞,D:\phpstudy_pro\WWW\cms\xinhu\core\library\phpexcel\PHPExcel\Shared\PCLZip\pclzip.lib.php,第2266行,"          @unlink($v_zip_temp_name);
"
406,unlink,文件操作函数中存在变量，可能存在任意文件读取/删除/修改/写入等漏洞,D:\phpstudy_pro\WWW\cms\xinhu\core\library\phpexcel\PHPExcel\Shared\PCLZip\pclzip.lib.php,第2321行,"    @unlink($this->zipname);
"
407,fopen,读取文件函数中存在变量，可能存在任意文件读取漏洞,D:\phpstudy_pro\WWW\cms\xinhu\core\library\phpexcel\PHPExcel\Shared\PCLZip\pclzip.lib.php,第2353行,"    if (($this->zip_fd = @fopen($this->zipname, $p_mode)) == 0)
"
408,eval,命令执行函数中存在变量，可能存在任意命令执行漏洞,D:\phpstudy_pro\WWW\cms\xinhu\core\library\phpexcel\PHPExcel\Shared\PCLZip\pclzip.lib.php,第2622行,"//      eval('$v_result = '.$p_options[PCLZIP_CB_PRE_ADD].'(PCLZIP_CB_PRE_ADD, $v_local_header);');
"
409,fopen,读取文件函数中存在变量，可能存在任意文件读取漏洞,D:\phpstudy_pro\WWW\cms\xinhu\core\library\phpexcel\PHPExcel\Shared\PCLZip\pclzip.lib.php,第2667行,"        if (($v_file = @fopen($p_filename, ""rb"")) == 0) {
"
410,fread,读取文件函数中存在变量，可能存在任意文件读取漏洞,D:\phpstudy_pro\WWW\cms\xinhu\core\library\phpexcel\PHPExcel\Shared\PCLZip\pclzip.lib.php,第2673行,"        $v_content = @fread($v_file, $p_header['size']);
"
411,fwrite,读取文件函数中存在变量，可能存在任意文件读取漏洞,D:\phpstudy_pro\WWW\cms\xinhu\core\library\phpexcel\PHPExcel\Shared\PCLZip\pclzip.lib.php,第2705行,"        @fwrite($this->zip_fd, $v_content, $p_header['compressed_size']);
"
412,fwrite,读取文件函数中存在变量，可能存在任意文件读取漏洞,D:\phpstudy_pro\WWW\cms\xinhu\core\library\phpexcel\PHPExcel\Shared\PCLZip\pclzip.lib.php,第2705行,"        @fwrite($this->zip_fd, $v_content, $p_header['compressed_size']);
"
413,eval,命令执行函数中存在变量，可能存在任意命令执行漏洞,D:\phpstudy_pro\WWW\cms\xinhu\core\library\phpexcel\PHPExcel\Shared\PCLZip\pclzip.lib.php,第2776行,"//      eval('$v_result = '.$p_options[PCLZIP_CB_POST_ADD].'(PCLZIP_CB_POST_ADD, $v_local_header);');
"
414,fopen,读取文件函数中存在变量，可能存在任意文件读取漏洞,D:\phpstudy_pro\WWW\cms\xinhu\core\library\phpexcel\PHPExcel\Shared\PCLZip\pclzip.lib.php,第2807行,"    if (($v_file = @fopen($p_filename, ""rb"")) == 0) {
"
415,fread,读取文件函数中存在变量，可能存在任意文件读取漏洞,D:\phpstudy_pro\WWW\cms\xinhu\core\library\phpexcel\PHPExcel\Shared\PCLZip\pclzip.lib.php,第2824行,"      $v_buffer = @fread($v_file, $v_read_size);
"
416,fopen,读取文件函数中存在变量，可能存在任意文件读取漏洞,D:\phpstudy_pro\WWW\cms\xinhu\core\library\phpexcel\PHPExcel\Shared\PCLZip\pclzip.lib.php,第2841行,"    if (($v_file_compressed = @fopen($v_gzip_temp_name, ""rb"")) == 0) {
"
417,fread,读取文件函数中存在变量，可能存在任意文件读取漏洞,D:\phpstudy_pro\WWW\cms\xinhu\core\library\phpexcel\PHPExcel\Shared\PCLZip\pclzip.lib.php,第2847行,"    $v_binary_data = @fread($v_file_compressed, 10);
"
418,fread,读取文件函数中存在变量，可能存在任意文件读取漏洞,D:\phpstudy_pro\WWW\cms\xinhu\core\library\phpexcel\PHPExcel\Shared\PCLZip\pclzip.lib.php,第2855行,"    $v_binary_data = @fread($v_file_compressed, 8);
"
419,fopen,读取文件函数中存在变量，可能存在任意文件读取漏洞,D:\phpstudy_pro\WWW\cms\xinhu\core\library\phpexcel\PHPExcel\Shared\PCLZip\pclzip.lib.php,第2873行,"    if (($v_file_compressed = @fopen($v_gzip_temp_name, ""rb"")) == 0)
"
420,fread,读取文件函数中存在变量，可能存在任意文件读取漏洞,D:\phpstudy_pro\WWW\cms\xinhu\core\library\phpexcel\PHPExcel\Shared\PCLZip\pclzip.lib.php,第2885行,"      $v_buffer = @fread($v_file_compressed, $v_read_size);
"
421,fwrite,读取文件函数中存在变量，可能存在任意文件读取漏洞,D:\phpstudy_pro\WWW\cms\xinhu\core\library\phpexcel\PHPExcel\Shared\PCLZip\pclzip.lib.php,第2254行,"      @fwrite($this->zip_fd, $v_buffer, $v_read_size);
"
422,unlink,文件操作函数中存在变量，可能存在任意文件读取/删除/修改/写入等漏洞,D:\phpstudy_pro\WWW\cms\xinhu\core\library\phpexcel\PHPExcel\Shared\PCLZip\pclzip.lib.php,第2895行,"    @unlink($v_gzip_temp_name);
"
423,fopen,读取文件函数中存在变量，可能存在任意文件读取漏洞,D:\phpstudy_pro\WWW\cms\xinhu\core\library\phpexcel\PHPExcel\Shared\PCLZip\pclzip.lib.php,第3157行,"    if (($this->zip_fd = @fopen($this->zipname, 'rb')) == 0)
"
424,eval,命令执行函数中存在变量，可能存在任意命令执行漏洞,D:\phpstudy_pro\WWW\cms\xinhu\core\library\phpexcel\PHPExcel\Shared\PCLZip\pclzip.lib.php,第3699行,"//      eval('$v_result = '.$p_options[PCLZIP_CB_PRE_EXTRACT].'(PCLZIP_CB_PRE_EXTRACT, $v_local_header);');
"
425,fopen,读取文件函数中存在变量，可能存在任意文件读取漏洞,D:\phpstudy_pro\WWW\cms\xinhu\core\library\phpexcel\PHPExcel\Shared\PCLZip\pclzip.lib.php,第3827行,"          if (($v_dest_file = @fopen($p_entry['filename'], 'wb')) == 0)
"
426,fread,读取文件函数中存在变量，可能存在任意文件读取漏洞,D:\phpstudy_pro\WWW\cms\xinhu\core\library\phpexcel\PHPExcel\Shared\PCLZip\pclzip.lib.php,第3843行,"            $v_buffer = @fread($this->zip_fd, $v_read_size);
"
427,fwrite,读取文件函数中存在变量，可能存在任意文件读取漏洞,D:\phpstudy_pro\WWW\cms\xinhu\core\library\phpexcel\PHPExcel\Shared\PCLZip\pclzip.lib.php,第3846行,"            @fwrite($v_dest_file, $v_binary_data, $v_read_size);
"
428,fwrite,读取文件函数中存在变量，可能存在任意文件读取漏洞,D:\phpstudy_pro\WWW\cms\xinhu\core\library\phpexcel\PHPExcel\Shared\PCLZip\pclzip.lib.php,第3848行,"            @fwrite($v_dest_file, $v_buffer, $v_read_size);            
"
429,fread,读取文件函数中存在变量，可能存在任意文件读取漏洞,D:\phpstudy_pro\WWW\cms\xinhu\core\library\phpexcel\PHPExcel\Shared\PCLZip\pclzip.lib.php,第3885行,"            $v_buffer = @fread($this->zip_fd, $p_entry['compressed_size']);
"
430,fopen,读取文件函数中存在变量，可能存在任意文件读取漏洞,D:\phpstudy_pro\WWW\cms\xinhu\core\library\phpexcel\PHPExcel\Shared\PCLZip\pclzip.lib.php,第3900行,"            if (($v_dest_file = @fopen($p_entry['filename'], 'wb')) == 0) {
"
431,fwrite,读取文件函数中存在变量，可能存在任意文件读取漏洞,D:\phpstudy_pro\WWW\cms\xinhu\core\library\phpexcel\PHPExcel\Shared\PCLZip\pclzip.lib.php,第3909行,"            @fwrite($v_dest_file, $v_file_content, $p_entry['size']);
"
432,eval,命令执行函数中存在变量，可能存在任意命令执行漏洞,D:\phpstudy_pro\WWW\cms\xinhu\core\library\phpexcel\PHPExcel\Shared\PCLZip\pclzip.lib.php,第3946行,"//      eval('$v_result = '.$p_options[PCLZIP_CB_POST_EXTRACT].'(PCLZIP_CB_POST_EXTRACT, $v_local_header);');
"
433,fopen,读取文件函数中存在变量，可能存在任意文件读取漏洞,D:\phpstudy_pro\WWW\cms\xinhu\core\library\phpexcel\PHPExcel\Shared\PCLZip\pclzip.lib.php,第3972行,"    if (($v_dest_file = @fopen($v_gzip_temp_name, ""wb"")) == 0) {
"
434,fwrite,读取文件函数中存在变量，可能存在任意文件读取漏洞,D:\phpstudy_pro\WWW\cms\xinhu\core\library\phpexcel\PHPExcel\Shared\PCLZip\pclzip.lib.php,第3981行,"    @fwrite($v_dest_file, $v_binary_data, 10);
"
435,fread,读取文件函数中存在变量，可能存在任意文件读取漏洞,D:\phpstudy_pro\WWW\cms\xinhu\core\library\phpexcel\PHPExcel\Shared\PCLZip\pclzip.lib.php,第3988行,"      $v_buffer = @fread($this->zip_fd, $v_read_size);
"
436,fwrite,读取文件函数中存在变量，可能存在任意文件读取漏洞,D:\phpstudy_pro\WWW\cms\xinhu\core\library\phpexcel\PHPExcel\Shared\PCLZip\pclzip.lib.php,第3990行,"      @fwrite($v_dest_file, $v_buffer, $v_read_size);
"
437,fwrite,读取文件函数中存在变量，可能存在任意文件读取漏洞,D:\phpstudy_pro\WWW\cms\xinhu\core\library\phpexcel\PHPExcel\Shared\PCLZip\pclzip.lib.php,第3996行,"    @fwrite($v_dest_file, $v_binary_data, 8);
"
438,fopen,读取文件函数中存在变量，可能存在任意文件读取漏洞,D:\phpstudy_pro\WWW\cms\xinhu\core\library\phpexcel\PHPExcel\Shared\PCLZip\pclzip.lib.php,第4002行,"    if (($v_dest_file = @fopen($p_entry['filename'], 'wb')) == 0) {
"
439,fwrite,读取文件函数中存在变量，可能存在任意文件读取漏洞,D:\phpstudy_pro\WWW\cms\xinhu\core\library\phpexcel\PHPExcel\Shared\PCLZip\pclzip.lib.php,第3990行,"      @fwrite($v_dest_file, $v_buffer, $v_read_size);
"
440,unlink,文件操作函数中存在变量，可能存在任意文件读取/删除/修改/写入等漏洞,D:\phpstudy_pro\WWW\cms\xinhu\core\library\phpexcel\PHPExcel\Shared\PCLZip\pclzip.lib.php,第2895行,"    @unlink($v_gzip_temp_name);
"
441,eval,命令执行函数中存在变量，可能存在任意命令执行漏洞,D:\phpstudy_pro\WWW\cms\xinhu\core\library\phpexcel\PHPExcel\Shared\PCLZip\pclzip.lib.php,第3699行,"//      eval('$v_result = '.$p_options[PCLZIP_CB_PRE_EXTRACT].'(PCLZIP_CB_PRE_EXTRACT, $v_local_header);');
"
442,fread,读取文件函数中存在变量，可能存在任意文件读取漏洞,D:\phpstudy_pro\WWW\cms\xinhu\core\library\phpexcel\PHPExcel\Shared\PCLZip\pclzip.lib.php,第4098行,"          $v_buffer = @fread($this->zip_fd, $p_entry['compressed_size']);
"
443,fread,读取文件函数中存在变量，可能存在任意文件读取漏洞,D:\phpstudy_pro\WWW\cms\xinhu\core\library\phpexcel\PHPExcel\Shared\PCLZip\pclzip.lib.php,第4098行,"          $v_buffer = @fread($this->zip_fd, $p_entry['compressed_size']);
"
444,eval,命令执行函数中存在变量，可能存在任意命令执行漏洞,D:\phpstudy_pro\WWW\cms\xinhu\core\library\phpexcel\PHPExcel\Shared\PCLZip\pclzip.lib.php,第3946行,"//      eval('$v_result = '.$p_options[PCLZIP_CB_POST_EXTRACT].'(PCLZIP_CB_POST_EXTRACT, $v_local_header);');
"
445,eval,命令执行函数中存在变量，可能存在任意命令执行漏洞,D:\phpstudy_pro\WWW\cms\xinhu\core\library\phpexcel\PHPExcel\Shared\PCLZip\pclzip.lib.php,第3699行,"//      eval('$v_result = '.$p_options[PCLZIP_CB_PRE_EXTRACT].'(PCLZIP_CB_PRE_EXTRACT, $v_local_header);');
"
446,fread,读取文件函数中存在变量，可能存在任意文件读取漏洞,D:\phpstudy_pro\WWW\cms\xinhu\core\library\phpexcel\PHPExcel\Shared\PCLZip\pclzip.lib.php,第4213行,"          $p_string = @fread($this->zip_fd, $p_entry['compressed_size']);
"
447,fread,读取文件函数中存在变量，可能存在任意文件读取漏洞,D:\phpstudy_pro\WWW\cms\xinhu\core\library\phpexcel\PHPExcel\Shared\PCLZip\pclzip.lib.php,第4218行,"          $v_data = @fread($this->zip_fd, $p_entry['compressed_size']);
"
448,eval,命令执行函数中存在变量，可能存在任意命令执行漏洞,D:\phpstudy_pro\WWW\cms\xinhu\core\library\phpexcel\PHPExcel\Shared\PCLZip\pclzip.lib.php,第3946行,"//      eval('$v_result = '.$p_options[PCLZIP_CB_POST_EXTRACT].'(PCLZIP_CB_POST_EXTRACT, $v_local_header);');
"
449,fread,读取文件函数中存在变量，可能存在任意文件读取漏洞,D:\phpstudy_pro\WWW\cms\xinhu\core\library\phpexcel\PHPExcel\Shared\PCLZip\pclzip.lib.php,第4282行,"    $v_binary_data = @fread($this->zip_fd, 4);
"
450,fread,读取文件函数中存在变量，可能存在任意文件读取漏洞,D:\phpstudy_pro\WWW\cms\xinhu\core\library\phpexcel\PHPExcel\Shared\PCLZip\pclzip.lib.php,第4297行,"    $v_binary_data = fread($this->zip_fd, 26);
"
451,fread,读取文件函数中存在变量，可能存在任意文件读取漏洞,D:\phpstudy_pro\WWW\cms\xinhu\core\library\phpexcel\PHPExcel\Shared\PCLZip\pclzip.lib.php,第4316行,"    $p_header['filename'] = fread($this->zip_fd, $v_data['filename_len']);
"
452,fread,读取文件函数中存在变量，可能存在任意文件读取漏洞,D:\phpstudy_pro\WWW\cms\xinhu\core\library\phpexcel\PHPExcel\Shared\PCLZip\pclzip.lib.php,第4320行,"      $p_header['extra'] = fread($this->zip_fd, $v_data['extra_len']);
"
453,fread,读取文件函数中存在变量，可能存在任意文件读取漏洞,D:\phpstudy_pro\WWW\cms\xinhu\core\library\phpexcel\PHPExcel\Shared\PCLZip\pclzip.lib.php,第4282行,"    $v_binary_data = @fread($this->zip_fd, 4);
"
454,fread,读取文件函数中存在变量，可能存在任意文件读取漏洞,D:\phpstudy_pro\WWW\cms\xinhu\core\library\phpexcel\PHPExcel\Shared\PCLZip\pclzip.lib.php,第4400行,"    $v_binary_data = fread($this->zip_fd, 42);
"
455,fread,读取文件函数中存在变量，可能存在任意文件读取漏洞,D:\phpstudy_pro\WWW\cms\xinhu\core\library\phpexcel\PHPExcel\Shared\PCLZip\pclzip.lib.php,第4420行,"      $p_header['filename'] = fread($this->zip_fd, $p_header['filename_len']);
"
456,fread,读取文件函数中存在变量，可能存在任意文件读取漏洞,D:\phpstudy_pro\WWW\cms\xinhu\core\library\phpexcel\PHPExcel\Shared\PCLZip\pclzip.lib.php,第4426行,"      $p_header['extra'] = fread($this->zip_fd, $p_header['extra_len']);
"
457,fread,读取文件函数中存在变量，可能存在任意文件读取漏洞,D:\phpstudy_pro\WWW\cms\xinhu\core\library\phpexcel\PHPExcel\Shared\PCLZip\pclzip.lib.php,第4432行,"      $p_header['comment'] = fread($this->zip_fd, $p_header['comment_len']);
"
458,fread,读取文件函数中存在变量，可能存在任意文件读取漏洞,D:\phpstudy_pro\WWW\cms\xinhu\core\library\phpexcel\PHPExcel\Shared\PCLZip\pclzip.lib.php,第4556行,"      $v_binary_data = @fread($this->zip_fd, 4);
"
459,fread,读取文件函数中存在变量，可能存在任意文件读取漏洞,D:\phpstudy_pro\WWW\cms\xinhu\core\library\phpexcel\PHPExcel\Shared\PCLZip\pclzip.lib.php,第4588行,"        $v_byte = @fread($this->zip_fd, 1);
"
460,fread,读取文件函数中存在变量，可能存在任意文件读取漏洞,D:\phpstudy_pro\WWW\cms\xinhu\core\library\phpexcel\PHPExcel\Shared\PCLZip\pclzip.lib.php,第4619行,"    $v_binary_data = fread($this->zip_fd, 18);
"
461,fread,读取文件函数中存在变量，可能存在任意文件读取漏洞,D:\phpstudy_pro\WWW\cms\xinhu\core\library\phpexcel\PHPExcel\Shared\PCLZip\pclzip.lib.php,第4655行,"      $p_central_dir['comment'] = fread($this->zip_fd, $v_data['comment_size']);
"
462,unlink,文件操作函数中存在变量，可能存在任意文件读取/删除/修改/写入等漏洞,D:\phpstudy_pro\WWW\cms\xinhu\core\library\phpexcel\PHPExcel\Shared\PCLZip\pclzip.lib.php,第4852行,"                @unlink($v_zip_temp_name);
"
463,unlink,文件操作函数中存在变量，可能存在任意文件读取/删除/修改/写入等漏洞,D:\phpstudy_pro\WWW\cms\xinhu\core\library\phpexcel\PHPExcel\Shared\PCLZip\pclzip.lib.php,第4852行,"                @unlink($v_zip_temp_name);
"
464,unlink,文件操作函数中存在变量，可能存在任意文件读取/删除/修改/写入等漏洞,D:\phpstudy_pro\WWW\cms\xinhu\core\library\phpexcel\PHPExcel\Shared\PCLZip\pclzip.lib.php,第4852行,"                @unlink($v_zip_temp_name);
"
465,unlink,文件操作函数中存在变量，可能存在任意文件读取/删除/修改/写入等漏洞,D:\phpstudy_pro\WWW\cms\xinhu\core\library\phpexcel\PHPExcel\Shared\PCLZip\pclzip.lib.php,第4852行,"                @unlink($v_zip_temp_name);
"
466,unlink,文件操作函数中存在变量，可能存在任意文件读取/删除/修改/写入等漏洞,D:\phpstudy_pro\WWW\cms\xinhu\core\library\phpexcel\PHPExcel\Shared\PCLZip\pclzip.lib.php,第4852行,"                @unlink($v_zip_temp_name);
"
467,unlink,文件操作函数中存在变量，可能存在任意文件读取/删除/修改/写入等漏洞,D:\phpstudy_pro\WWW\cms\xinhu\core\library\phpexcel\PHPExcel\Shared\PCLZip\pclzip.lib.php,第4938行,"            @unlink($v_zip_temp_name);
"
468,unlink,文件操作函数中存在变量，可能存在任意文件读取/删除/修改/写入等漏洞,D:\phpstudy_pro\WWW\cms\xinhu\core\library\phpexcel\PHPExcel\Shared\PCLZip\pclzip.lib.php,第4950行,"        @unlink($this->zipname);
"
469,fopen,读取文件函数中存在变量，可能存在任意文件读取漏洞,D:\phpstudy_pro\WWW\cms\xinhu\core\library\phpexcel\PHPExcel\Shared\PCLZip\pclzip.lib.php,第2203行,"    if (($v_zip_temp_fd = @fopen($v_zip_temp_name, 'wb')) == 0)
"
470,fread,读取文件函数中存在变量，可能存在任意文件读取漏洞,D:\phpstudy_pro\WWW\cms\xinhu\core\library\phpexcel\PHPExcel\Shared\PCLZip\pclzip.lib.php,第2220行,"      $v_buffer = fread($this->zip_fd, $v_read_size);
"
471,fwrite,读取文件函数中存在变量，可能存在任意文件读取漏洞,D:\phpstudy_pro\WWW\cms\xinhu\core\library\phpexcel\PHPExcel\Shared\PCLZip\pclzip.lib.php,第2221行,"      @fwrite($v_zip_temp_fd, $v_buffer, $v_read_size);
"
472,fread,读取文件函数中存在变量，可能存在任意文件读取漏洞,D:\phpstudy_pro\WWW\cms\xinhu\core\library\phpexcel\PHPExcel\Shared\PCLZip\pclzip.lib.php,第5144行,"      $v_buffer = fread($p_archive_to_add->zip_fd, $v_read_size);
"
473,fwrite,读取文件函数中存在变量，可能存在任意文件读取漏洞,D:\phpstudy_pro\WWW\cms\xinhu\core\library\phpexcel\PHPExcel\Shared\PCLZip\pclzip.lib.php,第2221行,"      @fwrite($v_zip_temp_fd, $v_buffer, $v_read_size);
"
474,fread,读取文件函数中存在变量，可能存在任意文件读取漏洞,D:\phpstudy_pro\WWW\cms\xinhu\core\library\phpexcel\PHPExcel\Shared\PCLZip\pclzip.lib.php,第3988行,"      $v_buffer = @fread($this->zip_fd, $v_read_size);
"
475,fwrite,读取文件函数中存在变量，可能存在任意文件读取漏洞,D:\phpstudy_pro\WWW\cms\xinhu\core\library\phpexcel\PHPExcel\Shared\PCLZip\pclzip.lib.php,第2221行,"      @fwrite($v_zip_temp_fd, $v_buffer, $v_read_size);
"
476,fread,读取文件函数中存在变量，可能存在任意文件读取漏洞,D:\phpstudy_pro\WWW\cms\xinhu\core\library\phpexcel\PHPExcel\Shared\PCLZip\pclzip.lib.php,第5167行,"      $v_buffer = @fread($p_archive_to_add->zip_fd, $v_read_size);
"
477,fwrite,读取文件函数中存在变量，可能存在任意文件读取漏洞,D:\phpstudy_pro\WWW\cms\xinhu\core\library\phpexcel\PHPExcel\Shared\PCLZip\pclzip.lib.php,第2221行,"      @fwrite($v_zip_temp_fd, $v_buffer, $v_read_size);
"
478,unlink,文件操作函数中存在变量，可能存在任意文件读取/删除/修改/写入等漏洞,D:\phpstudy_pro\WWW\cms\xinhu\core\library\phpexcel\PHPExcel\Shared\PCLZip\pclzip.lib.php,第2321行,"    @unlink($this->zipname);
"
479,fopen,读取文件函数中存在变量，可能存在任意文件读取漏洞,D:\phpstudy_pro\WWW\cms\xinhu\core\library\phpexcel\PHPExcel\Shared\PCLZip\pclzip.lib.php,第5255行,"    if (($v_zip_temp_fd = @fopen($p_archive_filename, 'rb')) == 0)
"
480,fread,读取文件函数中存在变量，可能存在任意文件读取漏洞,D:\phpstudy_pro\WWW\cms\xinhu\core\library\phpexcel\PHPExcel\Shared\PCLZip\pclzip.lib.php,第5271行,"      $v_buffer = fread($v_zip_temp_fd, $v_read_size);
"
481,fwrite,读取文件函数中存在变量，可能存在任意文件读取漏洞,D:\phpstudy_pro\WWW\cms\xinhu\core\library\phpexcel\PHPExcel\Shared\PCLZip\pclzip.lib.php,第2254行,"      @fwrite($this->zip_fd, $v_buffer, $v_read_size);
"
482,fread,读取文件函数中存在变量，可能存在任意文件读取漏洞,D:\phpstudy_pro\WWW\cms\xinhu\core\library\phpexcel\PHPExcel\Shared\PCLZip\pclzip.lib.php,第5563行,"        $v_buffer = @fread($p_src, $v_read_size);
"
483,fwrite,读取文件函数中存在变量，可能存在任意文件读取漏洞,D:\phpstudy_pro\WWW\cms\xinhu\core\library\phpexcel\PHPExcel\Shared\PCLZip\pclzip.lib.php,第5564行,"        @fwrite($p_dest, $v_buffer, $v_read_size);
"
484,fwrite,读取文件函数中存在变量，可能存在任意文件读取漏洞,D:\phpstudy_pro\WWW\cms\xinhu\core\library\phpexcel\PHPExcel\Shared\PCLZip\pclzip.lib.php,第5564行,"        @fwrite($p_dest, $v_buffer, $v_read_size);
"
485,fread,读取文件函数中存在变量，可能存在任意文件读取漏洞,D:\phpstudy_pro\WWW\cms\xinhu\core\library\phpexcel\PHPExcel\Shared\PCLZip\pclzip.lib.php,第5563行,"        $v_buffer = @fread($p_src, $v_read_size);
"
486,copy,文件操作函数中存在变量，可能存在任意文件读取/删除/修改/写入等漏洞,D:\phpstudy_pro\WWW\cms\xinhu\core\library\phpexcel\PHPExcel\Shared\PCLZip\pclzip.lib.php,第5624行,"      if (!@copy($p_src, $p_dest)) {
"
487,unlink,文件操作函数中存在变量，可能存在任意文件读取/删除/修改/写入等漏洞,D:\phpstudy_pro\WWW\cms\xinhu\core\library\phpexcel\PHPExcel\Shared\PCLZip\pclzip.lib.php,第5627行,"      else if (!@unlink($p_src)) {
"
488,fopen,读取文件函数中存在变量，可能存在任意文件读取漏洞,D:\phpstudy_pro\WWW\cms\xinhu\core\library\phpexcel\PHPExcel\Shared\Drawing.php,第182行,"        $file    =    fopen($p_sFile,""rb"");
"
489,fread,读取文件函数中存在变量，可能存在任意文件读取漏洞,D:\phpstudy_pro\WWW\cms\xinhu\core\library\phpexcel\PHPExcel\Shared\Drawing.php,第183行,"        $read    =    fread($file,10);
"
490,fread,读取文件函数中存在变量，可能存在任意文件读取漏洞,D:\phpstudy_pro\WWW\cms\xinhu\core\library\phpexcel\PHPExcel\Shared\Drawing.php,第185行,"            $read    .=    fread($file,1024);
"
491,unlink,文件操作函数中存在变量，可能存在任意文件读取/删除/修改/写入等漏洞,D:\phpstudy_pro\WWW\cms\xinhu\core\library\phpexcel\PHPExcel\Shared\File.php,第165行,"				unlink($temp);
"
492,fopen,读取文件函数中存在变量，可能存在任意文件读取漏洞,D:\phpstudy_pro\WWW\cms\xinhu\core\library\phpexcel\PHPExcel\Shared\OLE.php,第98行,"		$fh = fopen($file, ""r"");
"
493,fread,读取文件函数中存在变量，可能存在任意文件读取漏洞,D:\phpstudy_pro\WWW\cms\xinhu\core\library\phpexcel\PHPExcel\Shared\OLE.php,第104行,"		$signature = fread($fh, 8);
"
494,fread,读取文件函数中存在变量，可能存在任意文件读取漏洞,D:\phpstudy_pro\WWW\cms\xinhu\core\library\phpexcel\PHPExcel\Shared\OLE.php,第109行,"		if (fread($fh, 2) != ""\xFE\xFF"") {
"
495,fopen,读取文件函数中存在变量，可能存在任意文件读取漏洞,D:\phpstudy_pro\WWW\cms\xinhu\core\library\phpexcel\PHPExcel\Shared\OLE.php,第219行,"		return fopen($path, 'r');
"
496,fread,读取文件函数中存在变量，可能存在任意文件读取漏洞,D:\phpstudy_pro\WWW\cms\xinhu\core\library\phpexcel\PHPExcel\Shared\OLE.php,第230行,"		list(, $tmp) = unpack(""c"", fread($fh, 1));
"
497,fread,读取文件函数中存在变量，可能存在任意文件读取漏洞,D:\phpstudy_pro\WWW\cms\xinhu\core\library\phpexcel\PHPExcel\Shared\OLE.php,第242行,"		list(, $tmp) = unpack(""v"", fread($fh, 2));
"
498,fread,读取文件函数中存在变量，可能存在任意文件读取漏洞,D:\phpstudy_pro\WWW\cms\xinhu\core\library\phpexcel\PHPExcel\Shared\OLE.php,第254行,"		list(, $tmp) = unpack(""V"", fread($fh, 4));
"
499,fread,读取文件函数中存在变量，可能存在任意文件读取漏洞,D:\phpstudy_pro\WWW\cms\xinhu\core\library\phpexcel\PHPExcel\Shared\OLE.php,第271行,"			$nameUtf16 = fread($fh, 64);
"
500,fread,读取文件函数中存在变量，可能存在任意文件读取漏洞,D:\phpstudy_pro\WWW\cms\xinhu\core\library\phpexcel\PHPExcel\Shared\OLE.php,第299行,"			$pps->Time1st = self::OLE2LocalDate(fread($fh, 8));
"
501,fread,读取文件函数中存在变量，可能存在任意文件读取漏洞,D:\phpstudy_pro\WWW\cms\xinhu\core\library\phpexcel\PHPExcel\Shared\OLE.php,第300行,"			$pps->Time2nd = self::OLE2LocalDate(fread($fh, 8));
"
502,file_get_contents,文件操作函数中存在变量，可能存在任意文件读取/删除/修改/写入等漏洞,D:\phpstudy_pro\WWW\cms\xinhu\core\library\phpexcel\PHPExcel\Shared\OLERead.php,第85行,"		$this->data = file_get_contents($sFileName, FALSE, NULL, 0, 8);
"
503,file_get_contents,文件操作函数中存在变量，可能存在任意文件读取/删除/修改/写入等漏洞,D:\phpstudy_pro\WWW\cms\xinhu\core\library\phpexcel\PHPExcel\Shared\OLERead.php,第93行,"		$this->data = file_get_contents($sFileName);
"
504,unlink,文件操作函数中存在变量，可能存在任意文件读取/删除/修改/写入等漏洞,D:\phpstudy_pro\WWW\cms\xinhu\core\library\phpexcel\PHPExcel\Shared\XMLWriter.php,第91行,"			@unlink($this->_tempFileName);
"
505,file_get_contents,文件操作函数中存在变量，可能存在任意文件读取/删除/修改/写入等漏洞,D:\phpstudy_pro\WWW\cms\xinhu\core\library\phpexcel\PHPExcel\Shared\XMLWriter.php,第105行,"			return file_get_contents($this->_tempFileName);
"
506,fopen,读取文件函数中存在变量，可能存在任意文件读取漏洞,D:\phpstudy_pro\WWW\cms\xinhu\core\library\phpexcel\PHPExcel\Shared\ZipArchive.php,第99行,"		$handle = fopen($this->_tempDir.'/'.$filenameParts[""basename""], ""wb"");
"
507,fwrite,读取文件函数中存在变量，可能存在任意文件读取漏洞,D:\phpstudy_pro\WWW\cms\xinhu\core\library\phpexcel\PHPExcel\Shared\ZipArchive.php,第100行,"		fwrite($handle, $contents);
"
508,unlink,文件操作函数中存在变量，可能存在任意文件读取/删除/修改/写入等漏洞,D:\phpstudy_pro\WWW\cms\xinhu\core\library\phpexcel\PHPExcel\Shared\ZipArchive.php,第111行,"		unlink($this->_tempDir.'/'.$filenameParts[""basename""]);
"
509,array_filter,参数包含变量，变量可控可能会导致代码执行漏洞,D:\phpstudy_pro\WWW\cms\xinhu\core\library\phpexcel\PHPExcel\Worksheet\AutoFilter.php,第586行,"		$dataValues = array_filter($dataValues);
"
510,array_filter,参数包含变量，变量可控可能会导致代码执行漏洞,D:\phpstudy_pro\WWW\cms\xinhu\core\library\phpexcel\PHPExcel\Worksheet\AutoFilter.php,第623行,"					$ruleDataSet = array_filter($ruleValues);
"
511,array_filter,参数包含变量，变量可控可能会导致代码执行漏洞,D:\phpstudy_pro\WWW\cms\xinhu\core\library\phpexcel\PHPExcel\Worksheet\AutoFilter.php,第663行,"						$arguments['date'] = array_filter($arguments['date']);
"
512,array_filter,参数包含变量，变量可控可能会导致代码执行漏洞,D:\phpstudy_pro\WWW\cms\xinhu\core\library\phpexcel\PHPExcel\Worksheet\AutoFilter.php,第664行,"						$arguments['time'] = array_filter($arguments['time']);
"
513,array_filter,参数包含变量，变量可控可能会导致代码执行漏洞,D:\phpstudy_pro\WWW\cms\xinhu\core\library\phpexcel\PHPExcel\Worksheet\AutoFilter.php,第665行,"						$arguments['dateTime'] = array_filter($arguments['dateTime']);
"
514,fopen,读取文件函数中存在变量，可能存在任意文件读取漏洞,D:\phpstudy_pro\WWW\cms\xinhu\core\library\phpexcel\PHPExcel\Writer\Excel5\Worksheet.php,第2616行,"		$bmp_fd = @fopen($bitmap,""rb"");
"
515,fread,读取文件函数中存在变量，可能存在任意文件读取漏洞,D:\phpstudy_pro\WWW\cms\xinhu\core\library\phpexcel\PHPExcel\Writer\Excel5\Worksheet.php,第2622行,"		$data = fread($bmp_fd, filesize($bitmap));
"
516,fopen,读取文件函数中存在变量，可能存在任意文件读取漏洞,D:\phpstudy_pro\WWW\cms\xinhu\core\library\phpexcel\PHPExcel\Writer\PDF\Core.php,第337行,"        $fileHandle = fopen($pFilename, 'w');
"
517,fwrite,读取文件函数中存在变量，可能存在任意文件读取漏洞,D:\phpstudy_pro\WWW\cms\xinhu\core\library\phpexcel\PHPExcel\Writer\PDF\DomPDF.php,第115行,"        fwrite($fileHandle, $pdf->output());
"
518,fwrite,读取文件函数中存在变量，可能存在任意文件读取漏洞,D:\phpstudy_pro\WWW\cms\xinhu\core\library\phpexcel\PHPExcel\Writer\PDF\mPDF.php,第125行,"        fwrite($fileHandle, $pdf->Output('', 'S'));
"
519,fwrite,读取文件函数中存在变量，可能存在任意文件读取漏洞,D:\phpstudy_pro\WWW\cms\xinhu\core\library\phpexcel\PHPExcel\Writer\PDF\tcPDF.php,第131行,"        fwrite($fileHandle, $pdf->output($pFilename, 'S'));
"
520,fopen,读取文件函数中存在变量，可能存在任意文件读取漏洞,D:\phpstudy_pro\WWW\cms\xinhu\core\library\phpexcel\PHPExcel\Writer\CSV.php,第111行,"		$fileHandle = fopen($pFilename, 'wb+');
"
521,fwrite,读取文件函数中存在变量，可能存在任意文件读取漏洞,D:\phpstudy_pro\WWW\cms\xinhu\core\library\phpexcel\PHPExcel\Writer\CSV.php,第118行,"			fwrite($fileHandle, ""\xFF\xFE"");	//	Excel uses UTF-16LE encoding
"
522,fwrite,读取文件函数中存在变量，可能存在任意文件读取漏洞,D:\phpstudy_pro\WWW\cms\xinhu\core\library\phpexcel\PHPExcel\Writer\CSV.php,第123行,"			fwrite($fileHandle, ""\xEF\xBB\xBF"");
"
523,fwrite,读取文件函数中存在变量，可能存在任意文件读取漏洞,D:\phpstudy_pro\WWW\cms\xinhu\core\library\phpexcel\PHPExcel\Writer\CSV.php,第304行,"				fwrite($pFileHandle, mb_convert_encoding($line,""UTF-16LE"",""UTF-8""));
"
524,fwrite,读取文件函数中存在变量，可能存在任意文件读取漏洞,D:\phpstudy_pro\WWW\cms\xinhu\core\library\phpexcel\PHPExcel\Writer\CSV.php,第306行,"				fwrite($pFileHandle, $line);
"
525,unlink,文件操作函数中存在变量，可能存在任意文件读取/删除/修改/写入等漏洞,D:\phpstudy_pro\WWW\cms\xinhu\core\library\phpexcel\PHPExcel\Writer\Excel2007.php,第214行,"				unlink($pFilename);
"
526,file_get_contents,文件操作函数中存在变量，可能存在任意文件读取/删除/修改/写入等漏洞,D:\phpstudy_pro\WWW\cms\xinhu\core\library\phpexcel\PHPExcel\Writer\Excel2007.php,第306行,"						$objZip->addFromString('xl/media/' . $image->getIndexedFilename(), file_get_contents($image->getPath()));
"
527,file_get_contents,文件操作函数中存在变量，可能存在任意文件读取/删除/修改/写入等漏洞,D:\phpstudy_pro\WWW\cms\xinhu\core\library\phpexcel\PHPExcel\Writer\Excel2007.php,第326行,"						$imageContents = file_get_contents($imagePath);
"
528,ob_start,"函数中存在变量,可能存在变量覆盖漏洞",D:\phpstudy_pro\WWW\cms\xinhu\core\library\phpexcel\PHPExcel\Writer\Excel2007.php,第331行,"					ob_start();
"
529,copy,文件操作函数中存在变量，可能存在任意文件读取/删除/修改/写入等漏洞,D:\phpstudy_pro\WWW\cms\xinhu\core\library\phpexcel\PHPExcel\Writer\Excel2007.php,第353行,"				if (copy($pFilename, $originalFilename) === false) {
"
530,unlink,文件操作函数中存在变量，可能存在任意文件读取/删除/修改/写入等漏洞,D:\phpstudy_pro\WWW\cms\xinhu\core\library\phpexcel\PHPExcel\Writer\Excel2007.php,第356行,"				@unlink($pFilename);
"
531,ob_start,"函数中存在变量,可能存在变量覆盖漏洞",D:\phpstudy_pro\WWW\cms\xinhu\core\library\phpexcel\PHPExcel\Writer\Excel5.php,第483行,"						ob_start();
"
532,file_get_contents,文件操作函数中存在变量，可能存在任意文件读取/删除/修改/写入等漏洞,D:\phpstudy_pro\WWW\cms\xinhu\core\library\phpexcel\PHPExcel\Writer\Excel5.php,第491行,"						$blipData = file_get_contents($filename);
"
533,file_get_contents,文件操作函数中存在变量，可能存在任意文件读取/删除/修改/写入等漏洞,D:\phpstudy_pro\WWW\cms\xinhu\core\library\phpexcel\PHPExcel\Writer\Excel5.php,第491行,"						$blipData = file_get_contents($filename);
"
534,ob_start,"函数中存在变量,可能存在变量覆盖漏洞",D:\phpstudy_pro\WWW\cms\xinhu\core\library\phpexcel\PHPExcel\Writer\Excel5.php,第483行,"						ob_start();
"
535,ob_start,"函数中存在变量,可能存在变量覆盖漏洞",D:\phpstudy_pro\WWW\cms\xinhu\core\library\phpexcel\PHPExcel\Writer\Excel5.php,第538行,"					ob_start();
"
536,fopen,读取文件函数中存在变量，可能存在任意文件读取漏洞,D:\phpstudy_pro\WWW\cms\xinhu\core\library\phpexcel\PHPExcel\Writer\HTML.php,第164行,"		$fileHandle = fopen($pFilename, 'wb+');
"
537,fwrite,读取文件函数中存在变量，可能存在任意文件读取漏洞,D:\phpstudy_pro\WWW\cms\xinhu\core\library\phpexcel\PHPExcel\Writer\HTML.php,第170行,"		fwrite($fileHandle, $this->generateHTMLHeader(!$this->_useInlineCss));
"
538,fwrite,读取文件函数中存在变量，可能存在任意文件读取漏洞,D:\phpstudy_pro\WWW\cms\xinhu\core\library\phpexcel\PHPExcel\Writer\HTML.php,第174行,"			fwrite($fileHandle, $this->generateNavigation());
"
539,fwrite,读取文件函数中存在变量，可能存在任意文件读取漏洞,D:\phpstudy_pro\WWW\cms\xinhu\core\library\phpexcel\PHPExcel\Writer\HTML.php,第178行,"		fwrite($fileHandle, $this->generateSheetData());
"
540,fwrite,读取文件函数中存在变量，可能存在任意文件读取漏洞,D:\phpstudy_pro\WWW\cms\xinhu\core\library\phpexcel\PHPExcel\Writer\HTML.php,第181行,"		fwrite($fileHandle, $this->generateHTMLFooter());
"
541,fopen,读取文件函数中存在变量，可能存在任意文件读取漏洞,D:\phpstudy_pro\WWW\cms\xinhu\core\library\phpexcel\PHPExcel\Writer\HTML.php,第598行,"						if ($fp = fopen($filename,""rb"", 0)) {
"
542,fread,读取文件函数中存在变量，可能存在任意文件读取漏洞,D:\phpstudy_pro\WWW\cms\xinhu\core\library\phpexcel\PHPExcel\Writer\HTML.php,第599行,"							$picture = fread($fp,filesize($filename));
"
543,fopen,读取文件函数中存在变量，可能存在任意文件读取漏洞,D:\phpstudy_pro\WWW\cms\xinhu\core\library\phpexcel\PHPExcel\Writer\HTML.php,第645行,"					if ($fp = fopen($chartFileName,""rb"", 0)) {
"
544,fread,读取文件函数中存在变量，可能存在任意文件读取漏洞,D:\phpstudy_pro\WWW\cms\xinhu\core\library\phpexcel\PHPExcel\Writer\HTML.php,第646行,"						$picture = fread($fp,filesize($chartFileName));
"
545,unlink,文件操作函数中存在变量，可能存在任意文件读取/删除/修改/写入等漏洞,D:\phpstudy_pro\WWW\cms\xinhu\core\library\phpexcel\PHPExcel\Writer\HTML.php,第657行,"						unlink($chartFileName);
"
546,require,"文件包含函数中存在变量,可能存在文件包含漏洞",D:\phpstudy_pro\WWW\cms\xinhu\core\library\phpexcel\PHPExcel\Autoloader.php,第82行,"        require($pClassFilePath);
"
547,unserialize,序列化函数，可能存在反序列化漏洞,D:\phpstudy_pro\WWW\cms\xinhu\core\library\phpexcel\PHPExcel\Worksheet.php,第2813行,"                    $this->{$key} = unserialize(serialize($val));
"
548,unserialize,序列化函数，可能存在反序列化漏洞,D:\phpstudy_pro\WWW\cms\xinhu\core\library\phpexcel\PHPExcel.php,第622行,"                $this->{$key} = unserialize(serialize($val));
"
549,escapeshellcmd,命令执行函数中存在变量，可能存在任意命令执行漏洞,D:\phpstudy_pro\WWW\cms\xinhu\core\library\phpmailer\class.phpmailer.php,第1057行,"                $sendmail = sprintf(""%s -f%s"", escapeshellcmd($this->Sendmail), escapeshellarg($this->Sender));
"
550,escapeshellcmd,命令执行函数中存在变量，可能存在任意命令执行漏洞,D:\phpstudy_pro\WWW\cms\xinhu\core\library\phpmailer\class.phpmailer.php,第1059行,"                $sendmail = sprintf(""%s -oi -f%s -t"", escapeshellcmd($this->Sendmail), escapeshellarg($this->Sender));
"
551,escapeshellcmd,命令执行函数中存在变量，可能存在任意命令执行漏洞,D:\phpstudy_pro\WWW\cms\xinhu\core\library\phpmailer\class.phpmailer.php,第1063行,"                $sendmail = sprintf(""%s"", escapeshellcmd($this->Sendmail));
"
552,escapeshellcmd,命令执行函数中存在变量，可能存在任意命令执行漏洞,D:\phpstudy_pro\WWW\cms\xinhu\core\library\phpmailer\class.phpmailer.php,第1065行,"                $sendmail = sprintf(""%s -oi -t"", escapeshellcmd($this->Sendmail));
"
553,file_put_contents,文件操作函数中存在变量，可能存在任意文件读取/删除/修改/写入等漏洞,D:\phpstudy_pro\WWW\cms\xinhu\core\library\phpmailer\class.phpmailer.php,第1895行,"                file_put_contents($file, $body); //TODO check this worked
"
554,unlink,文件操作函数中存在变量，可能存在任意文件读取/删除/修改/写入等漏洞,D:\phpstudy_pro\WWW\cms\xinhu\core\library\phpmailer\class.phpmailer.php,第1905行,"                    @unlink($file);
"
555,file_get_contents,文件操作函数中存在变量，可能存在任意文件读取/删除/修改/写入等漏洞,D:\phpstudy_pro\WWW\cms\xinhu\core\library\phpmailer\class.phpmailer.php,第1906行,"                    $body = file_get_contents($signed);
"
556,unlink,文件操作函数中存在变量，可能存在任意文件读取/删除/修改/写入等漏洞,D:\phpstudy_pro\WWW\cms\xinhu\core\library\phpmailer\class.phpmailer.php,第1907行,"                    @unlink($signed);
"
557,unlink,文件操作函数中存在变量，可能存在任意文件读取/删除/修改/写入等漏洞,D:\phpstudy_pro\WWW\cms\xinhu\core\library\phpmailer\class.phpmailer.php,第1905行,"                    @unlink($file);
"
558,unlink,文件操作函数中存在变量，可能存在任意文件读取/删除/修改/写入等漏洞,D:\phpstudy_pro\WWW\cms\xinhu\core\library\phpmailer\class.phpmailer.php,第1907行,"                    @unlink($signed);
"
559,file_get_contents,文件操作函数中存在变量，可能存在任意文件读取/删除/修改/写入等漏洞,D:\phpstudy_pro\WWW\cms\xinhu\core\library\phpmailer\class.phpmailer.php,第2204行,"            $file_buffer = file_get_contents($path);
"
560,file_get_contents,文件操作函数中存在变量，可能存在任意文件读取/删除/修改/写入等漏洞,D:\phpstudy_pro\WWW\cms\xinhu\core\library\phpmailer\class.phpmailer.php,第3187行,"        $privKeyStr = file_get_contents($this->DKIM_private);
"
561,fgets,读取文件函数中存在变量，可能存在任意文件读取漏洞,D:\phpstudy_pro\WWW\cms\xinhu\core\library\phpmailer\class.pop3.php,第340行,"        $r = fgets($this->pop_conn, $size);
"
562,fwrite,读取文件函数中存在变量，可能存在任意文件读取漏洞,D:\phpstudy_pro\WWW\cms\xinhu\core\library\phpmailer\class.pop3.php,第359行,"            return fwrite($this->pop_conn, $string, strlen($string));
"
563,fwrite,读取文件函数中存在变量，可能存在任意文件读取漏洞,D:\phpstudy_pro\WWW\cms\xinhu\core\library\phpmailer\class.smtp.php,第779行,"        return fwrite($this->smtp_conn, $data);
"
564,fgets,读取文件函数中存在变量，可能存在任意文件读取漏洞,D:\phpstudy_pro\WWW\cms\xinhu\core\library\phpmailer\class.smtp.php,第824行,"            $str = @fgets($this->smtp_conn, 515);
"
565,copy,文件操作函数中存在变量，可能存在任意文件读取/删除/修改/写入等漏洞,D:\phpstudy_pro\WWW\cms\xinhu\core\library\qiniu\examples\rs_copy.php,第19行,"$err = $bucketManager->copy($srcBucket, $srcKey, $destBucket, $destKey, true);
"
566,copy,文件操作函数中存在变量，可能存在任意文件读取/删除/修改/写入等漏洞,D:\phpstudy_pro\WWW\cms\xinhu\core\library\qiniu\src\Qiniu\Storage\BucketManager.php,第155行,"    public function copy($from_bucket, $from_key, $to_bucket, $to_key, $force = false)
"
567,fread,读取文件函数中存在变量，可能存在任意文件读取漏洞,D:\phpstudy_pro\WWW\cms\xinhu\core\library\qiniu\src\Qiniu\Storage\ResumeUploader.php,第79行,"            $data = fread($this->inputStream, $blockSize);
"
568,fopen,读取文件函数中存在变量，可能存在任意文件读取漏洞,D:\phpstudy_pro\WWW\cms\xinhu\core\library\qiniu\src\Qiniu\Storage\UploadManager.php,第91行,"        $file = fopen($filePath, 'rb');
"
569,fread,读取文件函数中存在变量，可能存在任意文件读取漏洞,D:\phpstudy_pro\WWW\cms\xinhu\core\library\qiniu\src\Qiniu\Storage\UploadManager.php,第99行,"            $data = fread($file, $size);
"
570,fopen,读取文件函数中存在变量，可能存在任意文件读取漏洞,D:\phpstudy_pro\WWW\cms\xinhu\core\library\qiniu\src\Qiniu\Etag.php,第33行,"        $fhandler = fopen($filename, 'r');
"
571,fread,读取文件函数中存在变量，可能存在任意文件读取漏洞,D:\phpstudy_pro\WWW\cms\xinhu\core\library\qiniu\src\Qiniu\Etag.php,第50行,"            $fdata = fread($fhandler, Config::BLOCK_SIZE);
"
572,fread,读取文件函数中存在变量，可能存在任意文件读取漏洞,D:\phpstudy_pro\WWW\cms\xinhu\core\library\qiniu\src\Qiniu\Etag.php,第61行,"                $fdata = fread($fhandler, Config::BLOCK_SIZE);
"
573,copy,文件操作函数中存在变量，可能存在任意文件读取/删除/修改/写入等漏洞,D:\phpstudy_pro\WWW\cms\xinhu\core\library\qiniu\tests\Qiniu\Tests\BucketTest.php,第78行,"        $this->bucketManager->copy($this->bucketName, $this->key, $this->bucketName, $key);
"
574,copy,文件操作函数中存在变量，可能存在任意文件读取/删除/修改/写入等漏洞,D:\phpstudy_pro\WWW\cms\xinhu\core\library\qiniu\tests\Qiniu\Tests\BucketTest.php,第78行,"        $this->bucketManager->copy($this->bucketName, $this->key, $this->bucketName, $key);
"
575,copy,文件操作函数中存在变量，可能存在任意文件读取/删除/修改/写入等漏洞,D:\phpstudy_pro\WWW\cms\xinhu\core\library\qiniu\tests\Qiniu\Tests\BucketTest.php,第78行,"        $this->bucketManager->copy($this->bucketName, $this->key, $this->bucketName, $key);
"
576,copy,文件操作函数中存在变量，可能存在任意文件读取/删除/修改/写入等漏洞,D:\phpstudy_pro\WWW\cms\xinhu\core\library\qiniu\tests\Qiniu\Tests\BucketTest.php,第78行,"        $this->bucketManager->copy($this->bucketName, $this->key, $this->bucketName, $key);
"
577,unlink,文件操作函数中存在变量，可能存在任意文件读取/删除/修改/写入等漏洞,D:\phpstudy_pro\WWW\cms\xinhu\core\library\qiniu\tests\Qiniu\Tests\EtagTest.php,第12行,"        unlink($file);
"
578,unlink,文件操作函数中存在变量，可能存在任意文件读取/删除/修改/写入等漏洞,D:\phpstudy_pro\WWW\cms\xinhu\core\library\qiniu\tests\Qiniu\Tests\EtagTest.php,第12行,"        unlink($file);
"
579,unlink,文件操作函数中存在变量，可能存在任意文件读取/删除/修改/写入等漏洞,D:\phpstudy_pro\WWW\cms\xinhu\core\library\qiniu\tests\Qiniu\Tests\EtagTest.php,第12行,"        unlink($file);
"
580,unlink,文件操作函数中存在变量，可能存在任意文件读取/删除/修改/写入等漏洞,D:\phpstudy_pro\WWW\cms\xinhu\core\library\qiniu\tests\Qiniu\Tests\EtagTest.php,第12行,"        unlink($file);
"
581,unlink,文件操作函数中存在变量，可能存在任意文件读取/删除/修改/写入等漏洞,D:\phpstudy_pro\WWW\cms\xinhu\core\library\qiniu\tests\Qiniu\Tests\EtagTest.php,第12行,"        unlink($file);
"
582,unlink,文件操作函数中存在变量，可能存在任意文件读取/删除/修改/写入等漏洞,D:\phpstudy_pro\WWW\cms\xinhu\core\library\qiniu\tests\Qiniu\Tests\ResumeUpTest.php,第32行,"        unlink($tempFile);
"
583,unlink,文件操作函数中存在变量，可能存在任意文件读取/删除/修改/写入等漏洞,D:\phpstudy_pro\WWW\cms\xinhu\core\library\qiniu\tests\Qiniu\Tests\ResumeUpTest.php,第32行,"        unlink($tempFile);
"
584,unlink,文件操作函数中存在变量，可能存在任意文件读取/删除/修改/写入等漏洞,D:\phpstudy_pro\WWW\cms\xinhu\core\library\qiniu\tests\Qiniu\Tests\ResumeUpTest.php,第58行,"    //     unlink($tempFile);
"
585,fopen,读取文件函数中存在变量，可能存在任意文件读取漏洞,D:\phpstudy_pro\WWW\cms\xinhu\core\library\qiniu\tests\bootstrap.php,第36行,"    $file = fopen($fileName, 'wb');
"
586,fwrite,读取文件函数中存在变量，可能存在任意文件读取漏洞,D:\phpstudy_pro\WWW\cms\xinhu\core\library\qiniu\tests\bootstrap.php,第39行,"        fwrite($file, ' ');
"
587,file_put_contents,文件操作函数中存在变量，可能存在任意文件读取/删除/修改/写入等漏洞,D:\phpstudy_pro\WWW\cms\xinhu\core\library\qrcode\phpqrcode.php,第239行,"                        file_put_contents(QR_LOG_DIR.basename($outfile).'-errors.txt', date('Y-m-d H:i:s').': '.$err, FILE_APPEND);
"
588,file_put_contents,文件操作函数中存在变量，可能存在任意文件读取/删除/修改/写入等漏洞,D:\phpstudy_pro\WWW\cms\xinhu\core\library\qrcode\phpqrcode.php,第241行,"                        file_put_contents(QR_LOG_DIR.'errors.txt', date('Y-m-d H:i:s').': '.$err, FILE_APPEND);
"
589,file_get_contents,文件操作函数中存在变量，可能存在任意文件读取/删除/修改/写入等漏洞,D:\phpstudy_pro\WWW\cms\xinhu\core\library\qrcode\phpqrcode.php,第877行,"                        self::$frames[$version] = self::unserial(file_get_contents($fileName));
"
590,file_put_contents,文件操作函数中存在变量，可能存在任意文件读取/删除/修改/写入等漏洞,D:\phpstudy_pro\WWW\cms\xinhu\core\library\qrcode\phpqrcode.php,第880行,"                        file_put_contents($fileName, self::serial(self::$frames[$version]));
"
591,file_get_contents,文件操作函数中存在变量，可能存在任意文件读取/删除/修改/写入等漏洞,D:\phpstudy_pro\WWW\cms\xinhu\core\library\qrcode\phpqrcode.php,第2622行,"                    $bitMask = self::unserial(file_get_contents($fileName));
"
592,file_put_contents,文件操作函数中存在变量，可能存在任意文件读取/删除/修改/写入等漏洞,D:\phpstudy_pro\WWW\cms\xinhu\core\library\qrcode\phpqrcode.php,第2627行,"                    file_put_contents($fileName, self::serial($bitMask));
"
593,file_put_contents,文件操作函数中存在变量，可能存在任意文件读取/删除/修改/写入等漏洞,D:\phpstudy_pro\WWW\cms\xinhu\core\library\qrcode\phpqrcode.php,第3281行,"                file_put_contents($outfile, join(""\n"", QRtools::binarize($code->data)));
"
594,ob_start,"函数中存在变量,可能存在变量覆盖漏洞",D:\phpstudy_pro\WWW\cms\xinhu\core\library\qrcode\phpqrcode.php,第3292行,"                ob_start();
"
595,unserialize,序列化函数，可能存在反序列化漏洞,D:\phpstudy_pro\WWW\cms\xinhu\core\library\uc\uc_client\control\app.php,第28行,"			$app['tagtemplates'] = $this->unserialize($app['tagtemplates']);
"
596,fgets,读取文件函数中存在变量，可能存在任意文件读取漏洞,D:\phpstudy_pro\WWW\cms\xinhu\core\library\uc\uc_client\lib\sendmail.inc.php,第46行,"	$lastmessage = fgets($fp, 512);
"
597,fgets,读取文件函数中存在变量，可能存在任意文件读取漏洞,D:\phpstudy_pro\WWW\cms\xinhu\core\library\uc\uc_client\lib\sendmail.inc.php,第46行,"	$lastmessage = fgets($fp, 512);
"
598,fgets,读取文件函数中存在变量，可能存在任意文件读取漏洞,D:\phpstudy_pro\WWW\cms\xinhu\core\library\uc\uc_client\lib\sendmail.inc.php,第61行," 		$lastmessage = fgets($fp, 512);
"
599,fgets,读取文件函数中存在变量，可能存在任意文件读取漏洞,D:\phpstudy_pro\WWW\cms\xinhu\core\library\uc\uc_client\lib\sendmail.inc.php,第66行,"		$lastmessage = fgets($fp, 512);
"
600,fgets,读取文件函数中存在变量，可能存在任意文件读取漏洞,D:\phpstudy_pro\WWW\cms\xinhu\core\library\uc\uc_client\lib\sendmail.inc.php,第66行,"		$lastmessage = fgets($fp, 512);
"
601,fgets,读取文件函数中存在变量，可能存在任意文件读取漏洞,D:\phpstudy_pro\WWW\cms\xinhu\core\library\uc\uc_client\lib\sendmail.inc.php,第66行,"		$lastmessage = fgets($fp, 512);
"
602,fgets,读取文件函数中存在变量，可能存在任意文件读取漏洞,D:\phpstudy_pro\WWW\cms\xinhu\core\library\uc\uc_client\lib\sendmail.inc.php,第46行,"	$lastmessage = fgets($fp, 512);
"
603,fgets,读取文件函数中存在变量，可能存在任意文件读取漏洞,D:\phpstudy_pro\WWW\cms\xinhu\core\library\uc\uc_client\lib\sendmail.inc.php,第66行,"		$lastmessage = fgets($fp, 512);
"
604,fgets,读取文件函数中存在变量，可能存在任意文件读取漏洞,D:\phpstudy_pro\WWW\cms\xinhu\core\library\uc\uc_client\lib\sendmail.inc.php,第101行,"			$lastmessage = fgets($fp, 512);
"
605,fgets,读取文件函数中存在变量，可能存在任意文件读取漏洞,D:\phpstudy_pro\WWW\cms\xinhu\core\library\uc\uc_client\lib\sendmail.inc.php,第104行,"				$lastmessage = fgets($fp, 512);
"
606,fgets,读取文件函数中存在变量，可能存在任意文件读取漏洞,D:\phpstudy_pro\WWW\cms\xinhu\core\library\uc\uc_client\lib\sendmail.inc.php,第46行,"	$lastmessage = fgets($fp, 512);
"
607,fgets,读取文件函数中存在变量，可能存在任意文件读取漏洞,D:\phpstudy_pro\WWW\cms\xinhu\core\library\uc\uc_client\lib\sendmail.inc.php,第46行,"	$lastmessage = fgets($fp, 512);
"
608,unserialize,序列化函数，可能存在反序列化漏洞,D:\phpstudy_pro\WWW\cms\xinhu\core\library\uc\uc_client\lib\xml.class.php,第10行,"function xml_unserialize(&$xml, $isnormal = FALSE) {
"
609,unserialize,序列化函数，可能存在反序列化漏洞,D:\phpstudy_pro\WWW\cms\xinhu\core\library\uc\uc_client\model\app.php,第29行,"			isset($v['extra']) && !empty($v['extra']) && $v['extra'] = unserialize($v['extra']);
"
610,unserialize,序列化函数，可能存在反序列化漏洞,D:\phpstudy_pro\WWW\cms\xinhu\core\library\uc\uc_client\model\base.php,第125行,"				$return[$arr['k']] = $decode ? unserialize($arr['v']) : $arr['v'];
"
611,unserialize,序列化函数，可能存在反序列化漏洞,D:\phpstudy_pro\WWW\cms\xinhu\core\library\uc\uc_client\model\base.php,第224行,"	function unserialize($s) {
"
612,unserialize,序列化函数，可能存在反序列化漏洞,D:\phpstudy_pro\WWW\cms\xinhu\core\library\uc\uc_client\model\base.php,第225行,"		return uc_unserialize($s);
"
613,file_put_contents,文件操作函数中存在变量，可能存在任意文件读取/删除/修改/写入等漏洞,D:\phpstudy_pro\WWW\cms\xinhu\core\library\uc\uc_client\model\cache.php,第13行,"	function file_put_contents($filename, $s) {
"
614,fopen,读取文件函数中存在变量，可能存在任意文件读取漏洞,D:\phpstudy_pro\WWW\cms\xinhu\core\library\uc\uc_client\model\cache.php,第14行,"		$fp = @fopen($filename, 'w');
"
615,fwrite,读取文件函数中存在变量，可能存在任意文件读取漏洞,D:\phpstudy_pro\WWW\cms\xinhu\core\library\uc\uc_client\model\cache.php,第15行,"		@fwrite($fp, $s);
"
616,unserialize,序列化函数，可能存在反序列化漏洞,D:\phpstudy_pro\WWW\cms\xinhu\core\library\uc\uc_client\model\cache.php,第89行,"				$v['extra'] = unserialize($v['extra']);
"
617,fopen,读取文件函数中存在变量，可能存在任意文件读取漏洞,D:\phpstudy_pro\WWW\cms\xinhu\core\library\uc\uc_client\model\misc.php,第62行,"		return $this->dfopen($url, $limit, $post, $cookie, $bysocket, $ip, $timeout, $block, $encodetype);
"
618,fopen,读取文件函数中存在变量，可能存在任意文件读取漏洞,D:\phpstudy_pro\WWW\cms\xinhu\core\library\uc\uc_client\model\misc.php,第65行,"	function dfopen($url, $limit = 0, $post = '', $cookie = '', $bysocket = FALSE	, $ip = '', $timeout = 15, $block = TRUE, $encodetype  = 'URLENCODE') {
"
619,fwrite,读取文件函数中存在变量，可能存在任意文件读取漏洞,D:\phpstudy_pro\WWW\cms\xinhu\core\library\uc\uc_client\model\misc.php,第111行,"			@fwrite($fp, $out);
"
620,fgets,读取文件函数中存在变量，可能存在任意文件读取漏洞,D:\phpstudy_pro\WWW\cms\xinhu\core\library\uc\uc_client\model\misc.php,第115行,"					if(($header = @fgets($fp)) && ($header == ""\r\n"" ||  $header == ""\n"")) {
"
621,fread,读取文件函数中存在变量，可能存在任意文件读取漏洞,D:\phpstudy_pro\WWW\cms\xinhu\core\library\uc\uc_client\model\misc.php,第122行,"					$data = fread($fp, ($limit == 0 || $limit > 8192 ? 8192 : $limit));
"
622,parse_str,"函数中存在变量,可能存在变量覆盖漏洞",D:\phpstudy_pro\WWW\cms\xinhu\core\library\uc\uc_client\model\note.php,第122行,"				parse_str($note['getdata'], $note['getdata']);
"
623,unserialize,序列化函数，可能存在反序列化漏洞,D:\phpstudy_pro\WWW\cms\xinhu\core\library\uc\uc_client\model\note.php,第126行,"				$note['postdata'] = xml_unserialize($note['postdata']);
"
624,unserialize,序列化函数，可能存在反序列化漏洞,D:\phpstudy_pro\WWW\cms\xinhu\core\library\uc\uc_client\model\note.php,第136行,"		$returnsucceed = $response != '' && ($response == 1 || is_array(xml_unserialize($response)));
"
625,unserialize,序列化函数，可能存在反序列化漏洞,D:\phpstudy_pro\WWW\cms\xinhu\core\library\uc\uc_client\model\pm.php,第153行,"		$lastmessage = unserialize($lastpm['lastmessage']);
"
626,unserialize,序列化函数，可能存在反序列化漏洞,D:\phpstudy_pro\WWW\cms\xinhu\core\library\uc\uc_client\model\pm.php,第343行,"			$lastmessage = unserialize($threadpm['lastmessage']);
"
627,unserialize,序列化函数，可能存在反序列化漏洞,D:\phpstudy_pro\WWW\cms\xinhu\core\library\uc\uc_client\model\pm.php,第796行,"				$lastmessage = unserialize($data['lastmessage']);
"
628,unserialize,序列化函数，可能存在反序列化漏洞,D:\phpstudy_pro\WWW\cms\xinhu\core\library\uc\uc_client\model\tag.php,第39行,"		$data = xml_unserialize($data);
"
629,unserialize,序列化函数，可能存在反序列化漏洞,D:\phpstudy_pro\WWW\cms\xinhu\core\library\uc\uc_client\client.php,第114行,"function uc_unserialize($s) {
"
630,unserialize,序列化函数，可能存在反序列化漏洞,D:\phpstudy_pro\WWW\cms\xinhu\core\library\uc\uc_client\client.php,第116行,"	return xml_unserialize($s);
"
631,fopen,读取文件函数中存在变量，可能存在任意文件读取漏洞,D:\phpstudy_pro\WWW\cms\xinhu\core\library\uc\uc_client\client.php,第175行,"	return uc_fopen($url, $limit, $post, $cookie, $bysocket, $ip, $timeout, $block);
"
632,fopen,读取文件函数中存在变量，可能存在任意文件读取漏洞,D:\phpstudy_pro\WWW\cms\xinhu\core\library\uc\uc_client\client.php,第178行,"function uc_fopen($url, $limit = 0, $post = '', $cookie = '', $bysocket = FALSE, $ip = '', $timeout = 15, $block = TRUE) {
"
633,fwrite,读取文件函数中存在变量，可能存在任意文件读取漏洞,D:\phpstudy_pro\WWW\cms\xinhu\core\library\uc\uc_client\client.php,第225行,"		@fwrite($fp, $out);
"
634,fgets,读取文件函数中存在变量，可能存在任意文件读取漏洞,D:\phpstudy_pro\WWW\cms\xinhu\core\library\uc\uc_client\client.php,第229行,"				if(($header = @fgets($fp)) && ($header == ""\r\n"" ||  $header == ""\n"")) {
"
635,fread,读取文件函数中存在变量，可能存在任意文件读取漏洞,D:\phpstudy_pro\WWW\cms\xinhu\core\library\uc\uc_client\client.php,第236行,"				$data = fread($fp, ($limit == 0 || $limit > 8192 ? 8192 : $limit));
"
636,unserialize,序列化函数，可能存在反序列化漏洞,D:\phpstudy_pro\WWW\cms\xinhu\core\library\uc\uc_client\client.php,第251行,"	return UC_CONNECT == 'mysql' ? $return : uc_unserialize($return);
"
637,unserialize,序列化函数，可能存在反序列化漏洞,D:\phpstudy_pro\WWW\cms\xinhu\core\library\uc\uc_client\client.php,第251行,"	return UC_CONNECT == 'mysql' ? $return : uc_unserialize($return);
"
638,unserialize,序列化函数，可能存在反序列化漏洞,D:\phpstudy_pro\WWW\cms\xinhu\core\library\uc\uc_client\client.php,第251行,"	return UC_CONNECT == 'mysql' ? $return : uc_unserialize($return);
"
639,unserialize,序列化函数，可能存在反序列化漏洞,D:\phpstudy_pro\WWW\cms\xinhu\core\library\uc\uc_client\client.php,第251行,"	return UC_CONNECT == 'mysql' ? $return : uc_unserialize($return);
"
640,unserialize,序列化函数，可能存在反序列化漏洞,D:\phpstudy_pro\WWW\cms\xinhu\core\library\uc\uc_client\client.php,第251行,"	return UC_CONNECT == 'mysql' ? $return : uc_unserialize($return);
"
641,unserialize,序列化函数，可能存在反序列化漏洞,D:\phpstudy_pro\WWW\cms\xinhu\core\library\uc\uc_client\client.php,第251行,"	return UC_CONNECT == 'mysql' ? $return : uc_unserialize($return);
"
642,unserialize,序列化函数，可能存在反序列化漏洞,D:\phpstudy_pro\WWW\cms\xinhu\core\library\uc\uc_client\client.php,第393行,"	return (!$more || UC_CONNECT == 'mysql') ? $return : uc_unserialize($return);
"
643,unserialize,序列化函数，可能存在反序列化漏洞,D:\phpstudy_pro\WWW\cms\xinhu\core\library\uc\uc_client\client.php,第251行,"	return UC_CONNECT == 'mysql' ? $return : uc_unserialize($return);
"
644,unserialize,序列化函数，可能存在反序列化漏洞,D:\phpstudy_pro\WWW\cms\xinhu\core\library\uc\uc_client\client.php,第251行,"	return UC_CONNECT == 'mysql' ? $return : uc_unserialize($return);
"
645,unserialize,序列化函数，可能存在反序列化漏洞,D:\phpstudy_pro\WWW\cms\xinhu\core\library\uc\uc_client\client.php,第251行,"	return UC_CONNECT == 'mysql' ? $return : uc_unserialize($return);
"
646,unserialize,序列化函数，可能存在反序列化漏洞,D:\phpstudy_pro\WWW\cms\xinhu\core\library\uc\uc_client\client.php,第251行,"	return UC_CONNECT == 'mysql' ? $return : uc_unserialize($return);
"
647,unserialize,序列化函数，可能存在反序列化漏洞,D:\phpstudy_pro\WWW\cms\xinhu\core\library\uc\uc_client\client.php,第251行,"	return UC_CONNECT == 'mysql' ? $return : uc_unserialize($return);
"
648,unserialize,序列化函数，可能存在反序列化漏洞,D:\phpstudy_pro\WWW\cms\xinhu\core\library\uc\uc_client\client.php,第251行,"	return UC_CONNECT == 'mysql' ? $return : uc_unserialize($return);
"
649,unserialize,序列化函数，可能存在反序列化漏洞,D:\phpstudy_pro\WWW\cms\xinhu\core\library\uc\uc_client\client.php,第577行,"	$data = uc_unserialize($return);
"
650,foreach,"函数中存在变量,可能存在变量覆盖漏洞",D:\phpstudy_pro\WWW\cms\xinhu\core\core.php,第138行,"foreach($_COOKIE as $key => $value) {
"
651,file_get_contents,文件操作函数中存在变量，可能存在任意文件读取/删除/修改/写入等漏洞,D:\phpstudy_pro\WWW\cms\xinhu\custom\actions\member\login.php,第232行,"		$result=file_get_contents($api);
"
652,file_get_contents,文件操作函数中存在变量，可能存在任意文件读取/删除/修改/写入等漏洞,D:\phpstudy_pro\WWW\cms\xinhu\custom\actions\member\login.php,第314行,"		$res=file_get_contents($url);
"
653,file_get_contents,文件操作函数中存在变量，可能存在任意文件读取/删除/修改/写入等漏洞,D:\phpstudy_pro\WWW\cms\xinhu\custom\actions\member\login.php,第314行,"		$res=file_get_contents($url);
"
654,file_get_contents,文件操作函数中存在变量，可能存在任意文件读取/删除/修改/写入等漏洞,D:\phpstudy_pro\WWW\cms\xinhu\custom\actions\wechat_login.php,第16行,"		$result=file_get_contents($url);
"
655,file_get_contents,文件操作函数中存在变量，可能存在任意文件读取/删除/修改/写入等漏洞,D:\phpstudy_pro\WWW\cms\xinhu\custom\actions\wechat_login.php,第26行,"			$result=file_get_contents($url);
"
656,unlink,文件操作函数中存在变量，可能存在任意文件读取/删除/修改/写入等漏洞,D:\phpstudy_pro\WWW\cms\xinhu\include\chajian\cacheChajian.php,第55行,"				unlink($fil1);
"
657,file_get_contents,文件操作函数中存在变量，可能存在任意文件读取/删除/修改/写入等漏洞,D:\phpstudy_pro\WWW\cms\xinhu\include\chajian\cacheChajian.php,第72行,"				$cont = file_get_contents($file);
"
658,unlink,文件操作函数中存在变量，可能存在任意文件读取/删除/修改/写入等漏洞,D:\phpstudy_pro\WWW\cms\xinhu\include\chajian\cacheChajian.php,第78行,"				unlink($file); //已经过期了
"
659,unlink,文件操作函数中存在变量，可能存在任意文件读取/删除/修改/写入等漏洞,D:\phpstudy_pro\WWW\cms\xinhu\include\chajian\cacheChajian.php,第90行,"		if(file_exists($file))@unlink($file);
"
660,unlink,文件操作函数中存在变量，可能存在任意文件读取/删除/修改/写入等漏洞,D:\phpstudy_pro\WWW\cms\xinhu\include\chajian\cacheChajian.php,第101行,"			unlink($fil1);
"
661,unlink,文件操作函数中存在变量，可能存在任意文件读取/删除/修改/写入等漏洞,D:\phpstudy_pro\WWW\cms\xinhu\include\chajian\cacheChajian.php,第117行,"						unlink($fil1);
"
662,file_get_contents,文件操作函数中存在变量，可能存在任意文件读取/删除/修改/写入等漏洞,D:\phpstudy_pro\WWW\cms\xinhu\include\chajian\curlChajian.php,第42行,"		@$result = file_get_contents($url);
"
663,file_get_contents,文件操作函数中存在变量，可能存在任意文件读取/删除/修改/写入等漏洞,D:\phpstudy_pro\WWW\cms\xinhu\include\chajian\curlChajian.php,第61行,"		@$sFile 	= file_get_contents($url, false, $cxContext);  
"
664,unlink,文件操作函数中存在变量，可能存在任意文件读取/删除/修改/写入等漏洞,D:\phpstudy_pro\WWW\cms\xinhu\include\chajian\downChajian.php,第87行,"			@unlink($allfilename);
"
665,unlink,文件操作函数中存在变量，可能存在任意文件读取/删除/修改/写入等漏洞,D:\phpstudy_pro\WWW\cms\xinhu\include\chajian\downChajian.php,第87行,"			@unlink($allfilename);
"
666,unlink,文件操作函数中存在变量，可能存在任意文件读取/删除/修改/写入等漏洞,D:\phpstudy_pro\WWW\cms\xinhu\include\chajian\fileChajian.php,第236行,"			$bool = unlink($file);
"
667,include_once,"文件包含函数中存在变量,可能存在文件包含漏洞",D:\phpstudy_pro\WWW\cms\xinhu\include\chajian\PHPExcelChajian.php,第41行,"			include_once($pastr);
"
668,file_get_contents,文件操作函数中存在变量，可能存在任意文件读取/删除/修改/写入等漏洞,D:\phpstudy_pro\WWW\cms\xinhu\include\chajian\rockeditChajian.php,第87行,"				'data' 		=> $this->rock->jm->base64encode(file_get_contents($filepath)),
"
669,escapeshellcmd,命令执行函数中存在变量，可能存在任意命令执行漏洞,D:\phpstudy_pro\WWW\cms\xinhu\include\chajian\rockqueueChajian.php,第108行,"			'url'		=> escapeshellcmd($cmd),
"
670,fwrite,读取文件函数中存在变量，可能存在任意文件读取漏洞,D:\phpstudy_pro\WWW\cms\xinhu\include\chajian\socketChajian.php,第53行,"				fwrite($handle, $str);  
"
671,fread,读取文件函数中存在变量，可能存在任意文件读取漏洞,D:\phpstudy_pro\WWW\cms\xinhu\include\chajian\socketChajian.php,第54行,"				//$bstr = fread($handle, 1024); //去掉这个，不然容易阻塞
"
672,unlink,文件操作函数中存在变量，可能存在任意文件读取/删除/修改/写入等漏洞,D:\phpstudy_pro\WWW\cms\xinhu\include\chajian\upfileChajian.php,第98行,"				@unlink($file);
"
673,file_get_contents,文件操作函数中存在变量，可能存在任意文件读取/删除/修改/写入等漏洞,D:\phpstudy_pro\WWW\cms\xinhu\include\chajian\upfileChajian.php,第245行,"			$filebase64	= base64_encode(file_get_contents($oldfile));
"
674,unlink,文件操作函数中存在变量，可能存在任意文件读取/删除/修改/写入等漏洞,D:\phpstudy_pro\WWW\cms\xinhu\include\chajian\upfileChajian.php,第248行,"			@unlink($oldfile);
"
675,file_get_contents,文件操作函数中存在变量，可能存在任意文件读取/删除/修改/写入等漏洞,D:\phpstudy_pro\WWW\cms\xinhu\include\chajian\xinhuapiChajian.php,第7行,"*/  class xinhuapiChajian extends Chajian{ private $updatekey = ''; private $updatekeys = ''; private $systemnum = ''; private $smsapikey = ''; protected function initChajian() { if(getconfig('systype')=='dev'){ $this->updatekeys = 'aHR0cDovLzEyNy4wLjAuMS9hcHAvcm9ja2FwaS8:'; }else{ $this->updatekeys = 'aHR0cDovL2FwaS5yb2Nrb2EuY29tLw::'; } $this->updatekey =$this->rock->jm->base64decode($this->updatekeys); $this->getsysnum(); } private function getsysnum() { $dbs = m('option'); $this->systemnum = $dbs->getval('systemnum'); $this->smsapikey = $dbs->getval('sms_apikey'); $this->qiannum = $dbs->getval('sms_qmnum'); $this->sendtype = $dbs->getval('sms_dirtype'); if(isempt($this->qiannum))$this->qiannum = ''; if(isempt($this->systemnum)){ $rnd = md5(str_shuffle('abcedfghijk').rand(1000,9999)); $dbs->setval('systemnum', $rnd); $this->systemnum = $rnd; } return $this->systemnum; } public function geturlstr($mod, $act, $can=array()) { $url = $this->updatekey; $url.= '?m='.$mod.'&a='.$act.''; $url.= '&host='.$this->rock->jm->base64encode(HOST).'&version='.VERSION.'&randtime='.time().'&ip='.$this->rock->ip.'&xinhukey='.getconfig('xinhukey').'&sysnum='.$this->systemnum.''; if(!isempt($this->smsapikey))$url.='&smsapikey='.$this->smsapikey.''; $url.= '&authorkey='.getconfig('authorkey').''; foreach($can as $k=>$v)$url.='&'.$k.'='.$v.''; return $url; } public function getdata($mod, $act, $can=array()) { $url = $this->geturlstr($mod, $act, $can); $cont = c('curl')->getcurl($url); if(!isempt($cont) && contain($cont, 'success')){ $data = json_decode($cont, true); }else{ $data = returnerror('无法访问到官网API的,'.$cont.''); } return $data; } public function postdata($mod, $act, $can=array()) { $url = $this->geturlstr($mod, $act); $cont = c('curl')->postcurl($url, $can); if(!isempt($cont) && contain($cont, 'success')){ $data = json_decode($cont, true); }else{ $data = returnerror('无法访问到官网API的,'.$cont.''); } return $data; } public function send($tomobile,$qiannum, $tplnum, $params=array(), $url='', $addlog=true) { if(isempt($qiannum))$qiannum = $this->qiannum; if(!isempt($this->sendtype)){ if(!isset($params['url']) && $url)$params['url'] = $url; $barr = c($this->sendtype)->send($tomobile, $qiannum, $tplnum, $params); }else{ $para['sys_tomobile'] = $tomobile; $para['sys_tplnum'] = $tplnum; $para['sys_qiannum'] = $qiannum; $para['sys_url'] = $this->rock->jm->base64encode($url); foreach($params as $k=>$v)$para['can_'.$k.''] = $v; $barr = $this->postdata('sms','send', $para); } if(!$barr['success'] && $addlog)m('log')->addlogs('短信', $barr['msg'],2); return $barr; } public function sendsms($receid, $qiannum, $tplnum, $params=array(), $url='', $addlog=true, $isyb=true) { if(isempt($receid))return returnerror('没有接收人'); $receda = explode(',', $receid); if(c('check')->iscnmobile($receda[0])){ $tomobile = $receid; }else{ $tomobile = m('admin')->getjoinfields($receid, 'mobile'); } if(isempt($tomobile))return returnerror('接收人['.$receid.']可能没设置手机号'); $toama = explode(',', $tomobile); $toarr = array(); foreach($toama as $tostr)if(!contain($tostr,'000000'))$toarr[]=$tostr; if(!$toarr)return returnerror('接收人的手机号不完整'); $tomobile = join(',', $toarr); if(isempt($qiannum))$qiannum = $this->qiannum; if(getconfig('asynsend') && $isyb){ $ybbo = m('reim')->asynurl('asynrun','sendsms', array( 'tomobile' => $tomobile, 'qiannum' => $qiannum, 'tplnum' => $tplnum, 'url' => $this->rock->jm->base64encode($url), 'params' => $this->rock->jm->base64encode(json_encode($params)), )); if($ybbo)return returnsuccess('异步发送'); } return $this->send($tomobile, $qiannum, $tplnum, $params, $url, $addlog); } public function sendanay($m, $a,$can=array(), $runtime=0) { $runurl = m('base')->getasynurl($m, $a,$can, 1); $barr = $this->sendanayurl($runurl, $runtime); return $barr; } public function sendanayurl($runurl, $runtime=0) { if(isempt($runurl))return returnerror('异步调用地址不能为空'); $para = array( 'runurl' => $this->rock->jm->base64encode($runurl), 'runtime' => $runtime, ); $barr = $this->postdata('anay','send', $para); if(!$barr['success'])m('log')->addlogs('调用官网异步', $barr['msg'],2); return $barr; } public function getvercode($tomobile, $device, $tplnum='', $qiannum='') { if(isempt($tomobile))return returnerror('接收手机号不能为空'); if($tplnum=='')$tplnum = m('option')->getval('sms_yanzm'); if(isempt($tplnum))$tplnum = 'defyzm'; $otme = 0; $lorsr = m('log')->getone(""`type`='获取验证码' and (`optname`='$tomobile' or `device`='$device')"",'`optdt`','id desc'); if($lorsr)$otme = strtotime($lorsr['optdt']); $jgtims = 60; $jgtime = time()-$otme; if($otme>0 && $jgtime<$jgtims)return returnerror('获取太频繁,请'.($jgtims-$jgtime).'秒后在试'); $code = '5'.rand(10000,99999); $params['code'] = $code; $kaifbo = (getconfig('systype')=='dev' || getconfig('systype')=='demo'); if(!$kaifbo){ $barr = $this->send($tomobile, $qiannum, $tplnum, $params); }else{ $barr = returnsuccess('ok'); } if($barr['success']){ m('log')->addlog('获取验证码', '获取验证码为：'.$code.'', array( 'device' => $device, 'optname' => $tomobile, 'optid' => $code )); $barr['data'] = ''; if($kaifbo)$barr['data'] = $code; } return $barr; } public function checkcode($tomobile, $code, $device) { if(isempt($tomobile))return returnerror('手机号不能为空'); if(isempt($code))return returnerror('验证码不能为空'); $youxiaq= 5*60; $optdt = date('Y-m-d H:i:s', time()-$youxiaq); $ors = m('log')->getone(""`type`='获取验证码' and `optname`='$tomobile' and `device`='$device' and `optdt`>'$optdt'"",'`optid`,`optdt`,`id`','`id` desc'); if(!$ors)return returnerror('请先获取验证码'); if($code!=$ors['optid'])return returnerror('验证码错误'); m('log')->update('`optid`=0', $ors['id']); return returnsuccess('ok'); } public function starttask() { $turl = getconfig('anayurl', URL); $url = ''.$turl.'task.php?m=runt&a=task'; $barr = $this->postdata('anay','starttask', array( 'runurl' => $this->rock->jm->base64encode($url) )); return $barr; } public function stoptask() { $barr = $this->getdata('anay','stoptask'); return $barr; } public function officesend($fileid, $lx=0) { $yulx = ',doc,docx,xls,xlsx,ppt,pptx,'; $frs = m('file')->getone($fileid); if(!$frs)return returnerror('文件不存在1'); $filepath = $frs['filepath']; $fileext = $frs['fileext']; $filesize = floatval($frs['filesize']); if(!contain($yulx,','.$fileext.','))return returnerror('不是文档类型'); if(isempt($filepath))return returnerror('文件路径是空的'); if(substr($filepath, 0,4)!='http' && !file_exists($filepath))return returnerror('文件不存在2'); $pdfpath = $frs['pdfpath']; if(!isempt($pdfpath) && file_exists($pdfpath))return returnerror('已转过了'); $localpath = $frs['filepath']; if(substr($filepath, 0,4)=='http'){ $localpath = ''.UPDIR.'/'.date('Y-m').'/'.date('d_His').''.rand(10,99).'_temp.'.$fileext.''; $this->rock->createtxt($localpath, @file_get_contents($filepath)); if(!file_exists($localpath))return returnerror('无法下载远程文件，不能转换'); $filesize = filesize($localpath); if($filesize==0)return returnerror('远程文件已损坏'); } $officeyl = getconfig('officeyl'); $cache = c('cache'); $zhkey = 'filetopdf'.$fileid.''; $zhval = $cache->get($zhkey); if(isempt($zhval)){ if($officeyl=='1'){ $barr = $this->postdata('office','recedata', array( 'data' => $this->rock->jm->base64encode(file_get_contents($localpath)), 'fileid' => $fileid, 'fileext' => $fileext, 'filesize' => $filesize, 'filesizecn'=> $frs['filesizecn'], 'backurl' => $this->rock->jm->base64encode(m('base')->getasynurl('asynrun','gwpdf',array( 'fileid' => $fileid ),2)) )); }else if($officeyl=='4'){ $barr = c('libreoffice')->filetopdf($fileid); }else{ if(!contain(PHP_OS,'WIN'))return returnerror('只能在windows的服务器下转化'); $bo = c('socket')->topdf($localpath, $fileid, $fileext); if(!$bo || is_string($bo))return returnerror(''.$bo.'，'.c('xinhu')->helpstr('topdf').''); $barr = returnsuccess(); } }else{ $barr = returnsuccess(); } if($barr['success']){ $times = ceil($filesize/(30*1024))+10; if($times<10)$times = 10; $cache->set($zhkey,'true', $times+5); if(!is_array($barr['data']))$barr['data'] = array(); $barr['data']['times'] = $times; $barr['data']['localpath'] = $this->rock->jm->base64encode($localpath); } return $barr; } public function officestatus($fileid) { if(getconfig('officeyl')=='1'){ $barr = $this->getdata('office','getstatus', array( 'fileid' => $fileid )); }else{ $frs = m('file')->getone($fileid); if(!$frs)return returnerror('文件不存在1'); $filepath = $frs['filepath']; $localpath = $this->rock->get('localpath'); if(!isempt($localpath)){ $filepath = $this->rock->jm->base64decode($localpath); } $pdfpath = str_replace('.'.$frs['fileext'].'', '.pdf', $filepath); $status = 0; if(file_exists($pdfpath)){ $status = 1; } if($status==1){ m('file')->update(array( 'pdfpath' => $pdfpath ), $fileid); } $barr = returnsuccess(array('status'=>$status,'ftype'=>'0')); } return $barr; } public function officedown($fileid) { $barr = $this->getdata('office','down', array( 'fileid' => $fileid )); if($barr['success']){ $data = $barr['data']; $pdfpath = $data['pdfpath']; $this->rock->createtxt($pdfpath, $this->rock->jm->base64decode($data['data'])); m('file')->update(array( 'pdfpath' => $pdfpath, ),$fileid); $barr = returnsuccess(); } return $barr; } public function getjiari() { $barr = $this->getdata('base','getjiari'); return $barr; } public function authercheck($key, $ym) { if(isempt($key))return returnerror('密钥格不能为空'); if(isempt($ym))return returnerror('域名不能为空'); $barr = $this->getdata('auther','check', array( 'autherkey' => $key, 'yuming' => $ym, 'randkey' => getconfig('randkey') )); if($barr['success']){ $da = $barr['data']; $this->saveauther($da, $key); return returnsuccess(); }else{ return $barr; } } private function saveauther($da, $key) { $db = m('option'); $db->setval('auther_enddt@-101', $da['enddt']); $db->setval('auther_yuming@-101', $da['yuming']); $db->setval('auther_authkey@-101', $da['authkey']); $db->setval('auther_aukey@-101', $key); m('chargems')->update(""`updatedt`='2020-02-02 02:02:02'"",""`type`=0 and `mid` in(1,22)""); } public function autherfile($da, $key, $ym) { $da['enddt'] = $this->rock->jm->encrypt($this->rock->jm->strunlook($da['enddt'],$key)); $yuming = $this->rock->jm->strunlook($da['yuming'],$key); $xhkey1 = $this->rock->jm->strunlook($da['xhkey'],$key); $da['yuming'] = $this->rock->jm->encrypt($yuming); $da['authkey'] = $this->rock->jm->base64encode($this->rock->jm->strunlook($da['authkey'],$key)); $xhkey = getconfig('xinhukey'); if(isempt($xhkey))return returnerror($this->rock->jm->base64decode('6K!35YWI5Yiw57O757uf6K6!572u5LiL6K6!572u5L!h5ZG85a6Y572Ra2V5')); if($xhkey1!=$xhkey)return returnerror($this->rock->jm->base64decode('5L!h5ZG85a6Y572Ra2V55LiN5LiA6Ie077yM6K!36YeN5paw6K6!572u')); if(!contain(','.$yuming.',',','.$ym.','))return returnerror(''.$ym.'不在签授域名里'); $this->saveauther($da, $key); return returnsuccess(); } public function autherdel() { $aukey = m('option')->getval('auther_aukey'); m('option')->update('`value`=null','pid=-101'); if(!isempt($aukey)){ $barr = $this->getdata('auther','delkey', array( 'autherkey' => $aukey, 'randkey' => getconfig('randkey') )); return $barr; } return returnsuccess(); } }"
676,file_get_contents,文件操作函数中存在变量，可能存在任意文件读取/删除/修改/写入等漏洞,D:\phpstudy_pro\WWW\cms\xinhu\include\chajian\zipChajian.php,第34行,"			$oldcont 	= file_get_contents($file_name);
"
677,copy,文件操作函数中存在变量，可能存在任意文件读取/删除/修改/写入等漏洞,D:\phpstudy_pro\WWW\cms\xinhu\include\chajian\zipChajian.php,第38行,"				copy($file_name, $barfile);
"
678,file_put_contents,文件操作函数中存在变量，可能存在任意文件读取/删除/修改/写入等漏洞,D:\phpstudy_pro\WWW\cms\xinhu\include\chajian\zipChajian.php,第41行,"		@$bos 			= file_put_contents($file_name,$file_content);
"
679,`$,``反引号中包含变量，变量可控会导致命令执行漏洞,D:\phpstudy_pro\WWW\cms\xinhu\include\class\mysql.php,第368行,"			'fields'=> ""`$kfied`,$fields""
"
680,`$,``反引号中包含变量，变量可控会导致命令执行漏洞,D:\phpstudy_pro\WWW\cms\xinhu\include\class\mysql.php,第511行,"		$sql=""insert into `$table` ($name) "";
"
681,`$,``反引号中包含变量，变量可控会导致命令执行漏洞,D:\phpstudy_pro\WWW\cms\xinhu\include\class\mysql.php,第523行,"		$sql=""update `$table` set $content where $where "";
"
682,`$,``反引号中包含变量，变量可控会导致命令执行漏洞,D:\phpstudy_pro\WWW\cms\xinhu\include\class\mysql.php,第530行,"		$sql=""delete from `$table` where $where "";
"
683,`$,``反引号中包含变量，变量可控会导致命令执行漏洞,D:\phpstudy_pro\WWW\cms\xinhu\include\class\mysql.php,第544行,"				$cont.="",`$key`="".$this->toaddval($val)."""";
"
684,`$,``反引号中包含变量，变量可控会导致命令执行漏洞,D:\phpstudy_pro\WWW\cms\xinhu\include\class\mysql.php,第551行,"			$sql=""insert into `$table` set $cont"";
"
685,`$,``反引号中包含变量，变量可控会导致命令执行漏洞,D:\phpstudy_pro\WWW\cms\xinhu\include\class\mysql.php,第554行,"			$sql=""update `$table` set $cont where $where"";
"
686,`$,``反引号中包含变量，变量可控会导致命令执行漏洞,D:\phpstudy_pro\WWW\cms\xinhu\include\class\mysql.php,第628行,"		$sql = ""show create table `$table`"";
"
687,`$,``反引号中包含变量，变量可控会导致命令执行漏洞,D:\phpstudy_pro\WWW\cms\xinhu\include\class\mysql.php,第687行,"		$rsnum	= $this->getmou($table,$field,""`$field`='$num'"");
"
688,`$,``反引号中包含变量，变量可控会导致命令执行漏洞,D:\phpstudy_pro\WWW\cms\xinhu\include\class\mysql.php,第704行,"		$where 	= ""`$fields` like '"".$num.""%' $whe"";
"
689,`$,``反引号中包含变量，变量可控会导致命令执行漏洞,D:\phpstudy_pro\WWW\cms\xinhu\include\class\mysql.php,第705行,"		$max	= (int)$this->getmou($table, ""max(cast(replace(`$fields`,'$num','') as decimal(10)))"", $where);
"
690,`$,``反引号中包含变量，变量可控会导致命令执行漏洞,D:\phpstudy_pro\WWW\cms\xinhu\include\class\mysql.php,第731行,"		$rsa	= $this->getone($table,""`$afield`='$afid'"",""`id`,`$pfields`,`$jfield`"");
"
691,`$,``反引号中包含变量，变量可控会导致命令执行漏洞,D:\phpstudy_pro\WWW\cms\xinhu\include\class\mysql.php,第735行,"			if($pid!=$afid)if($this->rows($table,""`$afield`='$pid'"")>0)$this->getpvala($table,$pfields,$jfield,$pid,$afield,$maxlen);
"
692,$_SERVER['HTTP_X_FORWARDED_FOR'],获取IP地址方式可伪造，HTTP_REFERER可伪造，常见引发SQL注入等漏洞,D:\phpstudy_pro\WWW\cms\xinhu\include\class\rockClass.php,第63行,"		}else if(isset($_SERVER['HTTP_X_FORWARDED_FOR'])){
"
693,$_SERVER['HTTP_X_FORWARDED_FOR'],获取IP地址方式可伪造，HTTP_REFERER可伪造，常见引发SQL注入等漏洞,D:\phpstudy_pro\WWW\cms\xinhu\include\class\rockClass.php,第64行,"			$ip = $_SERVER['HTTP_X_FORWARDED_FOR'];
"
694,foreach,"函数中存在变量,可能存在变量覆盖漏洞",D:\phpstudy_pro\WWW\cms\xinhu\include\class\rockClass.php,第176行,"			foreach($_POST as $k=>$v)$pstr.=''.chr(10).'['.$k.']:'.$v.'';
"
695,foreach,"函数中存在变量,可能存在变量覆盖漏洞",D:\phpstudy_pro\WWW\cms\xinhu\include\class\rockClass.php,第285行,"		foreach($_COOKIE as $key=>$value){
"
696,foreach,"函数中存在变量,可能存在变量覆盖漏洞",D:\phpstudy_pro\WWW\cms\xinhu\include\class\rockClass.php,第463行,"		foreach($_GET as $key=>$val)$GLOBALS['get_'.$key]=$this->get($key,'',0);
"
697,foreach,"函数中存在变量,可能存在变量覆盖漏洞",D:\phpstudy_pro\WWW\cms\xinhu\include\class\rockClass.php,第464行,"		foreach($_POST as $key=>$val)$GLOBALS['post_'.$key]=$this->post($key,'',0);
"
698,fopen,读取文件函数中存在变量，可能存在任意文件读取漏洞,D:\phpstudy_pro\WWW\cms\xinhu\include\class\rockClass.php,第511行,"		@$file	= fopen($path,'w');
"
699,fwrite,读取文件函数中存在变量，可能存在任意文件读取漏洞,D:\phpstudy_pro\WWW\cms\xinhu\include\class\rockClass.php,第515行,"			if($txt)$bo = fwrite($file,$txt);
"
700,escapeshellcmd,命令执行函数中存在变量，可能存在任意命令执行漏洞,D:\phpstudy_pro\WWW\cms\xinhu\include\PHPMailer\class.phpmailer.php,第600行,"      $sendmail = sprintf(""%s -oi -f %s -t"", escapeshellcmd($this->Sendmail), escapeshellarg($this->Sender));
"
701,escapeshellcmd,命令执行函数中存在变量，可能存在任意命令执行漏洞,D:\phpstudy_pro\WWW\cms\xinhu\include\PHPMailer\class.phpmailer.php,第602行,"      $sendmail = sprintf(""%s -oi -t"", escapeshellcmd($this->Sendmail));
"
702,file_put_contents,文件操作函数中存在变量，可能存在任意文件读取/删除/修改/写入等漏洞,D:\phpstudy_pro\WWW\cms\xinhu\include\PHPMailer\class.phpmailer.php,第1237行,"        file_put_contents($file, $body); //TODO check this worked
"
703,unlink,文件操作函数中存在变量，可能存在任意文件读取/删除/修改/写入等漏洞,D:\phpstudy_pro\WWW\cms\xinhu\include\PHPMailer\class.phpmailer.php,第1240行,"          @unlink($file);
"
704,unlink,文件操作函数中存在变量，可能存在任意文件读取/删除/修改/写入等漏洞,D:\phpstudy_pro\WWW\cms\xinhu\include\PHPMailer\class.phpmailer.php,第1241行,"          @unlink($signed);
"
705,file_get_contents,文件操作函数中存在变量，可能存在任意文件读取/删除/修改/写入等漏洞,D:\phpstudy_pro\WWW\cms\xinhu\include\PHPMailer\class.phpmailer.php,第1242行,"          $body = file_get_contents($signed);
"
706,unlink,文件操作函数中存在变量，可能存在任意文件读取/删除/修改/写入等漏洞,D:\phpstudy_pro\WWW\cms\xinhu\include\PHPMailer\class.phpmailer.php,第1240行,"          @unlink($file);
"
707,unlink,文件操作函数中存在变量，可能存在任意文件读取/删除/修改/写入等漏洞,D:\phpstudy_pro\WWW\cms\xinhu\include\PHPMailer\class.phpmailer.php,第1241行,"          @unlink($signed);
"
708,file_get_contents,文件操作函数中存在变量，可能存在任意文件读取/删除/修改/写入等漏洞,D:\phpstudy_pro\WWW\cms\xinhu\include\PHPMailer\class.phpmailer.php,第1473行,"      $file_buffer  = file_get_contents($path);
"
709,eval,命令执行函数中存在变量，可能存在任意命令执行漏洞,D:\phpstudy_pro\WWW\cms\xinhu\include\PHPMailer\class.phpmailer.php,第1734行,"        //TODO using /e (equivalent to eval()) is probably not a good idea
"
710,file_get_contents,文件操作函数中存在变量，可能存在任意文件读取/删除/修改/写入等漏洞,D:\phpstudy_pro\WWW\cms\xinhu\include\PHPMailer\class.phpmailer.php,第2215行,"    $privKeyStr = file_get_contents($this->DKIM_private);
"
711,fgets,读取文件函数中存在变量，可能存在任意文件读取漏洞,D:\phpstudy_pro\WWW\cms\xinhu\include\PHPMailer\class.pop3.php,第333行,"    $pop3_response = fgets($this->pop_conn, $size);
"
712,fwrite,读取文件函数中存在变量，可能存在任意文件读取漏洞,D:\phpstudy_pro\WWW\cms\xinhu\include\PHPMailer\class.pop3.php,第345行,"    $bytes_sent = fwrite($this->pop_conn, $string, strlen($string));
"
713,fgets,读取文件函数中存在变量，可能存在任意文件读取漏洞,D:\phpstudy_pro\WWW\cms\xinhu\include\PHPMailer\class.smtp.php,第797行,"    while($str = @fgets($this->smtp_conn,515)) {
"
714,file_put_contents,文件操作函数中存在变量，可能存在任意文件读取/删除/修改/写入等漏洞,D:\phpstudy_pro\WWW\cms\xinhu\include\phpqrcode\phpqrcode.php,第239行,"                        file_put_contents(QR_LOG_DIR.basename($outfile).'-errors.txt', date('Y-m-d H:i:s').': '.$err, FILE_APPEND);
"
715,file_put_contents,文件操作函数中存在变量，可能存在任意文件读取/删除/修改/写入等漏洞,D:\phpstudy_pro\WWW\cms\xinhu\include\phpqrcode\phpqrcode.php,第241行,"                        file_put_contents(QR_LOG_DIR.'errors.txt', date('Y-m-d H:i:s').': '.$err, FILE_APPEND);
"
716,file_get_contents,文件操作函数中存在变量，可能存在任意文件读取/删除/修改/写入等漏洞,D:\phpstudy_pro\WWW\cms\xinhu\include\phpqrcode\phpqrcode.php,第877行,"                        self::$frames[$version] = self::unserial(file_get_contents($fileName));
"
717,file_put_contents,文件操作函数中存在变量，可能存在任意文件读取/删除/修改/写入等漏洞,D:\phpstudy_pro\WWW\cms\xinhu\include\phpqrcode\phpqrcode.php,第880行,"                        file_put_contents($fileName, self::serial(self::$frames[$version]));
"
718,file_get_contents,文件操作函数中存在变量，可能存在任意文件读取/删除/修改/写入等漏洞,D:\phpstudy_pro\WWW\cms\xinhu\include\phpqrcode\phpqrcode.php,第2622行,"                    $bitMask = self::unserial(file_get_contents($fileName));
"
719,file_put_contents,文件操作函数中存在变量，可能存在任意文件读取/删除/修改/写入等漏洞,D:\phpstudy_pro\WWW\cms\xinhu\include\phpqrcode\phpqrcode.php,第2627行,"                    file_put_contents($fileName, self::serial($bitMask));
"
720,file_put_contents,文件操作函数中存在变量，可能存在任意文件读取/删除/修改/写入等漏洞,D:\phpstudy_pro\WWW\cms\xinhu\include\phpqrcode\phpqrcode.php,第3281行,"                file_put_contents($outfile, join(""\n"", QRtools::binarize($code->data)));
"
721,ob_start,"函数中存在变量,可能存在变量覆盖漏洞",D:\phpstudy_pro\WWW\cms\xinhu\include\phpqrcode\phpqrcode.php,第3292行,"                ob_start();
"
722,extract,函数中存在变量，可能存在变量覆盖漏洞,D:\phpstudy_pro\WWW\cms\xinhu\include\weixin\WXBizMsgCrypt.php,第146行,"		$array = $xmlparse->extract($sPostData);
"
723,extract,函数中存在变量，可能存在变量覆盖漏洞,D:\phpstudy_pro\WWW\cms\xinhu\include\weixin\xmlparse.php,第17行,"	public function extract($xmltext)
"
724,extract,函数中存在变量，可能存在变量覆盖漏洞,D:\phpstudy_pro\WWW\cms\xinhu\include\weixin\xmlparse.php,第56行,"$array = $xmlparse->extract($sPostData);
"
725,include_once,"文件包含函数中存在变量,可能存在文件包含漏洞",D:\phpstudy_pro\WWW\cms\xinhu\include\rockFun.php,第32行,"			include_once($_pats);
"
726,include_once,"文件包含函数中存在变量,可能存在文件包含漏洞",D:\phpstudy_pro\WWW\cms\xinhu\include\rockFun.php,第40行,"		include_once($path);
"
727,include_once,"文件包含函数中存在变量,可能存在文件包含漏洞",D:\phpstudy_pro\WWW\cms\xinhu\include\rockFun.php,第40行,"		include_once($path);
"
728,include_once,"文件包含函数中存在变量,可能存在文件包含漏洞",D:\phpstudy_pro\WWW\cms\xinhu\include\rockFun.php,第40行,"		include_once($path);
"
729,include_once,"文件包含函数中存在变量,可能存在文件包含漏洞",D:\phpstudy_pro\WWW\cms\xinhu\include\View.php,第23行,"include_once($rock->strformat('?0/?1/?1Action.php',ROOT_PATH, $p));
"
730,include_once,"文件包含函数中存在变量,可能存在文件包含漏洞",D:\phpstudy_pro\WWW\cms\xinhu\include\View.php,第33行,"if(file_exists($actfile1))include_once($actfile1);
"
731,include_once,"文件包含函数中存在变量,可能存在文件包含漏洞",D:\phpstudy_pro\WWW\cms\xinhu\include\View.php,第35行,"	include_once($actfile);
"
732,include_once,"文件包含函数中存在变量,可能存在文件包含漏洞",D:\phpstudy_pro\WWW\cms\xinhu\include\View.php,第88行,"	include_once($mpathname);
"
733,rmdirs,文件操作函数中存在变量，可能存在任意文件读取/删除/修改/写入等漏洞,D:\phpstudy_pro\WWW\cms\xinhu\manage\actions\account\fujian.php,第186行,"	cfc('files')->rmdirs($temp);
"
734,unserialize,序列化函数，可能存在反序列化漏洞,D:\phpstudy_pro\WWW\cms\xinhu\manage\actions\account\huishou.php,第54行,"		$data=unserialize($data);
"
735,file_get_contents,文件操作函数中存在变量，可能存在任意文件读取/删除/修改/写入等漏洞,D:\phpstudy_pro\WWW\cms\xinhu\manage\actions\account\user.php,第116行,"		$result=file_get_contents($api);
"
736,file_get_contents,文件操作函数中存在变量，可能存在任意文件读取/删除/修改/写入等漏洞,D:\phpstudy_pro\WWW\cms\xinhu\manage\actions\account\user.php,第202行,"		$res=file_get_contents($url);
"
737,file_get_contents,文件操作函数中存在变量，可能存在任意文件读取/删除/修改/写入等漏洞,D:\phpstudy_pro\WWW\cms\xinhu\manage\actions\account\user.php,第202行,"		$res=file_get_contents($url);
"
738,file_get_contents,文件操作函数中存在变量，可能存在任意文件读取/删除/修改/写入等漏洞,D:\phpstudy_pro\WWW\cms\xinhu\manage\actions\app_develop\plugin\edit_code.php,第42行,"		$item['code']=file_get_contents($file);
"
739,unlink,文件操作函数中存在变量，可能存在任意文件读取/删除/修改/写入等漏洞,D:\phpstudy_pro\WWW\cms\xinhu\manage\actions\app_develop\plugin\edit_code.php,第137行,"		@unlink($data);
"
740,require,"文件包含函数中存在变量,可能存在文件包含漏洞",D:\phpstudy_pro\WWW\cms\xinhu\manage\actions\app_develop\plugin\menu.php,第148行,"		$framess=require($file);
"
741,rmdirs,文件操作函数中存在变量，可能存在任意文件读取/删除/修改/写入等漏洞,D:\phpstudy_pro\WWW\cms\xinhu\manage\actions\app_develop\appchange.php,第97行,"	cfc('files')->rmdirs($temp);
"
742,unlink,文件操作函数中存在变量，可能存在任意文件读取/删除/修改/写入等漏洞,D:\phpstudy_pro\WWW\cms\xinhu\manage\actions\app_develop\old_plugin.php,第87行,"	@unlink($zip);
"
743,file_get_contents,文件操作函数中存在变量，可能存在任意文件读取/删除/修改/写入等漏洞,D:\phpstudy_pro\WWW\cms\xinhu\manage\actions\app_develop\plugin.php,第111行,"			$page_data=file_get_contents($page_html_file);
"
744,file_get_contents,文件操作函数中存在变量，可能存在任意文件读取/删除/修改/写入等漏洞,D:\phpstudy_pro\WWW\cms\xinhu\manage\actions\app_develop\plugin.php,第117行,"			$pagejs_data=file_get_contents($page_dir.'/index.js');
"
745,file_get_contents,文件操作函数中存在变量，可能存在任意文件读取/删除/修改/写入等漏洞,D:\phpstudy_pro\WWW\cms\xinhu\manage\actions\app_develop\plugin.php,第125行,"	$app_json=file_get_contents($temp_dir.'/app.json');
"
746,file_get_contents,文件操作函数中存在变量，可能存在任意文件读取/删除/修改/写入等漏洞,D:\phpstudy_pro\WWW\cms\xinhu\manage\actions\app_develop\plugin.php,第132行,"	$css_json=file_get_contents($temp_dir.'/app.wxss');
"
747,file_get_contents,文件操作函数中存在变量，可能存在任意文件读取/删除/修改/写入等漏洞,D:\phpstudy_pro\WWW\cms\xinhu\manage\actions\app_develop\plugin.php,第146行,"	$app_js=file_get_contents($temp_dir.'/app.js');
"
748,rmdirs,文件操作函数中存在变量，可能存在任意文件读取/删除/修改/写入等漏洞,D:\phpstudy_pro\WWW\cms\xinhu\manage\actions\app_develop\plugin.php,第153行,"	cfc('files')->rmdirs($temp_dir);
"
749,unlink,文件操作函数中存在变量，可能存在任意文件读取/删除/修改/写入等漏洞,D:\phpstudy_pro\WWW\cms\xinhu\manage\actions\app_develop\plugin.php,第157行,"	@unlink($zip);
"
750,unlink,文件操作函数中存在变量，可能存在任意文件读取/删除/修改/写入等漏洞,D:\phpstudy_pro\WWW\cms\xinhu\manage\actions\app_develop\plugin.php,第157行,"	@unlink($zip);
"
751,unserialize,序列化函数，可能存在反序列化漏洞,D:\phpstudy_pro\WWW\cms\xinhu\manage\actions\article\article.php,第276行,"	$uc=unserialize(cfc('tools')->base64_decode($uc));
"
752,unlink,文件操作函数中存在变量，可能存在任意文件读取/删除/修改/写入等漏洞,D:\phpstudy_pro\WWW\cms\xinhu\manage\actions\cloud\addons_temp_pc.php,第122行,"				@unlink($mdir.'/'.$bak[$time]);
"
753,unlink,文件操作函数中存在变量，可能存在任意文件读取/删除/修改/写入等漏洞,D:\phpstudy_pro\WWW\cms\xinhu\manage\actions\cloud\addons_temp_pc.php,第261行,"		@unlink($update_data_file);
"
754,unlink,文件操作函数中存在变量，可能存在任意文件读取/删除/修改/写入等漏洞,D:\phpstudy_pro\WWW\cms\xinhu\manage\actions\cloud\addons_temp_pc.php,第305行,"			@unlink($install_data_file);
"
755,unserialize,序列化函数，可能存在反序列化漏洞,D:\phpstudy_pro\WWW\cms\xinhu\manage\actions\cloud\addons_temp_pc.php,第352行,"		$module=unserialize($module);
"
756,unlink,文件操作函数中存在变量，可能存在任意文件读取/删除/修改/写入等漏洞,D:\phpstudy_pro\WWW\cms\xinhu\manage\actions\cloud\addons_temp_pc.php,第361行,"		@unlink($install_data_file);
"
757,file_get_contents,文件操作函数中存在变量，可能存在任意文件读取/删除/修改/写入等漏洞,D:\phpstudy_pro\WWW\cms\xinhu\manage\actions\cloud\addons_temp_pc.php,第394行,"			$config_json=file_get_contents($config_file);
"
758,file_get_contents,文件操作函数中存在变量，可能存在任意文件读取/删除/修改/写入等漏洞,D:\phpstudy_pro\WWW\cms\xinhu\manage\actions\cloud\addons_temp_pc.php,第456行,"	$config_json=file_get_contents($config_file);
"
759,file_get_contents,文件操作函数中存在变量，可能存在任意文件读取/删除/修改/写入等漏洞,D:\phpstudy_pro\WWW\cms\xinhu\manage\actions\cloud\addons_temp_pc.php,第470行,"				$config_data['install']=file_get_contents($install_file);
"
760,file_get_contents,文件操作函数中存在变量，可能存在任意文件读取/删除/修改/写入等漏洞,D:\phpstudy_pro\WWW\cms\xinhu\manage\actions\cloud\addons_temp_pc.php,第526行,"							$version['update']=file_get_contents($sql_file);
"
761,file_get_contents,文件操作函数中存在变量，可能存在任意文件读取/删除/修改/写入等漏洞,D:\phpstudy_pro\WWW\cms\xinhu\manage\actions\cloud\addons_temp_pc.php,第566行,"				$config_data['uninstall']=file_get_contents($uninstall_file);
"
762,file_get_contents,文件操作函数中存在变量，可能存在任意文件读取/删除/修改/写入等漏洞,D:\phpstudy_pro\WWW\cms\xinhu\manage\actions\cloud\h5game.php,第225行,"		$image=file_get_contents($dat['image']);
"
763,unserialize,序列化函数，可能存在反序列化漏洞,D:\phpstudy_pro\WWW\cms\xinhu\manage\actions\cloud\h5game.php,第289行,"		$module=unserialize($module);
"
764,file_get_contents,文件操作函数中存在变量，可能存在任意文件读取/删除/修改/写入等漏洞,D:\phpstudy_pro\WWW\cms\xinhu\manage\actions\cloud\h5game.php,第308行,"		$image=file_get_contents($module['image']);
"
765,unlink,文件操作函数中存在变量，可能存在任意文件读取/删除/修改/写入等漏洞,D:\phpstudy_pro\WWW\cms\xinhu\manage\actions\cloud\manage_template.php,第122行,"				@unlink($mdir.'/'.$bak[$time]);
"
766,unlink,文件操作函数中存在变量，可能存在任意文件读取/删除/修改/写入等漏洞,D:\phpstudy_pro\WWW\cms\xinhu\manage\actions\cloud\manage_template.php,第263行,"		@unlink($update_data_file);
"
767,unlink,文件操作函数中存在变量，可能存在任意文件读取/删除/修改/写入等漏洞,D:\phpstudy_pro\WWW\cms\xinhu\manage\actions\cloud\manage_template.php,第307行,"			@unlink($install_data_file);
"
768,unserialize,序列化函数，可能存在反序列化漏洞,D:\phpstudy_pro\WWW\cms\xinhu\manage\actions\cloud\manage_template.php,第354行,"		$module=unserialize($module);
"
769,unlink,文件操作函数中存在变量，可能存在任意文件读取/删除/修改/写入等漏洞,D:\phpstudy_pro\WWW\cms\xinhu\manage\actions\cloud\manage_template.php,第363行,"		@unlink($install_data_file);
"
770,file_get_contents,文件操作函数中存在变量，可能存在任意文件读取/删除/修改/写入等漏洞,D:\phpstudy_pro\WWW\cms\xinhu\manage\actions\cloud\manage_template.php,第395行,"			$config_json=file_get_contents($config_file);
"
771,file_get_contents,文件操作函数中存在变量，可能存在任意文件读取/删除/修改/写入等漏洞,D:\phpstudy_pro\WWW\cms\xinhu\manage\actions\cloud\manage_template.php,第457行,"	$config_json=file_get_contents($config_file);
"
772,file_get_contents,文件操作函数中存在变量，可能存在任意文件读取/删除/修改/写入等漏洞,D:\phpstudy_pro\WWW\cms\xinhu\manage\actions\cloud\manage_template.php,第471行,"				$config_data['install']=file_get_contents($install_file);
"
773,file_get_contents,文件操作函数中存在变量，可能存在任意文件读取/删除/修改/写入等漏洞,D:\phpstudy_pro\WWW\cms\xinhu\manage\actions\cloud\manage_template.php,第527行,"							$version['update']=file_get_contents($sql_file);
"
774,file_get_contents,文件操作函数中存在变量，可能存在任意文件读取/删除/修改/写入等漏洞,D:\phpstudy_pro\WWW\cms\xinhu\manage\actions\cloud\manage_template.php,第567行,"				$config_data['uninstall']=file_get_contents($uninstall_file);
"
775,file_get_contents,文件操作函数中存在变量，可能存在任意文件读取/删除/修改/写入等漏洞,D:\phpstudy_pro\WWW\cms\xinhu\manage\actions\cloud\mobile_template.php,第222行,"			$temp=file_get_contents($url);
"
776,file_get_contents,文件操作函数中存在变量，可能存在任意文件读取/删除/修改/写入等漏洞,D:\phpstudy_pro\WWW\cms\xinhu\manage\actions\cloud\mobile_template.php,第229行,"	$image=file_get_contents($result['image']);
"
777,unlink,文件操作函数中存在变量，可能存在任意文件读取/删除/修改/写入等漏洞,D:\phpstudy_pro\WWW\cms\xinhu\manage\actions\cloud\module.php,第195行,"				@unlink($mdir.'/'.$bak[$time]);
"
778,unserialize,序列化函数，可能存在反序列化漏洞,D:\phpstudy_pro\WWW\cms\xinhu\manage\actions\cloud\module.php,第508行,"			$dat=unserialize($dat);
"
779,file_get_contents,文件操作函数中存在变量，可能存在任意文件读取/删除/修改/写入等漏洞,D:\phpstudy_pro\WWW\cms\xinhu\manage\actions\cloud\module.php,第536行,"		$image=file_get_contents($data['image']);
"
780,unserialize,序列化函数，可能存在反序列化漏洞,D:\phpstudy_pro\WWW\cms\xinhu\manage\actions\cloud\module.php,第745行,"		$module=unserialize($module);
"
781,file_get_contents,文件操作函数中存在变量，可能存在任意文件读取/删除/修改/写入等漏洞,D:\phpstudy_pro\WWW\cms\xinhu\manage\actions\cloud\module.php,第780行,"		$image=file_get_contents($module['image']);
"
782,file_get_contents,文件操作函数中存在变量，可能存在任意文件读取/删除/修改/写入等漏洞,D:\phpstudy_pro\WWW\cms\xinhu\manage\actions\cloud\module.php,第786行,"			$image=file_get_contents($hv);
"
783,file_get_contents,文件操作函数中存在变量，可能存在任意文件读取/删除/修改/写入等漏洞,D:\phpstudy_pro\WWW\cms\xinhu\manage\actions\cloud\module.php,第794行,"			$image=file_get_contents($whv['picurl']);
"
784,unlink,文件操作函数中存在变量，可能存在任意文件读取/删除/修改/写入等漏洞,D:\phpstudy_pro\WWW\cms\xinhu\manage\actions\cloud\module.php,第984行,"	@unlink($zip);
"
785,file_get_contents,文件操作函数中存在变量，可能存在任意文件读取/删除/修改/写入等漏洞,D:\phpstudy_pro\WWW\cms\xinhu\manage\actions\cloud\pc_blocks.php,第122行,"		$image=file_get_contents($data['image']);
"
786,file_get_contents,文件操作函数中存在变量，可能存在任意文件读取/删除/修改/写入等漏洞,D:\phpstudy_pro\WWW\cms\xinhu\manage\actions\cloud\pc_blocks.php,第122行,"		$image=file_get_contents($data['image']);
"
787,file_get_contents,文件操作函数中存在变量，可能存在任意文件读取/删除/修改/写入等漏洞,D:\phpstudy_pro\WWW\cms\xinhu\manage\actions\cloud\pc_blocks.php,第190行,"		$image=file_get_contents($item['image']);
"
788,file_get_contents,文件操作函数中存在变量，可能存在任意文件读取/删除/修改/写入等漏洞,D:\phpstudy_pro\WWW\cms\xinhu\manage\actions\cloud\pc_template.php,第121行,"			$temp=file_get_contents($url);
"
789,file_get_contents,文件操作函数中存在变量，可能存在任意文件读取/删除/修改/写入等漏洞,D:\phpstudy_pro\WWW\cms\xinhu\manage\actions\cloud\pc_template.php,第121行,"			$temp=file_get_contents($url);
"
790,file_get_contents,文件操作函数中存在变量，可能存在任意文件读取/删除/修改/写入等漏洞,D:\phpstudy_pro\WWW\cms\xinhu\manage\actions\cloud\pc_template.php,第190行,"		$image=file_get_contents($result['image']);
"
791,unserialize,序列化函数，可能存在反序列化漏洞,D:\phpstudy_pro\WWW\cms\xinhu\manage\actions\cloud\profile.php,第31行,"			$result=@unserialize(base64_decode($bak));
"
792,unlink,文件操作函数中存在变量，可能存在任意文件读取/删除/修改/写入等漏洞,D:\phpstudy_pro\WWW\cms\xinhu\manage\actions\cloud\update.php,第96行,"		@unlink($mdir.'/'.$bak);
"
793,unserialize,序列化函数，可能存在反序列化漏洞,D:\phpstudy_pro\WWW\cms\xinhu\manage\actions\cloud\update.php,第272行,"	$dat=@unserialize(base64_decode($dat));
"
794,unserialize,序列化函数，可能存在反序列化漏洞,D:\phpstudy_pro\WWW\cms\xinhu\manage\actions\cloud\update.php,第391行,"			$postdata=unserialize($postdata);
"
795,require,"文件包含函数中存在变量,可能存在文件包含漏洞",D:\phpstudy_pro\WWW\cms\xinhu\manage\actions\cloud\update.php,第405行,"			require($update_file);
"
796,file_get_contents,文件操作函数中存在变量，可能存在任意文件读取/删除/修改/写入等漏洞,D:\phpstudy_pro\WWW\cms\xinhu\manage\actions\cloud\wxapp.php,第267行,"	//$image=file_get_contents($post['image']);
"
797,file_get_contents,文件操作函数中存在变量，可能存在任意文件读取/删除/修改/写入等漏洞,D:\phpstudy_pro\WWW\cms\xinhu\manage\actions\member\member.php,第481行,"			$txtdata = file_get_contents($url);
"
798,unlink,文件操作函数中存在变量，可能存在任意文件读取/删除/修改/写入等漏洞,D:\phpstudy_pro\WWW\cms\xinhu\manage\actions\system\db.php,第79行,"	@unlink($zip);
"
799,file_get_contents,文件操作函数中存在变量，可能存在任意文件读取/删除/修改/写入等漏洞,D:\phpstudy_pro\WWW\cms\xinhu\manage\actions\system\db.php,第99行,"		$sql=file_get_contents($back_file);
"
800,rmdirs,文件操作函数中存在变量，可能存在任意文件读取/删除/修改/写入等漏洞,D:\phpstudy_pro\WWW\cms\xinhu\manage\actions\system\db.php,第116行,"	cfc('files')->rmdirs($back_dir.$name);
"
801,file_get_contents,文件操作函数中存在变量，可能存在任意文件读取/删除/修改/写入等漏洞,D:\phpstudy_pro\WWW\cms\xinhu\manage\actions\user\login.php,第212行,"		$result=file_get_contents($api);
"
802,file_get_contents,文件操作函数中存在变量，可能存在任意文件读取/删除/修改/写入等漏洞,D:\phpstudy_pro\WWW\cms\xinhu\manage\actions\user\login.php,第277行,"		$res=file_get_contents($url);
"
803,file_get_contents,文件操作函数中存在变量，可能存在任意文件读取/删除/修改/写入等漏洞,D:\phpstudy_pro\WWW\cms\xinhu\manage\actions\user\login.php,第277行,"		$res=file_get_contents($url);
"
804,file_get_contents,文件操作函数中存在变量，可能存在任意文件读取/删除/修改/写入等漏洞,D:\phpstudy_pro\WWW\cms\xinhu\manage\actions\user\login.php,第277行,"		$res=file_get_contents($url);
"
805,unserialize,序列化函数，可能存在反序列化漏洞,D:\phpstudy_pro\WWW\cms\xinhu\manage\actions\wechat\menu.php,第54行,"	$return['province']=unserialize($return['province']);
"
806,file_get_contents,文件操作函数中存在变量，可能存在任意文件读取/删除/修改/写入等漏洞,D:\phpstudy_pro\WWW\cms\xinhu\manage\index.php,第528行,"$html=file_get_contents($mainsource);
"
807,parse_str,"函数中存在变量,可能存在变量覆盖漏洞",D:\phpstudy_pro\WWW\cms\xinhu\manage\store.php,第147行,"				parse_str($query, $urls);
"
808,parse_str,"函数中存在变量,可能存在变量覆盖漏洞",D:\phpstudy_pro\WWW\cms\xinhu\manage\store.php,第151行,"					parse_str($query, $get);
"
809,include_once,"文件包含函数中存在变量,可能存在文件包含漏洞",D:\phpstudy_pro\WWW\cms\xinhu\webmain\flow\flowopt\flowoptAction.php,第178行,"		include_once($pa1);
"
810,`$,``反引号中包含变量，变量可控会导致命令执行漏洞,D:\phpstudy_pro\WWW\cms\xinhu\webmain\flow\input\inputAction.php,第126行,"				if($this->flow->rows(""`$fid`='{$uaarr[$fid]}' and `id`<>$id"")>0)$uaarr[$fid]=$this->flow->createbianhao($rs['data'], $fid);
"
811,`$,``反引号中包含变量，变量可控会导致命令执行漏洞,D:\phpstudy_pro\WWW\cms\xinhu\webmain\flow\input\inputAction.php,第219行,"					if($db->rows(""`id`<>'$id' and `$fiesd`='$dval'"")>0)$this->backmsg(''.$rs['name'].'['.$dval.']已存在了');
"
812,file_get_contents,文件操作函数中存在变量，可能存在任意文件读取/删除/修改/写入等漏洞,D:\phpstudy_pro\WWW\cms\xinhu\webmain\flow\input\inputAction.php,第508行,"		if(file_exists($path))$pclucont 	= file_get_contents($path);
"
813,include_once,"文件包含函数中存在变量,可能存在文件包含漏洞",D:\phpstudy_pro\WWW\cms\xinhu\webmain\flow\input\inputAction.php,第547行,"			include_once($pathss);
"
814,`$,``反引号中包含变量，变量可控会导致命令执行漏洞,D:\phpstudy_pro\WWW\cms\xinhu\webmain\flow\input\inputAction.php,第859行,"					$tos = $flow->rows(""`$onid`='$val'"");
"
815,include_once,"文件包含函数中存在变量,可能存在文件包含漏洞",D:\phpstudy_pro\WWW\cms\xinhu\webmain\home\index\rock_index.php,第16行,"	if(file_exists($paths))include_once($paths);
"
816,include_once,"文件包含函数中存在变量,可能存在文件包含漏洞",D:\phpstudy_pro\WWW\cms\xinhu\webmain\home\index\rock_index.php,第30行,"			if(file_exists($paths))include_once($paths);
"
817,include_once,"文件包含函数中存在变量,可能存在文件包含漏洞",D:\phpstudy_pro\WWW\cms\xinhu\webmain\home\index\rock_index.php,第40行,"				if(file_exists($paths))include_once($paths);
"
818,include_once,"文件包含函数中存在变量,可能存在文件包含漏洞",D:\phpstudy_pro\WWW\cms\xinhu\webmain\home\index\rock_index.php,第51行,"if(file_exists($paths))include_once($paths);
"
819,file_get_contents,文件操作函数中存在变量，可能存在任意文件读取/删除/修改/写入等漏洞,D:\phpstudy_pro\WWW\cms\xinhu\webmain\main\flow\flowAction.php,第437行,"			$content = file_get_contents($path);
"
820,file_get_contents,文件操作函数中存在变量，可能存在任意文件读取/删除/修改/写入等漏洞,D:\phpstudy_pro\WWW\cms\xinhu\webmain\main\flow\flowAction.php,第437行,"			$content = file_get_contents($path);
"
821,unlink,文件操作函数中存在变量，可能存在任意文件读取/删除/修改/写入等漏洞,D:\phpstudy_pro\WWW\cms\xinhu\webmain\main\flow\flowAction.php,第550行,"			@unlink($path);
"
822,file_get_contents,文件操作函数中存在变量，可能存在任意文件读取/删除/修改/写入等漏洞,D:\phpstudy_pro\WWW\cms\xinhu\webmain\main\flow\flowAction.php,第567行,"			$cont = file_get_contents($path);
"
823,`$,``反引号中包含变量，变量可控会导致命令执行漏洞,D:\phpstudy_pro\WWW\cms\xinhu\webmain\main\flow\flowAction.php,第792行,"			$str = ""ALTER TABLE `[Q]"".$tables.""` ADD `$fields` "";
"
824,`$,``反引号中包含变量，变量可控会导致命令执行漏洞,D:\phpstudy_pro\WWW\cms\xinhu\webmain\main\flow\flowAction.php,第824行,"				$ustr= ""ALTER TABLE `[Q]"".$tables.""` MODIFY column `$fields` "".$ustr."" COMMENT '$name'"";
"
825,file_get_contents,文件操作函数中存在变量，可能存在任意文件读取/删除/修改/写入等漏洞,D:\phpstudy_pro\WWW\cms\xinhu\webmain\main\flow\flowAction.php,第1189行,"					$fstr = file_get_contents($from);
"
826,copy,文件操作函数中存在变量，可能存在任意文件读取/删除/修改/写入等漏洞,D:\phpstudy_pro\WWW\cms\xinhu\webmain\main\flow\flowAction.php,第1194行,"					@copy($from, $to);
"
827,file_get_contents,文件操作函数中存在变量，可能存在任意文件读取/删除/修改/写入等漏洞,D:\phpstudy_pro\WWW\cms\xinhu\webmain\model\flow\flow.php,第8行," class flowModel extends Model { public $modenum; public $editcont= ''; public $id = 0; public $moders; public $modeid; public $modename; public $sericnum; public $billrs = array(); public $rs = array(); public $urs = array(); public $drs = array(); public $fieldsarr = array(); public $fieldsarra = array(); public $mwhere; public $mtable; public $uname; public $uid = 0; public $optid = 0; public $isflow = 0; public $ismobile= 0; public $minwidth= 100; public $inputwidth= 0; public $atype = ''; public $daochubo= false; public $companyid= 1; protected function flowinit(){} protected function flowchangedata(){} protected function flowchangetodo(){} protected function flowdeletebill($sm){} protected function flowzuofeibill($sm){} protected function flowsubmit($na, $sm){} protected function flowaddlog($arr){} protected function flowdatalog($arr){} protected function flowcheckbefore(){} protected function flowcheckafter($zt, $sm){} protected function flowcheckfinsh($zt){} protected function flowgetfields($lx){} protected function flowgetoptmenu($opt){} protected function flowcheckname($num){} protected function flowcoursejudge($num){} protected function flowoptmenu($ors, $crs){} protected function flowisreadqx(){return false;} protected function flowisdeleteqx(){return false;} protected function flowprintrows($r){return $r;} protected function flowsubdata($r, $lx=0){return $r;} protected function flownexttodo($type){return false;} protected function flowbillwhere($lx, $uid){return '';} protected $flowweixinarr = array(); protected $flowviewufieds = 'uid'; protected $flowcompanyidfieds = 'comid'; protected $flowfieldstype = 0; public function flowrsreplace($rs){return $rs;} public function flowrsreplace_we($row, $rs){return $row;} public function flowwesearchdata($lx){return array();} protected function flowrsreplaceedit($rs){return $rs;} protected $flowstatusarr = array(1); protected $subsubdatastyle = ''; protected $wherejoin = array(); public $defaultorder = ''; public $floweditother = false; public $xiangbordercolor = ''; public function echomsg($msg) { if(!isajax())exit($msg); showreturn('', $msg, 201); exit(); } public function flowfieldarr($farr, $lx){return $farr;} public function flowinputtpl($cont, $lx){return $cont;} public function flowviewtpl($cont, $lx){return $cont;} public function floweditoffice($frs, $ofrs){} public function initdata($num, $id=null) { if(is_array($num)){ $this->moders= $num; }else{ $this->moders = m('flow_set')->getone(is_numeric($num) ? $num : ""`num`='$num'""); if(!$this->moders)$this->echomsg('模块['.$num.']不存在，请到[流程模块列表]下添加'); } $this->daochubo = ($this->rock->post('execldown')=='true') ? true :false; $table = $this->moders['table']; $this->modeid = $this->moders['id']; $this->modenum = $this->moders['num']; $this->modename = $this->moders['name']; $this->isflow = (int)$this->moders['isflow']; $this->settable($table); $this->mtable = $table; $this->viewmodel = m('view'); $this->chaomodel = m('flow_chao'); $this->billmodel = m('flow_bill'); $this->todomodel = m('flow_todo'); $this->todosmodel = m('flowtodo'); $this->flogmodel = m('flow_log'); $this->checksmodel = m('flow_checks'); $this->cnamemodel = m('flowcname'); $this->wheremodel = m('where'); $this->adminmodel = m('admin'); $this->remindmodel = m('remind'); $this->option = m('option'); $this->companyid = $this->adminmodel->getcompanyid(); $this->tfieldsarra(); $this->mwhere = ""`table`='$this->mtable' and `mid`=-1""; $this->flowinit(); if($id==null)return $this; $this->loaddata($id, true); return $this; } private function tfieldsarra() { $rows = m('flow_element')->getrows(""`mid`='$this->modeid' and `iszb`=0"",'`name`,`fields`,`isbt`,`iszs`,`fieldstype`,`savewhere`,`data`,`isdr`,`iszb`,`issou`,`islu`,`islb`,`isonly`,`attr`','`sort`'); $this->fieldsarr = array(); if($rows)foreach($rows as $k=>$rs){ if($rs['islu']==1)$this->fieldsarr[] = $rs; } $this->fieldsarra = $rows; } public function inputtitle() { return $this->moders['name']; } public function flowsearchfields() { $arr = array(); if($this->isflow>0){ $arr[] = array('name'=>'申请人...','fields'=>'uid'); $arr[] = array('name'=>'提交人...','fields'=>'optid'); } return $arr; } public function loaddata($id, $ispd=true) { $this->id = (int)$id; $this->mwhere = ""`table`='$this->mtable' and `mid`='$id'""; $swhere = ""`id`='$id'""; $wherestr = $this->moders['where']; if(!isempt($wherestr)){ $wherestr = $this->rock->covexec($wherestr); $swhere .= ' and '.$wherestr; } $this->rs = $this->getone($swhere); $this->uname = ''; if(!$this->rs)$this->echomsg('数据记录不存在了'); $this->rs['base_name'] = ''; $this->rs['base_deptname'] = ''; if(isset($this->rs['uid']))$this->uid = $this->rs['uid']; if(!isset($this->rs['applydt']))$this->rs['applydt'] = ''; if(!isset($this->rs['status']))$this->rs['status'] = 1; $uisfield = property_exists($this, 'uidfields') ? $this->uidfields : 'optid'; if($this->uid==0 && isset($this->rs[$uisfield]))$this->uid = $this->rs[$uisfield]; $this->optid = isset($this->rs['optid']) ? $this->rs['optid'] : $this->uid; $this->urs = $this->adminmodel->getone($this->uid,'id,name,user,deptid,deptids,deptname,deptallname,face,ranking,superid,superpath,superman,deptpath'); if($this->isempt($this->rs['applydt'])&&isset($this->rs['optdt']))$this->rs['applydt']=substr($this->rs['optdt'],0,10); if($this->urs){ $this->drs = $this->db->getone('[Q]dept',""`id`='"".$this->urs['deptid'].""'""); $this->uname = $this->urs['name']; $this->rs['base_name'] = $this->uname; if($this->drs){ $this->rs['base_deptname'] = $this->drs['name']; } } $this->sericnum = ''; $this->billrs = $this->billmodel->getone($this->mwhere); if($this->billrs){ $this->sericnum = $this->billrs['sericnum']; if(isempt(arrvalue($this->billrs,'uname'))){ $this->savebill(); } if($this->billrs['status']!=$this->rs['status'])$this->billmodel->update('`status`='.$this->rs['status'].'', $this->billrs['id']); if($this->billrs['isturn']!=$this->rs['isturn'])$this->billmodel->update('`isturn`='.$this->rs['isturn'].'', $this->billrs['id']); if(isempt($this->rs['base_name']))$this->rs['base_name'] = $this->billrs['uname']; if(isempt($this->rs['base_deptname']))$this->rs['base_deptname'] = $this->billrs['udeptname']; }else{ if($this->isflow>0)$this->savebill(); } if($this->isflow>0){ if($this->rs['status']==1 && $this->rs['isturn']=='0'){ $this->update(array('isturn' => 1), $this->id); $this->rs['isturn'] = 1; if($this->billrs)$this->billmodel->update('`isturn`=1', $this->billrs['id']); } } $this->getlogrows = array(); if($ispd)$this->isreadqx(); $this->rssust = $this->rs; $this->flowchangedata(); $this->rs['base_systitle'] = TITLE; $this->rs['base_modename'] = $this->modename; $this->rs['base_sericnum'] = $this->sericnum; $this->rs['base_summary'] = $this->getsummary(); } public function getdaiban() { $s = $this->rock->dbinstr('nowcheckid', $this->adminid); $to = $this->billmodel->rows('`modeid`='.$this->modeid.' and `isdel`=0 and `status` not in(1,2) and '.$s.''); return $to; } public function isreadqx($glx=0) { $bo = false; if($this->adminid==1)$bo=true; if($this->uid==$this->adminid && $this->adminid>0)$bo=true; if(!$bo && $this->isflow>0){ if($this->billrs){ $allcheckid = $this->billrs['allcheckid']; if(contain(','.$allcheckid.',',','.$this->adminid.','))$bo = true; } } if(!$bo){ if($this->urs && contain($this->urs['superpath'],'['.$this->adminid.']'))$bo = true; } if(!$bo){ $tos = $this->todosmodel->rows("""".$this->mwhere."" and `uid`='$this->adminid'""); if($tos>0)$bo=true; } if(!$bo){ $tos = $this->chaomodel->rows($this->mwhere.' and '.$this->rock->dbinstr('csnameid', $this->adminid).''); if($tos>0)$bo=true; } if(!$bo){ $tos = $this->db->rows('[Q]todo', ""`uid`='$this->adminid' and "".$this->mwhere.""""); if($tos>0)$bo=true; } if(!$bo)$bo = $this->flowisreadqx(); if(!$bo){ $bo = $this->isreadqxs(); } if(!$bo){ $tos = $this->isjiankongqx(); if($tos>0)$bo=true; } if($glx==1)return $bo; if(!$bo)$this->echomsg('无权限查看模块['.$this->modenum.'.'.$this->modename.']'.$this->uname.'的数据，请联系管理员到[流程模块→流程模块权限]下设置'); } public function isreadqxs() { $bo = false; $where = $this->viewmodel->viewwhere($this->moders, $this->adminid, $this->flowviewufieds); $where = str_replace('{asqom}','', $where); $tos = $this->rows(""`id`='$this->id' $where ""); if($tos>0)$bo=true; return $bo; } public function iseditqx() { $bo = 0; if($bo==0 && $this->isflow>0){ if($this->billrs && ($this->uid == $this->adminid || $this->optid==$this->adminid)){ if($this->billrs['nstatus']==0 || $this->billrs['nstatus']==2){ $bo = 1; } } if($this->rs['status']==1)$bo=0; } if($bo==0){ $where = $this->viewmodel->editwhere($this->moders, $this->adminid, $this->flowviewufieds); $where = str_replace('{asqom}','', $where); $tos = $this->rows(""`id`='$this->id'  $where ""); if($tos>0)$bo=1; } return $bo; } public function isdeleteqx() { $bo = 0; if($bo==0 && $this->isflow>0){ if($this->billrs && ($this->uid == $this->adminid || $this->optid==$this->adminid)){ if($this->billrs['nstatus']==0 || $this->billrs['nstatus']==2){ $bo = 1; } } if($this->rs['status']==1)$bo=0; } if($bo==0){ $where = $this->viewmodel->deletewhere($this->moders, $this->adminid, $this->flowviewufieds); $where = str_replace('{asqom}','', $where); $tos = $this->rows(""`id`='$this->id'  $where ""); if($tos>0)$bo=1; } $isd = $this->flowisdeleteqx(); if(is_numeric($isd) && $isd <= 1)$bo = $isd; return $bo; } public function isjiankongqx() { $bo = 0; if($bo==0){ $where = $this->viewmodel->jiankongwhere($this->moders, $this->adminid, $this->flowviewufieds); $where = str_replace('{asqom}','', $where); $tos = $this->rows(""`id`='$this->id'  $where ""); if($tos>0)$bo=1; } return $bo; } public function getfields($lx=0) { $fields = array(); $farr = $this->db->getrows('[Q]flow_element',""`mid`='$this->modeid' and `iszb`=0 and `iszs`=1"",'`fields`,`name`','sort,id'); foreach($farr as $k=>$rs)$fields[$rs['fields']] = $rs['name']; $fters = $this->flowgetfields($lx); if(is_array($fters))$fields = array_merge($fields, $fters); return $fields; } public function getinputurl($num='',$mid=0,$can=array()) { if($num=='')$num = $this->modenum; $xa = 'lu'; if($this->ismobile==1)$xa = 'lum'; $url = 'index.php?a='.$xa.'&m=input&d=flow&num='.$num.'&mid='.$mid.''; if(is_array($can)){ foreach($can as $k=>$v)$url.='&'.$k.'='.$v.''; }else{ $url .= '&'.$can.''; } return $url; } public function replacepbr(&$arr, $k) { $val = arrvalue($arr, $k); if(!c('html')->ishtml($val))$arr[$k] = str_replace(""\n"",'<br>', $val); return $arr; } public function getdatalog($lx=0, $isdy=0) { m('log')->addread($this->mtable, $this->id); $this->todosmodel->biaoyidu($this->adminid, $this->modenum, $this->id); $fobj = m('file'); $this->ismobile = $lx; $arr['modename'] = $this->modename; $arr['title'] = $this->modename; $arr['modeid'] = $this->modeid; $arr['modenum'] = $this->modenum; $arr['mid'] = $this->id; $arr['status'] = arrvalue($this->rs,'status'); $arr['logarr'] = $this->getlog(1); $arr['isplview'] = arrvalue($this->moders,'ispl','0'); $contview = ''; $lsds = ($isdy==2) ? $isdy: $lx; $path = ''.P.'/flow/page/view_'.$this->modenum.'_'.$lsds.'.html'; $fstr = $fobj->getstr($this->mtable, $this->id, 3); $issubtabs = 0; if($fstr != ''){ $this->rs['file_content'] = $fstr; } $data = $this->flowrsreplace($this->rs, ($isdy==2) ? 3 : 1); $dataa = $this->viewjinfields(array($data)); $data = $dataa[0]; $subdata = $this->getsuballdata(1); if($subdata){ $zbzd = m('flow_element')->getrows(""`mid`='$this->modeid' and `iszb`>0 and `iszs`=1 and `fieldstype` in('uploadimg','uploadfile','textarea')"",'`name`,`fields`,`fieldstype`,`iszb`','`iszb`,`sort`'); foreach($subdata as $zb=>$da){ $sub = $da['fields']; $data[$sub] = $this->getsubdata($zb,$da['data'],arrvalue($data,'subdatays'.$zb.'',$lx)); $data[''.$sub.'_style'] = 'padding:0'; } } foreach($this->fieldsarra as $k=>$rs){ $fid = $rs['fields']; $fty = $rs['fieldstype']; if($fty=='uploadfile'){ $fval = arrvalue($data, $fid); if(isempt($fval))$fval='0'; $data[$fid] = ''; if($fval!='0'){ $data[$fid] = $fobj->getstr('', '', 3, ""`id` in($fval)""); } } if($fty=='uploadimg'){ $fval = arrvalue($data, $fid); if(!isempt($fval) && substr($fval,0,4)!='<img'){ $fval = $this->rock->gethttppath($fval); $data[$fid] = '<img src=""'.$fval.'"" onclick=""c.showviews(this)"" height=""100"">'; } } if($fty=='textarea'){ $this->replacepbr($data, $fid); } if($fty=='ditumap' && !isempt($rs['data'])){ $wzhi = arrvalue($data, $rs['data']); if(!isempt($wzhi))$data[$fid].='<a href=""javascript:;"" onclick=""js.showmap(\''.$wzhi.','.$data[$fid].'\')"">[查看地图]</a>'; } } $_logarr = $qfields = array(); foreach($arr['logarr'] as $k1=>$rs1)$_logarr[$rs1['id']] = $rs1; $logrows = $this->flogmodel->getrows($this->mwhere.' and `modeid`='.$this->modeid.' and `courseid`>0 and `courseid`<88888 and `status`>0 and `valid`=1'); foreach($logrows as $k2=>$rs2){ $rs3 = $_logarr[$rs2['id']]; $_coid = $rs2['courseid']; if(!isempt($rs3['qmimg']))$rs3['name'] = '<img height=""30"" onclick=""c.showviews(this)"" width=""70"" src=""'.$rs3['qmimg'].'"">'; $key1 = 'course'.$_coid.''; if(!isset($data[''.$key1.'_name'])){ $data[''.$key1.'_name'] = $rs3['name']; $data[''.$key1.'_zt'] = '<font color=""'.$rs3['color'].'"">'.$rs3['statusname'].'</font>'; $data[''.$key1.'_sm'] = $rs3['sm']; $data[''.$key1.'_dt'] = $rs3['checkdt']; }else{ $data[''.$key1.'_name'] .= ','.$rs3['name']; $data[''.$key1.'_sm'] .= ','.$rs3['sm']; $data[''.$key1.'_dt'] = $rs3['checkdt']; } $key2 = ''.$key1.'_all'; if(!isset($data[$key2])){ $qfields[$key2] = $rs2['name']; $data[$key2]=''; } $str1 = $rs3['name'].' <font color=""'.$rs3['color'].'"">'.$rs3['statusname'].'</font> '.$rs3['checkdt'].''; if(!isempt($rs3['sm']))$str1.='，'.$rs3['sm'].''; if($data[$key2]!='')$data[$key2].='<hr size=""1"">'; $data[$key2].= $str1; } if(file_exists($path)){ $contview = $this->flowviewtpl(file_get_contents($path), $lx); $contview = $this->rock->reparr($contview, $data); } $arr['isdefaultview'] = 0; $ztass = $this->getnowstatus(); if($this->isempt($contview) || contain($contview, '$contview$')){ $arr['isdefaultview'] = 1; $_fields = array(); $data['base_status'] = $ztass[3]; if($this->isflow>0){ $_fields['base_sericnum'] = '单号'; $_fields['base_name'] = '申请人'; $_fields['base_deptname'] = '申请人部门'; $_fields['base_status'] = '流程状态'; } $fields = array_merge($_fields, $this->getfields($lx)); if($fstr!='')$fields['file_content'] = '相关文件'; foreach($subdata as $zb=>$da){ $fields[$da['fields']] = $da['name']; } if($qfields)$fields = array_merge($fields,$qfields); if(method_exists($this, 'flowxiangfields'))$this->flowxiangfields($fields); if($lx==0)foreach($fields as $k=>$rs){$data[''.$k.'_style'] = 'width:75%';break;} $_colsr = $this->xiangbordercolor; if($_colsr=='')$_colsr = getconfig('bcolorxiang'); $contvimr = c('html')->xiangtable($fields, $data, $_colsr); $contvimr = '<div align=""center"">'.$contvimr.'</div>'; if($lx==1){ $contvimr = ''; if($this->isflow>0){ $contvimr.='<div class=""r-border-b"">
"
828,`$,``反引号中包含变量，变量可控会导致命令执行漏洞,D:\phpstudy_pro\WWW\cms\xinhu\webmain\model\flow\flow.php,第15行,"					</div>'; unset($fields['base_name']); unset($fields['base_deptname']); } $contvimr .= '<div><table width=""100%"">'; foreach($fields as $f=>$n){ $vs = arrvalue($data, $f); if(!isempt($vs)){ if(substr($f,0,7)=='subdata'){ $contvimr .= '<tr><td colspan=""3""><div style=""padding:5px"" align=""left""><div><b>'.$n.'</b></div>'.$vs.'</div></td></tr>'; }else{ $contvimr .= '<tr><td nowrap><div align=""right"" style=""color:#888888;padding:3px 0px"">'.str_replace(' ','<br>',$n).'</div></td><td style=""color:#888888"">：</td><td width=""95%""><div style=""padding:3px"" align=""left"">'.$vs.'</div></td></tr>'; } } } $contvimr .= '</table></div>'; } if(isempt($contview))$contview = $contvimr; $contview = str_replace('$contview$',$contvimr, $contview); } $arr['contview'] = $contview; $arr['readarr'] = m('log')->getreadarr($this->mtable, $this->id); $arr['isedit'] = $this->iseditqx(); $arr['isdel'] = $this->isdeleteqx(); $arr['isflow'] = $this->isflow; $arr['modename'] = $this->modename; $arr['ischehui'] = $this->ischehui(); $arr['statustext'] = $ztass[4]; $arr['statuscolor'] = $ztass[1]; $arr['optmenu'] = $this->getoptmenu(1); $arr['isgbjl'] = (int)$this->rock->arrvalue($this->moders,'isgbjl','0'); $arr['isgbcy'] = (int)$this->rock->arrvalue($this->moders,'isgbcy','0'); $receiptrs = false; $receiptrow = m('receipt')->getall(""`modenum`='$this->modenum' and `mid`='$this->id' and `status`=1""); foreach($receiptrow as $k=>$hrs){ $uid1 = ','.$this->adminid.','; if(!contain(','.$hrs['receid'].',', $uid1))continue; if(!contain(','.$hrs['receids'].',', $uid1)){ $receiptrs = array( 'id' => $hrs['id'], 'optname' => $hrs['optname'], ); break; } } $arr['flowinfor'] = array(); $arr['readunarr'] = array(); $arr['receiptrs'] = $receiptrs; if($this->isflow>0){ $arr['flowinfor']= $this->getflowinfor(); if($arr['flowinfor']['ischeck']==1){ $arr['isplview']='0'; } } if(isset($data['title']))$arr['title'] = $data['title']; $_oarr = $this->flowdatalog($arr); if(is_array($_oarr))foreach($_oarr as $k=>$v)$arr[$k]=$v; $conta = $this->rock->matcharr($contview,2); $edbof = false; foreach($conta as $fids){ $thnr = ''; $contview = str_replace('`'.$fids.'`', $thnr, $contview); } $arr['contview'] = $contview; return $arr; } private function getsubdata($xu, $rows, $lx=0) { $iscz = 0; $iszb = $xu+1; $fields = 'subdata'.$xu.''; $subrows = $this->db->getrows('[Q]flow_element','`mid`='.$this->modeid.' and `iszb`='.$iszb.' and `iszs`=1','`fields`,`name`,`isalign`','`sort`'); $cont = ''; if($this->db->count > 0){ $iscz = 1; $headstr = '@xuhaos,,center'; $colorbb = getconfig('bcolorxiang', '#cccccc'); foreach($subrows as $k=>$rs){ $headstr.='@'.$rs['fields'].','.$rs['name'].''; if($rs['isalign']=='1')$headstr.=',left'; if($rs['isalign']=='2')$headstr.=',right'; } foreach($rows as $k=>$rs)$rows[$k]['xuhaos'] = $k+1; $slex = ($lx==0) ? 'noborder':''; if($this->subsubdatastyle!='')$slex = $this->subsubdatastyle; $cont = c('html')->createrows($rows, substr($headstr,1), $colorbb, $slex); } return $cont; } public function ischehui() { $is = 0; if($this->rs['status']==1 || $this->isflow==3)return $is; $where = """".$this->mwhere."" and `valid`=1 order by `id` desc""; $rs = $this->flogmodel->getone($where); $time = time()-2*3600; if($rs && $rs['status']=='1' && $rs['checkid']==$this->adminid && strtotime($rs['optdt'])>$time && ($rs['courseid']>0 || $rs['iszb']=='1' )) $is = $rs['id']; return $is; } public function chehui($sm='') { return $this->bd6('5peg5L!h5ZG8562!5o6I5peg5q2k5Yqf6IO9'); } public function bd6($str) { return $this->rock->jm->base64dencode($str); } public function getdataedit() { $fobj = m('file'); $arr['data'] = $this->flowrsreplaceedit($this->rssust); $arr['table'] = $this->mtable; $arr['tables'] = $this->moders['tables']; $arr['modeid'] = $this->modeid; $arr['isedit'] = $this->iseditqx(); $arr['isflow'] = $this->isflow; $arr['user'] = $this->urs; $arr['status'] = $this->rs['status']; $filers = $fobj->getfile($this->mtable,$this->id); foreach($filers as $fk=>$frs1)$filers[$fk]['thumbpath']=$fobj->getthumbpath($frs1); $arr['filers'] = $filers; $arr['subdata'] = $this->getsuballdata(); $filearr = array(); $fileids = ''; foreach($this->fieldsarr as $k=>$rs){ $fid = $rs['fields']; $flx = $rs['fieldstype']; if($flx=='uploadfile'){ $fval = arrvalue($this->rssust, $fid); if(!isempt($fval))$fileids.=','.$fval.''; } if($flx=='uploadimg'){ $arr['data'][''.$fid.'_view'] = $this->rock->gethttppath($arr['data'][$fid]); } } if($fileids!=''){ $frows = $fobj->getall('`id` in('.substr($fileids, 1).')','filename,id,filesizecn,fileext,optname,thumbpath,thumbplat'); foreach($frows as $k1=>$rs1){ $rs1['thumbpath'] = $fobj->getthumbpath($rs1); $filearr['f'.$rs1['id'].''] = $rs1; } } $arr['filearr'] = $filearr; $ztarr = $this->getnowstatus(); $arr['statustext'] = $ztarr[0]; $arr['statuscolor'] = $ztarr[1]; return $arr; } public function getflowinfor() { $ischeck = 0; $ischange= 0; $str = ''; $arr = $this->getflow(); if($arr['nowcheckid'] != $this->billrs['nowcheckid'])$this->getflowsave($arr, true); $nstatus = $this->rs['status']; $isturn = $this->rs['isturn']; $nowcheckid = ','.$arr['nowcheckid'].','; if($isturn==1 && $nstatus !=1 && contain($nowcheckid, ','.$this->adminid.',') && !in_array($nstatus, array(2,5))){ $ischeck = 1; } $logarr = $this->getlog(); $nowcur = $this->nowcourse; if(arrvalue($this->nextcourse,'checktype')=='change'){ $ischange = 1; } $sarr['ischeck'] = $ischeck; $sarr['ischange'] = $ischange; $sarr['nowcourse'] = $nowcur; $sarr['iszhuanban'] = 0; $sarr['ischao'] = 0; $sarr['nextcourse'] = $this->nextcourse; $sarr['nstatustext'] = $arr['nstatustext']; if($isturn==0)$sarr['nstatustext'] = '<font color=""#ff6600"">待提交</font>'; $_checkfields = arrvalue($nowcur,'checkfields'); $checkfields = array(); if($ischeck == 1 && !isempt($_checkfields)){ $_checkfieldsa = explode('|', $_checkfields); $_checkfields = join(',',$_checkfieldsa); $_checkxuant = arrvalue($_checkfieldsa, 1); $inputobj = c('input'); $inputobj->flow = $this; $inputobj->mid = $this->id; $inputobj->urs = $this->urs; $elwswhere = ""`mid`='$this->modeid' and `iszb`=0 and instr(',$_checkfields,', concat(',',`fields`,','))>0""; $infeidss = $inputobj->initFields($elwswhere); foreach($infeidss as $_fs=>$fsva){ $_sfes = $fsva['fields']; $_type = $fsva['fieldstype']; $showinpus = 1; $isbt = 1; if($_checkxuant && contain(','.$_checkxuant.',',','.$_sfes.','))$isbt=0; if($_type=='hidden' || $_type=='fixed')$showinpus=2; $_val = arrvalue($this->rssust, $_sfes); $cheo = (substr($_type,0,6)=='change' && !isempt($fsva['data'])); if($cheo)$_val.='|'.arrvalue($this->rssust, $fsva['data']).''; $checkfields[$_sfes] = array( 'inputstr' => $inputobj->getfieldcontval($_sfes, $_val), 'name' => $fsva['name'], 'isbt' => $isbt, 'fieldstype'=> $_type, 'fieldsarr' => $fsva, 'showinpus' => $showinpus ); if($cheo){ $_sfes = $fsva['data']; $checkfields[$_sfes] = array( 'inputstr' => '', 'isbt' => $isbt, 'name' => $fsva['name'].'id', 'fieldstype'=> $_type, 'fieldsarr' => false, 'showinpus' => 2 ); } } } $sarr['checkfields'] = $checkfields; if($nstatus==2)$sarr['nstatustext'] ='<font color=""#AB47F7"">待提交人处理('.$this->urs['name'].')</font>'; $loglen = count($logarr); foreach($logarr as $k=>$rs){ if($rs['courseid']>0){ $sty = ''; $col = $rs['color']; if($str!='')$str.=' → '; $str.='<span style=""'.$sty.'"">'.$rs['actname'].'('.$rs['name'].'<font color=""'.$col.'"">'.$rs['statusname'].'</font>)</span>'; } } if($nstatus=='2'){ if($str!='')$str.=' → '; $str.= $sarr['nstatustext']; }else if($nstatus=='5'){ if($str!='')$str.=' → '; $sarr['nstatustext'] = '<font color=""#888888"">已作废</font>'; $str.= '<font color=""#888888"">已作废</font>'; }else{ foreach($this->flowarr as $k=>$rs){ if($rs['ischeck']==0){ $sty = 'color:#888888'; if($rs['isnow']==1)$sty='font-weight:bold;color:#800000'; if($str!='')$str.=' <font color=#888888>→</font> '; $str.='<span style=""'.$sty.'"">'.$rs['name'].''; if(!isempt($rs['nowcheckname']))$str.='('.$rs['nowcheckname'].')'; $str.='</span>'; } } } $sarr['flowcoursestr'] = $str; if($nstatus==1)$sarr['nstatustext'] = $this->getnowstatus(1); $actstr = ',同意|green,不同意|red'; if(isset($nowcur['courseact']) ){ $actstrt = $nowcur['courseact']; if(!isempt($actstrt))$actstr = ','.$actstrt; } $act = c('array')->strtoarray($actstr); foreach($act as $k=>$as1)if($k>0 && $as1[0]==$as1[1])$act[$k][1]=''; $sarr['courseact'] = $act; $nowstatus = $this->rs['status']; if($this->isflow>0 && $this->rs['isturn']==0)$nowstatus=3; $sarr['nowstatus'] = $nowstatus; $step = $this->rock->arrvalue($nowcur, 'step','0'); $tuicourse = $this->flogmodel->getall($this->mwhere.' and `courseid`>0 and `valid`=1 and `status`=1 and `step`<'.$step.'','`id`,`checkname`,`name`','`step` desc'); $sarr['tuicourse'] = $tuicourse; return $sarr; } public function updatestatus($zt) { $this->update('`status`='.$zt.'', $this->id); $this->billmodel->update('`status`='.$zt.'', $this->mwhere); } public function getstatusarr() { return $this->getstatus(null, '','',2); } public function getstatus($rs, $statusstr='',$other='', $glx=0) { $statustext = $statuscolor = ''; if($statusstr=='')$statusstr=$this->rock->arrvalue($this->moders,'statusstr'); $statusara = array(); $colorsa = array('blue','green','red','#ff6600','#526D08','#888888','','','','','','','','','','','','',''); if(isempt($statusstr)){ $statussst = '不同意'; $statusstr = '待?处理|blue,已审核|green,'.$statussst.'|red'; } $nowcheckname= arrvalue($rs,'nowcheckname', arrvalue($this->billrs,'nowcheckname')); if(isempt($other))$other = $nowcheckname; $statusar = c('array')->strtoarray($statusstr); foreach($statusar as $k=>$v){ if($v[0]==$v[1])$v[1]= arrvalue($colorsa, $k); $statusara[$k] = $v; } $statusara[5] = array('已作废','#888888'); $statusara[23] = array('退回','#17B2B7'); if($glx==2)return $statusara; $isturn = -1; if(isset($rs['isturn']))$isturn = (int)$rs['isturn']; $zt = $this->rock->arrvalue($rs, 'status'); if($isturn==0){ $statustext = '待提交'; $statuscolor= '#ff6600'; }elseif(!isempt($zt)){ if(isset($statusara[$zt])){ $statustext = $statusara[$zt][0]; $statuscolor = $statusara[$zt][1]; } } if(contain($statustext,'?')){ $statusstr = str_replace('?', '<font color=""'.$statuscolor.'"">'.$other.'</font>', $statustext); }else{ $statusstr = '<font color=""'.$statuscolor.'"">'.$statustext.'</font>'; } if($glx==1){ return $statusstr; } return array(str_replace('?', $other, $statustext), $statuscolor, $zt, $statusstr, str_replace('?', '', $statustext)); } public function getstatusstr($rs) { return $this->getstatus($rs, '','', 1); } public function getnowstatus($glx=0) { return $this->getstatus($this->rs, '','', $glx); } private $getlogrows = array(); public function getlog($lx=0) { if(isset($this->getlogrows[$lx]))return $this->getlogrows[$lx]; $rows = $this->flogmodel->getrows($this->mwhere, '`checkname` as `name`,`checkid`,`name` as actname,`optdt`,`status`,`explain`,`statusname`,`valid`,`courseid`,`color`,`id`,`qmimg`','`id` asc'); $uids = $idss = ''; $dts = c('date'); $fo = m('file'); $editarrs = array(); foreach($rows as $k=>$rs){ $uids.=','.$rs['checkid'].''; $idss.=','.$rs['id'].''; $col = $rs['color']; if(isempt($col))$col='green'; if(contain($rs['statusname'],'不') || $rs['status']=='2')$col='red'; $rows[$k]['color'] = $col; $rows[$k]['checkdt'] = $rs['optdt']; $rows[$k]['sm'] = $rs['explain']; if(!isempt($rs['qmimg'])){ if(!contain($rs['qmimg'],'.')){ $qmimg = ''.UPDIR.'/'.date('Y-m').'/qmimg'.$rs['id'].'.png'; $bo = true; if(!file_exists($qmimg)){ $bar= explode(',', $rs['qmimg']); $bo = $this->rock->createtxt($qmimg, base64_decode($bar[1])); } if(!$bo){ $qmimg = $rs['qmimg']; }else{ $qmimg = ''.URL.''.$qmimg.''; } }else{ $qmimg = $rs['qmimg']; if(!file_exists($qmimg)){ $qmimg = ''; }else{ $qmimg = ''.URL.''.$qmimg.''; } } $rows[$k]['qmimg'] = $qmimg; if(!isempt($qmimg))$rows[$k]['explain']= '<img height=""30"" width=""70"" src=""'.$qmimg.'"">'.$rs['explain'].''; } } if($idss!=''){ $farr = $fo->getfile('flow_log', substr($idss, 1)); if($farr)foreach($rows as $k=>$rs){ $fstr = $fo->getallstr($farr, $rs['id'],2); $rows[$k]['explain']= $this->strappend($rs['explain'], $fstr, '<br>'); } } if($uids!=''){ $rows = m('admin')->getadmininfor($rows, substr($uids, 1), 'checkid'); } $this->getlogrows[$lx] = $rows; return $rows; } public function addlog($arr=array()) { $addarr = array( 'table' => $this->mtable, 'mid' => $this->id, 'checkname' => $this->adminname, 'checkid' => $this->adminid, 'optdt' => $this->rock->now, 'courseid' => '0', 'status' => '1', 'ip' => $this->rock->ip, 'web' => $this->rock->web, 'modeid' => $this->modeid ); foreach($arr as $k=>$v)$addarr[$k]=$v; $this->flogmodel->insert($addarr); $ssid = $this->db->insert_id(); $fileid = $this->rock->post('fileid'); if($fileid!='')m('file')->addfile($fileid, 'flow_log', $ssid, $this->modenum.'|'.$this->id); $logfileid = $this->rock->post('logfileid'); if($logfileid!='')m('file')->addfile($logfileid, 'flow_log', $ssid, $this->modenum.'|'.$this->id); $addarr['id'] = $ssid; $this->flowaddlog($addarr); $this->getlogrows = array(); return $ssid; } public function submit($na='', $sm='') { if($na=='')$na='提交'; $isturn = 1; if($na=='保存')$isturn = 0; $this->addlog(array( 'name' => $na, 'explain' => $sm )); if($this->isflow>0){ $marr['isturn'] = $isturn; $marr['status'] = 0; $this->rs['status'] = 0; $this->update($marr, $this->id); if(arrvalue($this->moders,'isflowlx')=='1' || $this->isflow>=3){ $this->checksmodel->delete($this->mwhere); $this->flogmodel->update('`valid`=0', ''.$this->mwhere.' and `courseid`>0 and `valid`=1'); } $farr = $this->getflow(); if($farr['nowcourseid']>0){ $sysnextoptid = $this->rock->post('sysnextoptid'); $sysnextopt = $this->rock->post('sysnextopt'); $sysnextcustidid = (int)$this->rock->post('sysnextcustidid'); if($sysnextcustidid == $farr['nowcourseid'] && !isempt($sysnextoptid) && !isempt($sysnextopt)){ $this->addcheckname($sysnextcustidid, $sysnextoptid, $sysnextopt, true, 1); $farr = $this->getflow(); } } $farr['status'] = 0; $this->savebill($farr); if($isturn == 1){ $this->nexttodo($farr['nowcheckid'],'submit'); } } $this->flowsubmit($na, $sm); $this->savecsname( $this->rock->post('syschaosongid'), $this->rock->post('syschaosong'), 0,$this->uid,$isturn,$na); if($na=='编辑'){ $this->gettodosend('boedit'); }else{ $this->gettodosend('boturn'); } } private function savecsname($csnameid,$csname,$uid,$type,$isturn, $na) { if(!isempt($csnameid)){ $where = $this->mwhere.' and `type`='.$type.''; if($type>0)$where.=' and `uid`='.$uid.''; $csid = (int)$this->chaomodel->getmou('id', $where); if($csid==0)$where = ''; $this->chaomodel->record(array( 'modeid' => $this->modeid, 'table' => $this->mtable, 'mid' => $this->id, 'uid' => $uid, 'type' => $type, 'csname' => $csname, 'csnameid' => $csnameid, ),$where); if($isturn==1)$this->nexttodo($csnameid,'chao', $na); } } public function getcsname($id=0) { if($id>0){ $where= ""`table`='$this->mtable' and `mid`='$id' and `type`=0""; }else{ $where= ""`modeid`={$this->modeid} and `uid`={$this->adminid} and `type`=0""; } $ors = $this->chaomodel->getone($where,'*','`id` desc'); $csname = $csnameid = ''; if($ors){ $csname = $ors['csname']; $csnameid = $ors['csnameid']; } return array( 'csname' => $csname, 'csnameid' => $csnameid, 'id' => $id, ); } public function zhuijiaexplain($sm='') { $this->addlog(array( 'explain' => $sm, 'name' => '追加说明', 'status' => 1, )); $zt = $this->rs['status']; if($zt==2 && $this->isflow>0 && $this->adminid==$this->uid){ $marr['status'] = 0; $this->rs['status'] = 0; $this->update($marr, $this->id); $farr = $this->getflow(); $farr['status'] = 0; $this->savebill($farr); $this->nexttodo($farr['nowcheckid'],'zhui', $sm); } $this->gettodosend('bozhui','', $sm); } public function chuiban($sm='') { $this->addlog(array( 'explain' => $sm, 'name' => '催办', 'status' => 1, )); $farr = $this->getflow(true); $this->nexttodo($farr['nowcheckid'],'cuiban', $sm); $this->gettodosend('cuiban','', $sm); } public function getflowpipei($uid=0) { $urs = $this->urs; if(!$urs)$urs = $uid; if(!is_array($urs))$urs = $this->db->getone('[Q]admin', ""`id`='$urs'"", '`deptid`,`deptpath`,`id`'); $coursedb = m('flowcourse'); $barr = $coursedb->pipeiCourse($this->modeid); $rows = $barr['rows']; $this->pipeiCoursearrc = $barr['rowd']; $this->pipeiCoursearrs = array(); $this->pipeiCoursearr = array(); $kqobj = m('kaoqin'); $this->getflowpipeis($rows, $urs, $kqobj); unset($this->pipeiCoursearrs); unset($this->pipeiCoursearrc); return $this->pipeiCoursearr; } private function getflowpipeis($rows,$urs, $kqobj) { $shiyong = array(); $defix = $xuhao = 0; $uid = arrvalue($urs,'id',0); $zshu = count($rows); foreach($rows as $k=>$rs){ $whereid = (int)$rs['whereid']; $receid = $rs['receid']; $wherestr= arrvalue($rs, 'where'); if($rs['status']=='0')continue; if(!isempt($wherestr)){ $wherestr = m('base')->strreplace($this->rock->jm->base64decode($wherestr), $uid); $to = $this->rows(""`id`='$this->id' and $wherestr ""); if($to==0)continue; } if($whereid > 0){ $bo = $this->wheremanzhu($whereid); if(!$bo)continue; } if(!isempt($rs['num'])){ $bo = $this->flowcoursejudge($rs['num'], $rs); if(is_bool($bo) && !$bo)continue; } $xuhao++; if($defix==0 && (isempt($receid) || contain($receid,'all'))){ $defix = $xuhao; } if(isempt($receid) && (!isempt($wherestr) || $whereid > 0)){ $defix = $xuhao; } $rs['xuhao'] = $xuhao; $shiyong[] = $rs; } $pboss = false; if($shiyong){ $gxuha = $kqobj->getpipeimid($urs, $shiyong, 'xuhao', $defix); if($gxuha>0){ $pboss = true; $gxuha = $gxuha-1; $prs = $shiyong[$gxuha]; $this->getflowpipeisss($prs, $urs, $kqobj); } } if(!$pboss && $zshu==1 && $rows[0]['childshu']>0){ $this->getflowpipeis($rows[0]['children'], $urs, $kqobj); } } private function getflowpipeisss($prsnrs, $urs, $kqobj) { $prs = $prsnrs; unset($prs['children']); $this->pipeiCoursearrs[]= $prs['id']; $this->pipeiCoursearr[] = $prs; if($prs['childshu']>0){ $this->getflowpipeis($prsnrs['children'], $urs, $kqobj); }else{ $nid = arrvalue($prs,'nid','0'); if($nid>0 && !in_array($nid, $this->pipeiCoursearrs) && isset($this->pipeiCoursearrc, $nid)){ $this->getflowpipeis(array($this->pipeiCoursearrc[$nid]), $urs, $kqobj); } } } public function getflow($sbo=false) { $this->flowarr = array(); $allcheckid = $nowcheckid = $nowcheckname = $nstatustext = ''; $allcheckids = array(); $nowcourseid = 0; $nstatus = $this->rs['status']; $this->nowcourse = array(); $this->nextcourse = array(); $this->flowisend = 0; $curs = $this->flogmodel->getrows($this->mwhere,'checkid,checkname,courseid,`valid`,`status`,`statusname`,`name`,`iszb`','id desc'); $cufss = $ztnas = $chesarr = array(); foreach($curs as $k=>$rs){ if($rs['iszb']=='1' && !in_array($rs['checkid'], $allcheckids))$allcheckids[] = $rs['checkid']; if($rs['courseid']=='0')continue; $_su = ''.$rs['courseid'].''; $_su1 = ''.$rs['courseid'].'_'.$rs['checkid'].''; if($rs['valid']==1 && in_array($rs['status'], $this->flowstatusarr)){ if(!isset($cufss[$_su]))$cufss[$_su]=0; $cufss[$_su]++; $chesarr[$_su1] = 1; } if(!in_array($rs['checkid'], $allcheckids))$allcheckids[] = $rs['checkid']; if($nstatustext=='' && $rs['courseid']>0){ $nstatustext = ''.$rs['checkname'].'处理'.$rs['statusname'].''; $nstatus = $rs['status']; } $ztnas[$rs['courseid']] = ''.$rs['checkname'].''.$rs['statusname'].''; } $nowstep = $zongsetp = -1; $isend = 0; $czt = $this->rs['status']; $coutye = 0; $rows = ($czt==1 || $czt==5)? array() : $this->getflowpipei($this->uid); if($rows){ $checksa = $this->checksmodel->getrows($this->mwhere.' and `addlx`=3'); $coursea = $nrows = array(); foreach($checksa as $k=>$rs)$coursea[$rs['courseid']]='1'; $nrows = array(); $allcheckid = ''; $isoptsuperbo = false; foreach($rows as $k=>$rs){ $uarr = $this->getcheckname($rs); $rows[$k]['checkid'] = $uarr[0]; $rows[$k]['checkname'] = $uarr[1]; $allcheckid .= ','.$uarr[0].''; if($rs['checktype']=='optsuper' && isempt($uarr[0]))$isoptsuperbo=true; } if($isoptsuperbo)foreach($rows as $k=>$rs){ if($rs['checktype']=='optsuper'){ $_k1 = $k-1; $_uid = $this->optid; if($_k1>=0){ $ours = $this->flogmodel->getone($this->mwhere.' and `courseid`='.$rows[$_k1]['id'].' and `valid`=1 ','`checkid`','`id` desc'); if($ours){ $_uid = (int)$rows[$_k1]['checkid']; }else{ $_uid = $ours['checkid']; } } $uarr = $this->adminmodel->getsuperman($_uid); if($uarr){ $rows[$k]['checkid'] = $uarr[0]; $rows[$k]['checkname'] = $uarr[1]; } } } foreach($rows as $k=>$rs){ $nrows[] = $rs; if($rs['checktype']=='superall'){ $ids1 = $rs['id']; $suparr = $this->adminmodel->getsuperarr($this->uid); if($suparr){ $logdsar = $this->getlog(); foreach($logdsar as $k1=>$rs1){ if($rs1['courseid']>0 && $rs1['status']=='1' && $rs1['valid']=='1')$allcheckid .= ','.$rs1['checkid'].''; } foreach($suparr as $k1=>$surs){ if(!contain(','.$allcheckid.',', ','.$surs['id'].',')){ $rs['oldid'] = $ids1; $rs['id'] = $ids1 * 99999 + $surs['id']; $rs['checkid'] = $surs['id']; $rs['checkname'] = $surs['name']; $nrows[] = $rs; $allcheckid .= ','.$surs['id'].''; } } } } } $yisheh = ''; if($this->isflow==2){ $logdsar = $this->getlog(); foreach($logdsar as $k1=>$rs1) if($rs1['courseid']>0 && $rs1['status']==1 && $rs1['valid']==1)$yisheh .= ','.$rs1['checkid'].''; } foreach($nrows as $k=>$rs){ $whereid = (int)$rs['whereid']; $checkshu = $rs['checkshu']; $checkid = $rs['checkid']; $checkname = $rs['checkname']; $checktype = $rs['checktype']; if($this->isflow==2 && !isempt($checkid) && isempt($rs['checkfields'])){ if(($checkid==$this->uid || $checkid==$this->optid) )continue; $k2 = $k+1; $ntype = 'yes'; if(isset($nrows[$k2])){ if($nrows[$k2]['checktype']=='change')$ntype='no'; } if($ntype=='yes' && contain(','.$yisheh.',',','.$checkid.','))continue; } if(!isempt($checkid))$yisheh .= ','.$checkid.''; $zongsetp++; $ischeck = 0; $checkids = $checknames = ''; $_su = ''.$rs['id'].''; $nowshu = 0; if(isset($cufss[$_su]))$nowshu = $cufss[$_su]; if(!$this->isempt($checkid)){ $checkida = explode(',', $checkid); $checkidna = explode(',', $checkname); $_chid = $_chna = ''; foreach($checkida as $k1=>$chkid){ $_su1 = ''.$rs['id'].'_'.$chkid.''; if(!in_array($chkid, $allcheckids))$allcheckids[] = $chkid; if(!isset($chesarr[$_su1])){ $_chid.=','.$chkid.''; $_chna.=','.arrvalue($checkidna, $k1).''; } } if($_chid!='')$_chid = substr($_chid, 1); if($_chna!='')$_chna = substr($_chna, 1); if($_chid==''){ $ischeck = 1; }else{ if($checkshu>0&&$nowshu>=$checkshu)$ischeck = 1; } $checkids = $_chid; $checknames = $_chna; }else{ if($checkshu>0&&$nowshu>=$checkshu)$ischeck = 1; if($checkshu == 0 && $nowshu>0)$ischeck = 1; } if($ischeck==0 && $coutye==0){ if((int)arrvalue($rs,'coursetype','0')>0)$coutye = 1; } $rs['ischeck'] = $ischeck; $rs['islast'] = 0; $rs['checkid'] = $checkid; $rs['checkname'] = $checkname; $rs['nowcheckid'] = $checkids; $rs['nowcheckname'] = $checknames; $rs['isnow'] = 0; $rs['nowstep'] = $zongsetp; $rs['step'] = $k+1; if($ischeck==0 && $nowstep==-1){ $rs['isnow']= 1; $nowstep = $zongsetp; $this->nowcourse = $rs; $nowcourseid = $rs['id']; $nowcheckid = $checkids; $nowcheckname = $checknames; } if($nowstep>-1 && $zongsetp==$nowstep+1)$this->nextcourse = $rs; $this->flowarr[]= $rs; } } if($zongsetp>-1)$this->flowarr[$zongsetp]['islast']=1; if($nowstep == -1){ $isend = 1; }else{ $nstatustext = '待'.$nowcheckname.'处理'; } $this->flowisend = $isend; $allcheckid = join(',', $allcheckids); $arrbill['allcheckid'] = $allcheckid; $arrbill['nowcourseid'] = $nowcourseid; $arrbill['nowcheckid'] = $nowcheckid; $arrbill['nowcheckname'] = $nowcheckname; $arrbill['nstatustext'] = $nstatustext; $arrbill['nstatus'] = $nstatus; $arrbill['status'] = $this->rs['status']; $arrbill['isturn'] = $this->rs['isturn']; if($sbo)$this->getflowsave($arrbill); return $arrbill; } public function wheremanzhu($id) { $uid = $this->uid; $ser = $this->wheremodel->getflowwhere($id, $uid); if(!$ser)return true; $str = $ser['ntr']; if(!isempt($str)){ $to = $this->db->rows('[Q]admin',""`id`='$uid' and ($str)""); if($to>0)return false; } $str = $ser['str']; if(!isempt($str)){ $to = $this->rows(""`id`='$this->id' and $str""); if($to==0)return false; } $str = $ser['utr']; if(!isempt($str)){ $to = $this->db->rows('[Q]admin',""`id`='$uid' and $str""); if($to==0)return false; } return true; } public function getflowsave($sarr, $suvu=false) { if(!$sarr)return; if($suvu)$sarr['updt'] = $this->rock->now; $this->billmodel->update($sarr, $this->mwhere); } private function getcheckname($crs) { $type = $crs['checktype']; $cuid = $name = ''; $courseid= $crs['id']; $cheorws = $this->checksmodel->getall($this->mwhere.' and `courseid`='.$courseid.'','checkid,checkname'); if($cheorws){ foreach($cheorws as $k=>$rs){ $lxss = $rs['checkid']; if(isempt($lxss) || $lxss=='0')continue; $cuid.=','.$lxss.''; $name.=','.$rs['checkname'].''; } if($cuid != ''){ $cuid = substr($cuid, 1); $name = substr($name, 1); return array($cuid, $name); } } if(!$this->isempt($crs['num'])){ $uarr = $this->flowcheckname($crs['num']); if(is_array($uarr)){ if(!$this->isempt($uarr[0]))return $uarr; } } if($type=='super' || $type=='superall'){ $cuid = $this->urs['superid']; $name = $this->urs['superman']; } if($type=='dept' || $type=='super' || $type=='superall'){ if($this->isempt($cuid) && $this->drs){ $cuid = $this->drs['headid']; $name = $this->drs['headman']; } } if($type=='apply'){ $cuid = $this->urs['id']; $name = $this->urs['name']; } if($type=='opt'){ $cuid = $this->rs['optid']; $name = $this->rs['optname']; if(isempt($cuid)){ $cuid = $this->urs['id']; $name = $this->urs['name']; } } if($type=='user'){ $cuid = $crs['checktypeid']; $name = $crs['checktypename']; } if($type=='rank'){ $rank = $crs['checktypename']; if(!$this->isempt($rank)){ $wheer1 = $this->adminmodel->getcompanywhere(5); $rnurs = $this->db->getrows('[Q]admin',""`status`=1 and `ranking`='$rank' "".$wheer1."""",'id,name','sort'); foreach($rnurs as $k=>$rns){ $cuid.=','.$rns['id'].''; $name.=','.$rns['name'].''; } if($cuid != ''){ $cuid = substr($cuid, 1); $name = substr($name, 1); } } } if($type=='cname'){ $cnbar = $this->cnamemodel->getcheckname($crs['checktypeid'], $this->uid); $cuid = arrvalue($cnbar, 0); $name = arrvalue($cnbar, 1); } if($type=='field'){ $fids = $crs['checktypeid']; if(!isempt($fids)){ $vals = ''; $farrs= explode(',', $fids); foreach($farrs as $fid){ $vid = arrvalue($this->rs, $fid); if(!isempt($vid))$vals.=','.$vid.''; } if($vals!=''){ $vals = substr($vals, 1); $uarr = $this->adminmodel->getrows('`status`=1 and `id` in('.$vals.')','id,name'); foreach($uarr as $k=>$rs){ $cuid.=','.$rs['id'].''; $name.=','.$rs['name'].''; } if($cuid != ''){ $cuid = substr($cuid, 1); $name = substr($name, 1); } } } } $cuid = $this->rock->repempt($cuid); $name = $this->rock->repempt($name); return array($cuid, $name); } public function createbianhao($num, $fid, $wshu=3) { if(isempt($num))$num=''.$this->modenum.'-'; @$appdt = $this->rs['applydt']; if(isempt($appdt))$appdt = $this->rock->date; $apdt = str_replace('-','', $appdt); $num = str_replace('Ymd',$apdt,$num); return $this->db->sericnum($num,'[Q]'.$this->mtable.'', $fid, $wshu); } public function createinputnum($num, $fid) { $acta = ''; if(method_exists($this, $num)){ $acta = $num; }else{ if(contain($num, ',')){ $arra = explode(',', $num); $acta = $arra[0]; $num = $arra[1]; } } if($acta && method_exists($this, $acta)){ $barr = $this->$acta($num); if(is_array($barr)){ $qom = arrvalue($barr, 'qom', $num); $wshu= arrvalue($barr, 'wshu', 3); $bom = arrvalue($barr, 'bom'); $fields = arrvalue($barr, 'fields', $fid); return $this->createbianhao($qom, $fields, $wshu).$bom; }else{ if(isempt($barr))$barr = $num; return $this->createbianhao($barr, $fid); } }else{ return $this->createbianhao($num, $fid); } } public function createnum() { $num = $this->moders['sericnum']; if($num=='无'||$this->isempt($num))$num='TM-Ymd-'; @$appdt = $this->rs['applydt']; if(isempt($appdt))$appdt = $this->rock->date; $apdt = str_replace('-','', $appdt); $num = str_replace('Ymd',$apdt,$num); return $this->db->sericnum($num,'[Q]flow_bill', 'sericnum', 3); } public function savebill($oarr=array()) { $dbs = $this->billmodel; $whes= $this->mwhere; $biid= (int)$dbs->getmou('id', $whes); $arr = array( 'table' => $this->mtable, 'mid' => $this->id, 'optdt' => isset($this->rs['optdt']) ? $this->rs['optdt'] : $this->rock->now, 'optname' => $this->adminname, 'optid' => $this->adminid, 'modeid' => $this->modeid, 'updt' => $this->rock->now, 'isturn' => $this->rs['isturn'], 'nstatus' => $this->rs['status'], 'applydt' => $this->rs['applydt'], 'modename' => $this->modename, 'uname' => $this->rs['base_name'], 'udeptname' => $this->rs['base_deptname'], 'uid' => $this->uid, ); foreach($oarr as $k=>$v)$arr[$k]=$v; if($biid==0){ $arr['isdel'] = '0'; $arr['status'] = $arr['nstatus']; $arr['createdt']= $arr['optdt']; $arr['sericnum']= $this->createnum(); $arr['udeptid'] = $this->rock->post('sysudeptid', $this->urs['deptid']); $whes = ''; $this->sericnum = $arr['sericnum']; }else{ $udeptid = $this->billrs['udeptid']; if($udeptid==0)$arr['udeptid']=$this->urs['deptid']; } $dbs->record($arr, $whes); return $arr; } public function getsummary() { return $this->rock->reparr($this->moders['summary'], $this->rs); } public function addcheckname($courseid, $uid, $uname, $onbo=false, $addlx=0) { if(isempt($uid)){$uid = '0';$uname= 'auto';} $uida = explode(',', ''.$uid.''); $uidan = explode(',', $uname); if($onbo)$this->checksmodel->delete($this->mwhere.' and `courseid`='.$courseid.''); if($uida)foreach($uida as $k=>$uid){ $uname = $this->rock->arrvalue($uidan, $k); $zyarr = array( 'table' => $this->mtable, 'mid' => $this->id, 'modeid' => $this->modeid, 'courseid' => $courseid, 'optid' => $this->adminid, 'optname' => $this->adminname, 'addlx' => $addlx, 'optdt' => $this->rock->now, 'status' => 0 ); $this->checksmodel->delete($this->mwhere.' and `checkid`='.$uid.' and `courseid`='.$courseid.''); $zyarr['checkid'] = $uid; $zyarr['checkname'] = $uname; $this->checksmodel->insert($zyarr); } if($addlx==4)$this->checksmodel->delete($this->mwhere.' and `checkid`='.$this->adminid.' and `courseid`='.$courseid.''); } public function savedatastr($fval, $farr, $data=array()) { $str = ''; if(!$farr)return $str; $savewhere = $farr['savewhere']; $name = $farr['name']; $types = $farr['fieldstype']; if(isempt($savewhere) || isempt($fval))return $str; $savewhere = str_replace(array('{0}','{date}','{now}'), array($name, $this->rock->date,$this->rock->now), $savewhere); $savewhere = $this->rock->reparr($savewhere, $data); $saees = explode(',', $savewhere); if($types=='date' || $types=='datetime')$fval = strtotime($fval); if($types=='number')$fval = floatval($fval); foreach($saees as $saeess){ $fsaed = explode('|', $saeess); $msg = isset($fsaed[2]) ? $fsaed[2] : ''.$name.'数据不符号'; $val = isset($fsaed[1]) ? $fsaed[1] : ''; $lfs = $fsaed[0]; if($val != ''){ if($types=='date' || $types=='datetime')$val = strtotime($val); if($types=='number')$val = floatval($val); if($lfs=='gt'){$bo = $fval>$val;if(!$bo)return $msg;} if($lfs=='egt'){$bo = $fval>=$val;if(!$bo)return $msg;} if($lfs=='lt'){$bo = $fval<$val;if(!$bo)return $msg;} if($lfs=='elt'){$bo = $fval<=$val;if(!$bo)return $msg;} if($lfs=='eg'){$bo = $fval==$val;if(!$bo)return $msg;} if($lfs=='neg'){$bo = $fval!=$val;if(!$bo)return $msg;} } } return $str; } public function update($arr, $where) { if(is_array($arr)){ foreach($arr as $k=>$v)$this->rs[$k]=$v; } return parent::update($arr,$where); } public function updatelogvalid($whe) { $this->flogmodel->update('valid=0', $this->mwhere.' '.$whe); } public function strappend($sm, $str, $fh=',') { if(isempt($str))return $sm; if(!isempt($sm))$sm.=$fh; $sm.=$str; return $sm; } public function checkerror($lx=1,$sm='') { if($sm=='')$sm='单据异常管理员处理'; $msg = $this->check($lx, $sm, 1); return $msg; } public function check($zt, $sm='', $lx=0) { if($this->rs['status']==1)return '流程已处理完成,无需操作'; $arr = $this->getflow(); $flowinfor = $this->getflowinfor(); if($flowinfor['ischeck']==0 && $lx==0)return '当前是['.$arr['nowcheckname'].']处理'; $nowcourse = $this->nowcourse; if($lx==1){ if($arr['nowcourseid']!=0)return '当前有审核步骤ID是存在的不能直接标识已完成'; $to = $this->flogmodel->rows($this->mwhere.' and `courseid`>0 and `status`=1'); if($to==0)return '该单据没有任何通过审核处理不能直接标识已完成或已审核'; $nowcourse = array('id'=>66666,'name'=>'异常处理','step'=>0); } $nextcourse = $this->nextcourse; $zynameid = $this->rock->post('zynameid'); $zyname = $this->rock->post('zyname'); $csnameid = ''; $csname = ''; $nextname = $this->rock->post('nextname'); $nextnameid = $this->rock->post('nextnameid'); $qmimgstr = $this->rock->post('qmimgstr'); $tuiid = (int)$this->rock->post('tuiid'); $iszhuanyi = $ischangenext = 0; if($zt==1 && $this->isflow!=3 && isempt($zynameid) && arrvalue($nextcourse,'checktype')=='change'){ $ischangenext = 1; } if($zt!=2)$tuiid = 0; $istongyi = in_array($zt, $this->flowstatusarr); if($zynameid!='' && $istongyi){ if($zynameid==$this->adminid)return '不能转给自己'; $sm = $this->strappend($sm, '转给：'.$zyname.''); $iszhuanyi = 1; $this->rs['syszb_name'] = $zyname; $this->rs['syszb_nameid'] = $zynameid; } if($nextnameid=='' && $ischangenext==1)return '请选择下一步处理人'; $ufied = array(); if($iszhuanyi == 0 && $zt!=2){ foreach($flowinfor['checkfields'] as $chef=>$chefv){ $ufied[$chef] = $this->rock->post('cfields_'.$chef.''); if(isempt($ufied[$chef]) && $chefv['isbt']=='1')$this->echomsg(''.$chefv['name'].'不能为空'); $_str = $this->savedatastr($ufied[$chef], $chefv['fieldsarr'], $this->rs); if($_str!='')$this->echomsg($_str); } } $this->checkiszhuanyi = $iszhuanyi; $barr = $this->flowcheckbefore($zt, $ufied, $sm); $msg = ''; if(is_array($barr) && isset($barr['msg']))$msg = $barr['msg']; if(is_array($barr) && isset($barr['update'])){ foreach($barr['update'] as $_k=>$_v)$ufied[$_k] = $_v; } if(is_string($barr))$msg = $barr; if(!isempt($msg))return $msg; if($ufied){ $bo = $this->update($ufied, $this->id); if(!$bo)return 'dberr:'.$this->db->error(); } $courseact = $flowinfor['courseact']; $act = $courseact[$zt]; $statusname = $act[0]; $statuscolor= $act[1]; $nzt = $act[2]; $courseid = $nowcourse['id']; $this->checksmodel->update('`status`='.$zt.'', $this->mwhere.' and `checkid`='.$this->adminid.' and `courseid`='.$courseid.''); if($iszhuanyi == 1){ $this->addcheckname($courseid, $zynameid, $zyname, false, 4); $nowcourse['id'] = 0; } if($ischangenext==1){ $this->addcheckname($nextcourse['id'], $nextnameid, $nextname, true, 1); } $tuirs = array(); if($tuiid > 0)$tuirs = $this->flogmodel->getone($tuiid); if(!$tuirs)$tuiid = 0; if($tuiid>0){ $sm = $this->strappend($sm, '退回到['.$tuirs['name'].'('.$tuirs['checkname'].')]'); $statusname = '退回'; $statuscolor = '#17B2B7'; } $this->checkistui = $tuiid; $logsm = $sm; if($iszhuanyi==0 && $csname)$logsm = $this->strappend($logsm,'抄送给：'.$csname.''); $this->lastlogid = $this->addlog(array( 'courseid' => $nowcourse['id'], 'name' => $nowcourse['name'], 'step' => $nowcourse['step'], 'status' => $zt, 'statusname'=> $statusname, 'color' => $statuscolor, 'explain' => $logsm, 'iszb' => $iszhuanyi, 'qmimg' => $qmimgstr )); if($tuiid > 0){ $this->addcheckname($tuirs['courseid'], $tuirs['checkid'], $tuirs['checkname'], true, 3); $this->updatelogvalid('and `courseid`>0 and `status`=1 and `step`>='.$tuirs['step'].''); } $lzt = $this->rock->repempt($nzt, $zt); $uparr = $nexttodoarr = $nexttodoarc = array(); $bsarr = $this->getflow(); $bsarr['tuiid'] = $tuiid; $nextcheckid = $bsarr['nowcheckid']; if($istongyi){ if($iszhuanyi==0){ $uparr['status']= $this->rock->repempt($nzt,'0'); } $nexttodoarr = array($nextcheckid, 'next', $sm, $statusname); }else{ if($tuiid>0){ $lzt = 23; $nexttodoarr = array($nextcheckid, 'tui', $sm, $statusname); }elseif($zt==2){ $nexttodoarr = array($this->optid, 'nothrough', $sm, $statusname); } $uparr['status'] = $lzt; } $this->flowcheckafter($zt, $sm, $nowcourse); $bsarr['nstatus'] = $lzt; $bsarr['checksm'] = $sm; if(!$this->nowcourse){ $uparr['status'] = $lzt; $nexttodoarc = array($this->optid, 'finish', $sm, ''); } if($uparr){ $this->update($uparr, $this->id); } if(!$this->nowcourse){ $this->flowcheckfinsh($zt); if($istongyi){ $this->checksmodel->delete($this->mwhere); } } $bsarr['status'] = $this->rs['status']; $this->getflowsave($bsarr, true); if($this->db->backsql()){ $bos = ($courseid == arrvalue($this->nowcourse, 'id') && $istongyi); if($nexttodoarr && (!$bos || $iszhuanyi==1))$this->nexttodo($nexttodoarr[0],$nexttodoarr[1],$nexttodoarr[2],$nexttodoarr[3]); if($nexttodoarc)$this->nexttodo($nexttodoarc[0],$nexttodoarc[1],$nexttodoarc[2],$nexttodoarc[3]); } if($iszhuanyi == 1){ $this->gettodosend('bozhuan','', $sm, 0, ''.$this->adminname.'将['.$nowcourse['name'].']转给:'.$zyname.''); }else{ if($istongyi)$this->gettodosend('botong', $statusname, $sm, $nowcourse['id']); if($zt==2)$this->gettodosend('bobutong',$statusname, $sm, $nowcourse['id']); if(!$this->nowcourse && $istongyi)$this->gettodosend('bofinish', '', $sm); } if($iszhuanyi==0){ $sm1 = '在“'.$nowcourse['name'].'”处理'.$statusname.''; $this->savecsname($csnameid,$csname,$this->adminid,$nowcourse['id'],1, $sm1); } return 'ok'; } public function pushs($receid, $cont, $title='', $params=array()) { return $this->push($receid,'', $cont, $title, 0, $params); } public function getxiangurl($num='', $id=0, $lx='x') { if($num=='')$num = $this->modenum; if($id==0)$id = $this->id; $url = URL; if($lx=='auto')$lx = ($this->ismobile==1)?'x':'p'; if($lx=='x')$url = $this->rock->getouturl(); $url = ''.$url.'task.php?a='.$lx.'&num='.$num.'&mid='.$id.''; return $url; } public function getxiangurlx($num='',$id=0){return $this->getxiangurl($num,$id,'x');} public function push($receid, $gname='', $cont, $title='', $wkal=0, $params=array()) { if(isempt($receid) && $wkal==1)$receid='all'; if(isempt($receid))return false; if(contain(','.$receid.',', ',d1,'))$receid='all'; $modenum = arrvalue($params, 'modenum', $this->modenum); $modename = arrvalue($params, 'modename', $this->modename); $id = (int)arrvalue($params, 'id', $this->id); $moders = arrvalue($params, 'moders'); if(!is_array($moders))$moders = $this->moders; if($gname=='')$gname = $modename; $reim = m('reim'); $url = $this->getxiangurl($modenum, $id, 'p'); $wxurl = $this->getxiangurl($modenum, $id, 'x'); $emurl = $this->getxiangurl($modenum, $id, 'a'); if($id==0){ $url = '';$wxurl = '';$emurl=''; } $url = arrvalue($params, 'url', $url); $wxurl = arrvalue($params, 'wxurl', $wxurl); $emurl = arrvalue($params, 'emurl', $emurl); $slx = 0; $pctx = $moders['pctx']; $mctx = $moders['mctx']; $wxtx = $moders['wxtx']; $ddtx = $moders['ddtx']; $emtx = $moders['emtx']; if($pctx==0 && $mctx==1)$slx=2; if($pctx==1 && $mctx==0)$slx=1; if($pctx==0 && $mctx==0)$slx=3; $this->rs['now_adminname'] = $this->adminname; $this->rs['now_modename'] = $modename; $cont = $this->rock->reparr($cont, $this->rs); $receid = $this->adminmodel->gjoins($receid); $uids = m('todo')->addtodo($receid, $modename, $cont, $modenum, $id); if($uids!='' && $moders['type'] != '系统' && $id > 0)$this->todosmodel->addtotouids($uids, array( 'table' => $this->mtable, 'mid' => $id, 'modename' => $modename, 'modenum' => $modenum, )); $title = $this->rock->reparr($title, $this->rs); $reim->pushagent($uids, $gname, $cont, $title, $url, $wxurl, $slx, ''.$modenum.'|'.$id.''); $this->flowchangetodo($uids, $gname); if(isempt($title))$title = $modename; $this->flowweixinarr=array(); return $receid; } public function nexttodo($nuid, $type, $sm='', $act='') { $cont = ''; $tit = ''; $gname = '流程待办'; $summary= $this->getsummary(); if($type=='submit' || $type=='next' || $type == 'cuiban'){ $cont = '你有['.$this->uname.']的['.$this->modename.',单号:'.$this->sericnum.']需要处理'; if($sm!='')$cont.='，说明:'.$sm.''; $tit = ''.$this->uname.'的'.$this->modename.''; if($type != 'cuiban'){ $txnum = $this->option->getval('sms_txnum'); if(!isempt($txnum)){ $mknum = $this->option->getval('sms_mknum'); if($mknum=='all' || contain(','.$mknum.',',','.$this->modenum.',')){ $wxurl = $this->getxiangurlx(); $barr = c('xinhuapi')->sendsms($nuid, '', $txnum, array( 'modename' => $this->modename, 'sericnum' => $this->sericnum, 'applyname'=> $this->uname, 'deptname' => $this->rs['base_deptname'], ),$wxurl); } } } $type = 'daiban'; } if($type == 'nothrough'){ $cont = '你提交['.$this->modename.',单号:'.$this->sericnum.']'.$this->adminname.'处理['.$act.']，原因:['.$sm.']'; $gname= '流程申请'; $tit = ''.$this->modename.'处理'.$act.''; } if($type == 'finish'){ $cont = '你提交的['.$this->modename.',单号:'.$this->sericnum.']已全部处理完成'; $gname= '流程申请'; $tit = ''.$this->modename.'全部处理完成'; } if($type == 'zhui'){ $cont = ''.$this->adminname.'追加单据说明['.$this->modename.',单号:'.$this->sericnum.']，说明:['.$sm.']'; } if($type == 'tui'){ $cont = '['.$this->adminname.']退回单据['.$this->modename.',单号:'.$this->sericnum.']到你这请及时处理，说明:'.$sm.''; } if($type == 'chao'){ $cont = ''.$this->adminname.''.$sm.'了“'.$this->modename.'”'; if(!isempt($summary))$cont.='，摘要“'.$summary.'”'; if($this->isflow>0)$cont.='，单号“'.$this->sericnum.'”'; $gname= ''; $tit = ''.$this->modename.'的单据抄送'; } if($type=='pinglun'){ $cont = ''.$this->adminname.''.$act.'你的['.$this->modename.']单据，说明:'.$sm.''; $gname = ''; $tit = ''.$this->modename.'评论'; } if($type=='receipt'){ $cont = ''.$this->adminname.''.$act.'['.$this->modename.']的单据'; if($sm!='')$cont.='，说明:'.$sm.''; $gname = '回执确认'; $tit = ''.$this->modename.'回执确认'; } $nbis = $this->flownexttodo($type); if($nbis){ if(is_string($nbis))$cont = $nbis; if(is_array($nbis)){ $tit = arrvalue($nbis, 'title', $tit); $gname = arrvalue($nbis, 'gname', $gname); $cont = arrvalue($nbis, 'cont', $cont); } } if($cont!='')$this->push($nuid, $gname, $cont, $tit); } public function getwxurl($num='') { if($num=='')$num = $this->modenum; $url = $this->rock->getouturl(); $str = ''.$url.'?m=ying&d=we&num='.$num.''; return $str; } public function getweurl($num='') { if($num=='')$num = $this->modenum; $url = $this->rock->getouturl(); $str = ''.$url.'?m=ying&d=we&mnum='.$num.''; return $str; } public function deletebill($sm='', $qxpd=true) { if(getconfig('systype')=='demo')return '演示请勿删除'; if($qxpd){ $is = $this->isdeleteqx(); if($is==0)return '无权删除'; } if(method_exists($this,'flowdeletebillbefore')){ $bstr = $this->flowdeletebillbefore($sm); if(!isempt($bstr))return $bstr; } $modewhere = ""`modenum`='"".$this->modenum.""' and `mid`="".$this->id.""""; $this->flogmodel->delete($this->mwhere); m('reads')->delete($this->mwhere); m('file')->delfiles($this->mtable, $this->id); $tables = $this->moders['tables']; if(!isempt($tables)){ $arrse = explode(',', $tables); foreach($arrse as $arrses)m($arrses)->delete('mid='.$this->id.''); } $this->billmodel->delete($this->mwhere); $this->todosmodel->delete($this->mwhere); $this->checksmodel->delete($this->mwhere); $this->chaomodel->delete($this->mwhere); m('remind')->delete($this->mwhere); m('todo')->delete($this->mwhere); m('todo')->delete($modewhere); m('receipt')->delete($this->mwhere); m('im_history')->delete(""`xgurl`='"".$this->modenum.""|"".$this->id.""'""); $this->delete($this->id); $this->flowdeletebill($sm); $this->flowzuofeibill($sm); $this->gettodosend('bodel','', $sm); $dels = '删除模块['.$this->modename.']id为'.$this->id.'的单据'; $ztss = arrvalue($this->rs,'base_summary'); if(!isempt($ztss))$dels.=',摘要['.$ztss.']'; if(!isempt($sm))$dels.=',说明:'.$sm.''; m('log')->addlogs('删除单据', $dels, 3); foreach($this->wherejoin as $num=>$fields){ $this->deletebilljoin($num, ""`$fields`='$this->id'"", $sm); } return 'ok'; } public function deletebilljoin($num, $where, $sm='') { $flow = m('flow')->initflow($num); $rows = $flow->getall($where); foreach($rows as $k1=>$rs1){ $mid = $rs1['id']; $flow->loaddata($mid, false); $flow->deletebill($sm, false); } } public function zuofeibilljoin($num, $where, $sm='') { $flow = m('flow')->initflow($num); $rows = $flow->getall($where); foreach($rows as $k1=>$rs1){ $mid = $rs1['id']; $flow->loaddata($mid, false); $flow->zuofeibill($sm); } } public function zuofeibill($sm='') { $this->addlog(array( 'explain' => $sm, 'name' => '作废', 'status' => 1, )); $this->update('`status`=5', $this->id); $zfarr = array( 'status' => 5, 'nstatus' => 5, 'checksm' => '作废：'.$sm.'', 'nowcheckid' => '', 'nowcheckname' => '', 'nstatustext' => '作废', 'updt' => $this->rock->now, ); $this->billmodel->update($zfarr, $this->mwhere); $tables = $this->moders['tables']; if(!isempt($tables)){ $arrse = explode(',', $tables); foreach($arrse as $arrses)m($arrses)->delete('mid='.$this->id.''); } $this->flowzuofeibill($sm); $this->gettodosend('bozuofei','', $sm); foreach($this->wherejoin as $num=>$fields){ $this->zuofeibilljoin($num, ""`$fields`='$this->id'"", $sm); } return 'ok'; } public function smschuiban($sm='') { if($this->isflow>0 && $this->adminid==$this->uid){ $farr = $this->getflow(true); $nowcheckid = $farr['nowcheckid']; $tplnum = $this->option->getval('sms_cbnum','defnum'); $wxurl = $this->getxiangurlx(); $barr = c('xinhuapi')->sendsms($nowcheckid, '', $tplnum, array( 'modename' => $this->modename, 'sericnum' => $this->sericnum, 'applyname'=> $this->uname, 'deptname' => $this->rs['base_deptname'], ),$wxurl, false, false); if(!$barr['success'])return $barr['msg']; $this->addlog(array( 'explain' => $sm, 'name' => '短信催办', 'status' => 1, )); } return 'ok'; } public function addschedule($sm='') { $txdt = $this->rock->post('txdt'); if(isempt($sm))return '说明不能为空'; if(isempt($txdt))return '提醒时间不能为空'; $barr['title'] = $sm; $barr['startdt'] = $txdt; $barr['uid'] = $this->adminid; $barr['optdt'] = $this->rock->now; $barr['optname']= $this->adminname; $barr['txsj'] = 1; m('schedule')->insert($barr); return 'ok'; } public function getoptmenu($flx=0) { $where = ''; if($flx==1)$where='and `iszs`=1'; $rows = $this->db->getrows('[Q]flow_menu',""`setid`='$this->modeid' "".$where."" and `status`=1"",'id,wherestr,name,statuscolor,statusvalue,num,islog,issm,type,upgcont','`sort`'); $arr = array(); $bfrom = $this->rock->post('bfrom'); if($flx==1)return $arr; $status = (int)arrvalue($this->rs,'status','0'); $isturn = (int)arrvalue($this->rs, 'isturn','0'); $ismy = ($this->uid == $this->adminid or $this->optid == $this->adminid); $isreadbo = $this->isreadqx(1); if($this->isflow>0 && $isturn==1){ } if($status != 5 && arrvalue($this->moders,'ispl','1')=='1' && $isreadbo){ $arr[] = array('name'=>'评论','lx'=>15,'nup'=>1,'issm'=>1,'optmenuid'=>-15); } if($ismy && arrvalue($this->moders,'ishz')=='1' && $status==1){ $smcont = $this->getsummary(); $mid = (int)m('receipt')->getmou('id',""`uid`='$this->adminid' and `modenum`='$this->modenum' and `mid`='$this->id'""); $namess = '回执确认设置'; if($mid>0)$namess = '回执确认编辑'; $arr[] = array('name'=>$namess,'djmid'=>$mid,'optnum'=>'receipt','lx'=>'18','optmenuid'=>-18,'modename'=>$this->modename,'smcont'=>$smcont); } if($isreadbo && arrvalue($this->moders,'istxset','1')=='1' && $this->modenum != 'remind' && !in_array($status, array(2,5))){ $smcont = ''.$this->modename.'：'.$this->getsummary(); $mid = (int)m('remind')->getmou('id',""`uid`='$this->adminid' and `modenum`='$this->modenum' and `mid`='$this->id'""); $namess = '＋添加提醒设置'; if($mid>0)$namess = '提醒设置编辑'; $arr[] = array('name'=>$namess,'djmid'=>$mid,'smcont'=>$smcont,'issm'=>1,'optnum'=>'tixing','lx'=>'14','optmenuid'=>-14); } if($this->iseditqx()==1 && $isreadbo){ $arr[] = array('name'=>'编辑','optnum'=>'edit','lx'=>'11','optmenuid'=>-11); } if($this->isdeleteqx()==1){ $arr[] = array('name'=>'删除','color'=>'red','optnum'=>'del','nup'=>1,'issm'=>0,'islog'=>0,'statusvalue'=>9,'lx'=>'9','optmenuid'=>-9); } return $arr; } public function optmenu($czid, $zt, $sm='') { $msg = ''; $cname = $this->rock->post('changename'); $cnameid = $this->rock->post('changenameid'); $cdate = $this->rock->post('changedate'); $darr = array( 'cname' => $cname, 'cnameid' => $cnameid, 'cdate' => $cdate, 'sm' => $sm, ); if($czid==-9){ $msg = $this->deletebill($sm); }else if($czid==-10){ $msg = $this->check($zt, $sm); if(contain($msg,'成功'))$msg = 'ok'; }else if($czid==-12){ $this->zhuijiaexplain($sm); }else if($czid==-13){ $this->chuiban($sm); }else if($czid==-14){ $msg = $this->addschedule($sm); }else if($czid==-15){ $actname = $this->rock->post('name'); $this->addlog(array( 'explain' => $sm, 'name' => $actname, )); $uids = arrvalue($this->rs,'uid','0'); if(isset($this->rs['optid']))$uids.=','.$this->rs['optid'].''; $this->nexttodo($uids, 'pinglun', $sm, $actname); $this->gettodosend('boping','', $sm); }else if($czid==-16){ $this->zuofeibill($sm); }else if($czid==-17){ $msg = $this->smschuiban($sm); }else if($czid==-18){ $msg = $this->jiankongzb($darr); }else{ } if($msg=='')$msg='ok'; return $msg; } public function jiankongzb($darr) { return $this->bd6('5peg5L!h5ZG8562!5o6I5peg5q2k5Yqf6IO9'); } public function billwhere($uid, $lx) { $arr['table'] = $this->mtable; $arr['tableleft'] = ''; $arr['fields'] = ''; $arr['order'] = ''; $arr['group'] = ''; $arr['keywhere']= ''; $arr['asqom'] = ''; $arr['onlywhere'] = ''; $arr['companywhere']= ''; $this->atype = $lx; $nas = $this->flowbillwhere($uid, $lx); $inwhere = ''; if(substr($lx,0,5)=='grant'){ $inwhere = $this->viewmodel->viewwhere($this->moders, $this->adminid, $this->flowviewufieds, 1); } if($lx=='chaos'){ $inwhere = ""and {asqom}`id` in(select `mid` from `[Q]flow_chao` where `table`='{$this->mtable}' and "".$this->rock->dbinstr('csnameid', $this->adminid)."")""; } if($lx=='mychuli'){ $inwhere = ""and {asqom}`id` in(select bill.`mid` from `[Q]flow_bill` as `bill` where bill.`modeid`='{$this->modeid}' and "".$this->rock->dbinstr('bill.`allcheckid`', $this->adminid)."")""; } $_wehs = ''; if(is_array($nas)){ if(isset($nas['where']))$_wehs = $nas['where']; $ftears = explode(',','asqom,order,fields,fieldsleft,table,group,companywhere,onlywhere,keywhere,tableleft'); foreach($ftears as $fid)if(isset($nas[$fid]))$arr[$fid] = $nas[$fid]; }else{ $_wehs = $nas; } $fwhere = $this->getflowwhere($uid, $lx); $path = ''.P.'/flow/page/rock_page_'.$this->modenum.'.php'; $table = $arr['table']; $temsao = 0; if(!contain($table, ' ') && $this->isflow>0){ $arr['table'] = '`[Q]'.$this->mtable.'` a left join `[Q]flow_bill` b on a.`id`=b.`mid` and b.`table`=\''.$this->mtable.'\''; if(!isempt($arr['tableleft']))$arr['table'].=' left join '.$arr['tableleft'].''; $arr['asqom'] = 'a.'; $arr['fields']= 'a.*,b.`uname` as base_name,b.`udeptname` as base_deptname,b.`sericnum`,b.`nowcheckname`'; if(isset($arr['fieldsleft']) && $arr['fieldsleft'])$arr['fields'].=','.$arr['fieldsleft'].''; if($arr['order']=='')$arr['order'] = 'a.`optdt` desc'; $temsao = 1; if($this->defaultorder){ $defa = explode(',', $this->defaultorder); $desc = arrvalue($defa, 1, 'desc'); $arr['order'] = 'a.`'.$defa[0].'` '.$desc.''; } } if(isempt($arr['order'])){ $arr['order'] = '{asqom}`id` desc'; if($this->defaultorder){ $defa = explode(',', $this->defaultorder); $desc = arrvalue($defa, 1, 'desc'); $arr['order'] = '{asqom}`'.$defa[0].'` '.$desc.''; } } if(isempt($fwhere) && isempt($inwhere) && $this->moders['isscl']==1){ $fwhere = 'and 1=2'; } $where = $inwhere; $wherestr = $this->moders['where']; if(!isempt($wherestr)){ $wherestr = $this->rock->covexec($wherestr); $where .= ' and {asqom}'.$wherestr; } if($fwhere!='')$where .= ' '.$fwhere; if($_wehs!='')$where .= ' '.$_wehs; $highwhere = $this->gethighwhere(); $allfields = array(); $key = $this->rock->post('key'); $pnum = $this->rock->post('pnum'); $status = $this->rock->post('keystatus'); $ztfields = arrvalue($nas, 'ztfields', 'status'); if(!isempt($status))$where .= ' and {asqom}`'.$ztfields.'`='.$status.''; if(!isempt($key) && isempt($arr['keywhere'])){ $check = c('check'); $allfields = $this->db->getallfields('[Q]'.$this->mtable.''); $_kearr = array(); if($check->isdate($key) || $check->ismonth($key)){ $skeay = array('date','datetime','month'); foreach($this->fieldsarra as $k=>$rs){ $flx = $rs['fieldstype']; $fid = $rs['fields']; if($rs['issou']==1 && in_array($flx, $skeay) && in_array($fid, $allfields)){ if($check->isdate($key)){ if($flx=='date')$_kearr[] = ""{asqom}`"".$fid.""`='$key'""; if($flx=='datetime')$_kearr[] = ""{asqom}`"".$fid.""` like '$key%'""; if($flx=='month')$_kearr[] = ""{asqom}`"".$fid.""`='"".substr($key,0,7).""'""; if($temsao==1){ $_kearr[] = ""b.`applydt`='$key'""; } } if($check->ismonth($key)){ if($flx=='month'){ $_kearr[] = ""{asqom}`"".$fid.""`='$key'""; }else{ $_kearr[] = ""{asqom}`"".$fid.""` like '$key%'""; } if($temsao==1){ $_kearr[] = ""b.`applydt` like '$key%'""; } } } } } if(!$_kearr){ $skeay = array('text','textarea','htmlediter','changeuser','changeusercheck','changedept','changedeptusercheck','selectdatafalse','selectdatatrue','num'); $xiakk = array('rockcombo','select'); foreach($this->fieldsarra as $k=>$rs){ if($rs['issou']==1 && in_array($rs['fields'], $allfields) && substr($rs['fields'],-2) != 'dt'){ if(in_array($rs['fieldstype'], $skeay))$_kearr[] = ""{asqom}`"".$rs['fields'].""` like '%"".$key.""%'""; } } if($temsao==1){ $_kearr[] = ""b.`uname` like '%"".$key.""%'""; $_kearr[] = ""b.`udeptname` like '%"".$key.""%'""; $_kearr[] = ""b.`sericnum` = '$key'""; $_kearr[] = ""b.`nowcheckname` = '$key'""; } if(isset($nas['orlikefields'])){ $owhee = explode(',', $nas['orlikefields']); foreach($owhee as $owhees){ $_owhees = explode('@', $owhees); $sle = arrvalue($_owhees, 1); if($sle=='1'){ $_kearr[] = """".$_owhees[0]."" ='$key'""; }else{ $_kearr[] = """".$_owhees[0]."" like '%"".$key.""%'""; } } } } if($_kearr && $arr['onlywhere']=='')$arr['keywhere'] = ""and ("".join($_kearr, ' or ')."")""; } if(!isempt($arr['companywhere']) && getconfig('companymode'))$where .= ' '.$arr['companywhere']; if(!isempt($arr['onlywhere']))$where .= ' '.$arr['onlywhere']; if(!isempt($arr['keywhere']))$where .= ' '.$arr['keywhere']; if($highwhere!='')$where .= ' '.$highwhere; $where = str_replace('{asqom}', $arr['asqom'], $where); $arr['order'] = str_replace('{asqom}', $arr['asqom'], $arr['order']); $where = str_replace('[A]', $arr['asqom'], $where); $fields = $arr['fields']; if($this->flowfieldstype==1 && (isempt($fields) || $fields=='*') && $this->moders['isscl']==1){ if(!$allfields)$allfields = $this->db->getallfields('[Q]'.$this->mtable.''); $fields = '{asqom}`id`'; $odlvs = $this->option->getval('columns_'.$this->modenum.'_'.$pnum.''); if(isempt($odlvs)){ foreach($this->fieldsarra as $k=>$rs){ if($rs['islb']==1 && in_array($rs['fields'],$allfields)){ $fields.=',{asqom}`'.$rs['fields'].'`'; } } }else{ $odlvsa = explode(',', $odlvs); foreach($odlvsa as $odlvs1){ if(in_array($odlvs1, $allfields)){ $fields.=',{asqom}`'.$odlvs1.'`'; } } } if($this->isflow>0){ if(!contain($fields,'`status`'))$fields.=',{asqom}`status`'; } $fields = str_replace('{asqom}', $arr['asqom'], $fields); $arr['fields'] = $fields; } $fields = $arr['fields']; if(!isempt($fields) && $fields!='*'){ $fieldsa = explode(',', $fields); $fieldss = ''; foreach($fieldsa as $fieldsas){ if(contain($fieldsas,'`') || contain($fieldsas,'.') || contain($fieldsas,' ') || contain($fieldsas,'(')){ $fieldss.=','.$fieldsas.''; }else{ $fieldss.=',`'.$fieldsas.'`'; } } $arr['fields'] = substr($fieldss, 1); } $arr['where'] = str_replace('{asqom}','', $where); return $arr; } public function gethighwhere() { $s = ''; return $s; } public function getflowwhere($uid, $num) { $where = ''; $rs = $this->wheremodel->getone(""`setid`='$this->modeid' and `num`='$num'""); if(!$rs)return $where; $where = $this->wheremodel->getwherestr($rs, $uid, $this->flowviewufieds); return $where; } public function getflowrows($uid, $lx, $limit=5, $swher='') { $nas = $this->billwhere($uid, $lx); $table = $nas['table']; if(!contain($table,' '))$table='[Q]'.$table.''; if(isempt($nas['fields']))$nas['fields'] = '*'; $swher = str_replace('{asqom}',$nas['asqom'], $swher); $where = '1=1 '.$nas['where'].' '.$swher.''; if($limit==0)return $this->db->rows($table, $where ); $rows = $this->db->getrows($table, $where , $nas['fields'], $nas['order'], $limit); foreach($rows as $k=>$rs){ $rows[$k] = $this->flowrsreplace($rs, 2); } return $rows; } public function gettodorows($whereid) { $where = $this->wheremodel->getwherestr($whereid, $this->adminid, $this->flowviewufieds); $wherestr = $this->moders['where']; if(!isempt($wherestr)){ $wherestr = $this->rock->covexec($wherestr); $where .= ' and '.$wherestr; } $where = str_replace('{asqom}','', $where); $rows = $this->getall('1=1 '.$where.''); foreach($rows as $k=>$rs){ $rows[$k] = $this->flowrsreplace($rs, 1); } return $rows; } public function printexecl($event) { $arr['moders'] = $this->moders; $arr['fields'] = $this->getfields(); $cell = 1; foreach($arr['fields'] as $k=>$v)$cell++; $arr['cell'] = $cell; $where = '1=1'; $str1 = $this->moders['where']; if(!isempt($str1)){ $str1 = $this->rock->covexec($str1); $where = $str1; } $vwhere = $this->viewmodel->viewwhere($this->moders, $this->adminid); $rows = $this->getrows(''.$where.' '.$vwhere.'', '*', 'id desc', 100); $arr['rows'] = $this->flowprintrows($rows); $arr['count'] = $this->db->count; return $arr; } public function getsuballdata($lx=0, $mid=0) { $tabless = $this->moders['tables']; $subdata = array(); if($mid==0)$mid = $this->id; if(!isempt($tabless)){ $tablessa = explode(',', $tabless); $namessa = explode(',', $this->moders['names']); $tabless1 = '['.str_replace(',','],[', $tabless).']'; foreach($tablessa as $zbx=>$tables){ $cis = substr_count($tabless1, '['.$tables.']'); $whes = ''; if($cis>1)$whes=' and `sslx`='.$zbx.''; $data = m($tables)->getall('mid='.$mid.''.$whes.'','*','`sort`'); $data = $this->flowsubdata($data, $lx, $zbx); if($lx == 0){ $subdata['subdata'.$zbx.''] = $data; }else{ $subdata[$zbx] = array( 'data' => $data, 'fields'=> 'subdata'.$zbx.'', 'name' => $this->rock->arrvalue($namessa, $zbx) ); } } } return $subdata; } private $gettodolistarr = null; public function gettodolist($act) { if(is_array($act))return $act; if($this->gettodolistarr === null){ $rows = $this->todomodel->getrows(""`setid`='"".$this->modeid.""' and `status`=1""); $barr = array(); foreach($rows as $k=>$rs){ $whereid = (int)$rs['whereid']; if($whereid > 0){ $bo = $this->wheremanzhu($whereid); if(!$bo)continue; } $barr[] = $rs; } $this->gettodolistarr = $barr; }else{ $barr = $this->gettodolistarr; } $garr = array(); if($barr)foreach($barr as $k=>$rs){ if(arrvalue($rs,$act)=='1')$garr[] = $rs; } return $garr; } public function gettodosend($act, $actname='',$sm='', $courseid=0, $conts='') { $barr = $this->gettodolist($act); if(!$barr)return; $changearr = array('boturn'=>'提交','boedit'=>'编辑','bozhuan'=>'转办','bochang'=>'修改字段','bodel'=>'删除','bozuofei'=>'作废','botong'=>'处理同意','bobutong'=>'处理不同意','bofinish'=>'全部处理完成','bozhui'=>'追加说明','boping'=>'评论','bohuiz'=>'回执确认'); if($actname=='' && is_string($act))$actname = arrvalue($changearr, $act); if(isempt($actname))return; $cheo = c('check'); foreach($barr as $k=>$rs){ $receid = $rs['receid']; if($act=='botong' || $act=='bobutong'){ $changewe = $rs['changecourse']; if(!isempt($changewe) && !contain(','.$changewe.',',','.$courseid.','))continue; } if($rs['toturn']==1)$receid.=','.$this->uid.''; if(arrvalue($rs,'tosuper')=='1'){ $supar = $this->adminmodel->getsuperman($this->uid); $shnej = arrvalue($supar, 0); if(!isempt($shnej))$receid.=','.$shnej.''; } if($rs['tocourse']==1 && $this->billrs){ $allcheckid = $this->billrs['allcheckid']; if(!isempt($allcheckid))$receid.=','.$allcheckid.''; } $todofields = $rs['todofields']; if(!isempt($todofields)){ $toad = explode(',', $todofields); foreach($toad as $toads){ $ttv = arrvalue($this->rs, $toads); if(!isempt($ttv) && $cheo->isinnumber($ttv))$receid.=','.$ttv.''; } } if(isempt($receid))continue; if(substr($receid,0,1)==',')$receid = substr($receid, 1); $cont = $rs['summary']; if(isempt($cont))$cont = $conts; if(isempt($cont)){ $cont = ''.$this->adminname.''.$actname.'['.$this->modename.',单号:'.$this->sericnum.']'; if($sm!='')$cont.=',说明:'.$sm.''; } $this->push($receid, '', $cont, $this->rock->repempt($rs['name'])); } } public function numtodosend($num, $actname='',$sm='') { $rows = $this->todomodel->getrows(""`setid`='"".$this->modeid.""' and `num`='$num' and `status`=1""); if(!$rows)return; $this->gettodosend($rows, $actname, $sm); } public function flowtotal($fields='', $type='') { if($fields=='')$fields = $this->rock->post('total_fields'); if($type=='')$type = $this->rock->post('total_type','jls'); $typea = explode('|', $type); $typefields = ''; $type = $typea[0]; $typefields = arrvalue($typea, 1); $rowa = array(); $rowa[] = array( 'name' => '暂无数据', 'value' => 0, 'bili' => '' ); $tofiels= 'count(1)'; if($type=='sum')$tofiels = 'sum([A]`'.$typefields.'`)'; if($type=='avg')$tofiels = 'avg([A]`'.$typefields.'`)'; $atype = $this->rock->post('atype'); $table = '[Q]'.$this->mtable.''; $narr = $this->billwhere($this->adminid, $atype); $where = $narr['where']; $table = $narr['table']; if(!contain($table,' '))$table = '[Q]'.$table.''; $gwhere = $this->rock->post('where'); if(!isempt($gwhere)){ $gwhere = $this->rock->jm->uncrypt($this->rock->iconvsql($gwhere)); $where .= ' '.$gwhere.''; } $sql = 'select '.$fields.' as `name`,'.$tofiels.' as value from '.$table.' where 1=1 '.$where.' group by '.$fields.''; $sql = str_replace('[A]', $narr['asqom'], $sql); $rows = $this->db->getall($sql); $total = 0; if($rows){ foreach($rows as $k=>$rs)$total+=floatval($rs['value']); if($total>0)foreach($rows as $k=>$rs){ $rows[$k]['bili'] = $this->rock->number($rs['value']*100/$total).'%'; } if($type!='avg' && count($rows)>1)$rows[] = array('name' => '合计','value' => $total,'bili' => ''); }else{ $rows = $rowa; } return $rows; } public function receiptcheck($hid, $sm) { return 'ok'; } public function getrowstable($atype, $where, $limit=100) { $rows = $this->getflowrows($this->adminid,$atype,$limit,$where); $headstr = '@xuhaos,,center'; foreach($this->fieldsarra as $k=>$rs){ if($rs['islb']==1 && $rs['iszb']=='0') $headstr.='@'.$rs['fields'].','.$rs['name'].''; } if($this->isflow>0){ $headstr.='@statustext,状态'; if(is_array($rows))foreach($rows as $k=>$rs){ $rows[$k]['statustext'] = $this->getstatusstr($rs); } } $cont = c('html')->createrows($rows, substr($headstr, 1),'#cccccc','noborder'); return $cont; } public function viewjinfields($rows) { if(!$rows)return $rows; return $rows; } public function daochusubtable($rows) { return $rows; } }"
829,file_get_contents,文件操作函数中存在变量，可能存在任意文件读取/删除/修改/写入等漏洞,D:\phpstudy_pro\WWW\cms\xinhu\webmain\model\txcloud\renlianModel.php,第29行,"			$chul['Image']  = base64_encode(file_get_contents($url));
"
830,unlink,文件操作函数中存在变量，可能存在任意文件读取/删除/修改/写入等漏洞,D:\phpstudy_pro\WWW\cms\xinhu\webmain\model\adminModel.php,第625行,"			if(!isempt($oface) && file_exists($oface))@unlink($oface);//删除原来头像
"
831,file_get_contents,文件操作函数中存在变量，可能存在任意文件读取/删除/修改/写入等漏洞,D:\phpstudy_pro\WWW\cms\xinhu\webmain\model\beifenModel.php,第45行,"			$cont = file_get_contents($path);
"
832,`$,``反引号中包含变量，变量可控会导致命令执行漏洞,D:\phpstudy_pro\WWW\cms\xinhu\webmain\model\beifenModel.php,第80行,"				$sql  = ""CREATE TABLE `$table`($str)ENGINE="".getconfig('db_engine','MyISAM')."" DEFAULT CHARSET=utf8"";
"
833,`$,``反引号中包含变量，变量可控会导致命令执行漏洞,D:\phpstudy_pro\WWW\cms\xinhu\webmain\model\beifenModel.php,第107行,"					$sql = ""alter table `$table` $str"";
"
834,extract,函数中存在变量，可能存在变量覆盖漏洞,D:\phpstudy_pro\WWW\cms\xinhu\webmain\model\emailModel.php,第125行,"		extract($arr);
"
835,extract,函数中存在变量，可能存在变量覆盖漏洞,D:\phpstudy_pro\WWW\cms\xinhu\webmain\model\emailModel.php,第202行,"		extract($sendarr);
"
836,unlink,文件操作函数中存在变量，可能存在任意文件读取/删除/修改/写入等漏洞,D:\phpstudy_pro\WWW\cms\xinhu\webmain\model\fileModel.php,第250行,"			if(!$this->isempt($path) && substr($path,0,4)!='http' && file_exists($path))unlink($path);
"
837,unlink,文件操作函数中存在变量，可能存在任意文件读取/删除/修改/写入等漏洞,D:\phpstudy_pro\WWW\cms\xinhu\webmain\model\fileModel.php,第250行,"			if(!$this->isempt($path) && substr($path,0,4)!='http' && file_exists($path))unlink($path);
"
838,unlink,文件操作函数中存在变量，可能存在任意文件读取/删除/修改/写入等漏洞,D:\phpstudy_pro\WWW\cms\xinhu\webmain\model\fileModel.php,第250行,"			if(!$this->isempt($path) && substr($path,0,4)!='http' && file_exists($path))unlink($path);
"
839,file_get_contents,文件操作函数中存在变量，可能存在任意文件读取/删除/修改/写入等漏洞,D:\phpstudy_pro\WWW\cms\xinhu\webmain\model\fileModel.php,第309行,"				$content	= file_get_contents($filepath);
"
840,file_get_contents,文件操作函数中存在变量，可能存在任意文件读取/删除/修改/写入等漏洞,D:\phpstudy_pro\WWW\cms\xinhu\webmain\model\fileModel.php,第320行,"					echo file_get_contents($filepath);
"
841,file_get_contents,文件操作函数中存在变量，可能存在任意文件读取/删除/修改/写入等漏洞,D:\phpstudy_pro\WWW\cms\xinhu\webmain\model\fileModel.php,第353行,"			$content	= file_get_contents($filepath);
"
842,`$,``反引号中包含变量，变量可控会导致命令执行漏洞,D:\phpstudy_pro\WWW\cms\xinhu\webmain\model\itemsModel.php,第13行,"			$fields	= ""`$fields`"";
"
843,file_get_contents,文件操作函数中存在变量，可能存在任意文件读取/删除/修改/写入等漏洞,D:\phpstudy_pro\WWW\cms\xinhu\webmain\model\kqjcmdModel.php,第126行,"					'advert'=> base64_encode(file_get_contents($path))
"
844,`$,``反引号中包含变量，变量可控会导致命令执行漏洞,D:\phpstudy_pro\WWW\cms\xinhu\webmain\model\kqjcmdModel.php,第541行,"		$this->snobj->update(""`$fields`='$ids'"", $snid);
"
845,`$,``反引号中包含变量，变量可控会导致命令执行漏洞,D:\phpstudy_pro\WWW\cms\xinhu\webmain\model\kqjcmdModel.php,第541行,"		$this->snobj->update(""`$fields`='$ids'"", $snid);
"
846,file_get_contents,文件操作函数中存在变量，可能存在任意文件读取/删除/修改/写入等漏洞,D:\phpstudy_pro\WWW\cms\xinhu\webmain\model\kqjcmdModel.php,第689行,"				$data['headpic']= base64_encode(file_get_contents($face));
"
847,file_get_contents,文件操作函数中存在变量，可能存在任意文件读取/删除/修改/写入等漏洞,D:\phpstudy_pro\WWW\cms\xinhu\webmain\model\modeModel.php,第89行,"		$oldcont 	= @file_get_contents($path);
"
848,unlink,文件操作函数中存在变量，可能存在任意文件读取/删除/修改/写入等漏洞,D:\phpstudy_pro\WWW\cms\xinhu\webmain\model\taskModel.php,第215行,"		@unlink($this->tasklistpath());
"
849,file_get_contents,文件操作函数中存在变量，可能存在任意文件读取/删除/修改/写入等漏洞,D:\phpstudy_pro\WWW\cms\xinhu\webmain\model\taskModel.php,第308行,"			if(contain($lastdt, $dt) && contain($editdt, $dt))$fstr	= @file_get_contents($fpath);
"
850,`$,``反引号中包含变量，变量可控会导致命令执行漏洞,D:\phpstudy_pro\WWW\cms\xinhu\webmain\model\viewModel.php,第121行,"				$sw = ""`$ufid` in(select `id` from `[Q]admin` where instr(`superpath`,'[$uid]')>0)"";
"
851,`$,``反引号中包含变量，变量可控会导致命令执行漏洞,D:\phpstudy_pro\WWW\cms\xinhu\webmain\model\viewModel.php,第126行,"				$sw = ""`$ufid` in(select `id` from `[Q]admin` where $sw1)"";
"
852,`$,``反引号中包含变量，变量可控会导致命令执行漏洞,D:\phpstudy_pro\WWW\cms\xinhu\webmain\model\viewModel.php,第130行,"				$sw = ""`$ufid` in(select `id` from `[Q]admin` where `deptid`="".$this->urs['deptid']."")"";
"
853,`$,``反引号中包含变量，变量可控会导致命令执行漏洞,D:\phpstudy_pro\WWW\cms\xinhu\webmain\model\viewModel.php,第135行,"				$sw = ""`$ufid` in(select `id` from `[Q]admin` where instr(`deptpath`,'["".$this->urs['deptid'].""]')>0)"";
"
854,`$,``反引号中包含变量，变量可控会导致命令执行漏洞,D:\phpstudy_pro\WWW\cms\xinhu\webmain\model\viewModel.php,第140行,"				$sw = ""`$ufid` in(select `id` from `[Q]admin` where `companyid`="".$companyid."")"";
"
855,file_get_contents,文件操作函数中存在变量，可能存在任意文件读取/删除/修改/写入等漏洞,D:\phpstudy_pro\WWW\cms\xinhu\webmain\public\publicAction.php,第40行,"			$content  = file_get_contents($filepath);
"
856,`$,``反引号中包含变量，变量可控会导致命令执行漏洞,D:\phpstudy_pro\WWW\cms\xinhu\webmain\system\admin\adminAction.php,第44行,"		if(contain($fields, $fid))m('userinfo')->update(""`$fid`='$val'"", $id);
"
857,`$,``反引号中包含变量，变量可控会导致命令执行漏洞,D:\phpstudy_pro\WWW\cms\xinhu\webmain\system\beifen\beifenAction.php,第18行,"				$sql1 = ""delete from `$_tabs`"";
"
858,`$,``反引号中包含变量，变量可控会导致命令执行漏洞,D:\phpstudy_pro\WWW\cms\xinhu\webmain\system\beifen\beifenAction.php,第19行,"				$sql2 = ""alter table `$_tabs` AUTO_INCREMENT=1"";
"
859,`$,``反引号中包含变量，变量可控会导致命令执行漏洞,D:\phpstudy_pro\WWW\cms\xinhu\webmain\system\beifen\beifenAction.php,第135行,"			$sql1 	= ""delete from `$tab`"";
"
860,`$,``反引号中包含变量，变量可控会导致命令执行漏洞,D:\phpstudy_pro\WWW\cms\xinhu\webmain\system\beifen\beifenAction.php,第136行,"			$sql2 	= ""alter table `$tab` AUTO_INCREMENT=1"";
"
861,`$,``反引号中包含变量，变量可控会导致命令执行漏洞,D:\phpstudy_pro\WWW\cms\xinhu\webmain\system\beifen\beifenAction.php,第187行,"					$sql1 	= ""delete from `$tab`"";
"
862,`$,``反引号中包含变量，变量可控会导致命令执行漏洞,D:\phpstudy_pro\WWW\cms\xinhu\webmain\system\beifen\beifenAction.php,第188行,"					$sql2 	= ""alter table `$tab` AUTO_INCREMENT=1"";
"
863,require,"文件包含函数中存在变量,可能存在文件包含漏洞",D:\phpstudy_pro\WWW\cms\xinhu\webmain\system\cog\cogAction.php,第124行,"		$arr 			= require($_confpath);
"
864,file_put_contents,文件操作函数中存在变量，可能存在任意文件读取/删除/修改/写入等漏洞,D:\phpstudy_pro\WWW\cms\xinhu\webmain\system\cog\cogAction.php,第230行,"		@$bo = file_put_contents($_confpath, $str);
"
865,require,"文件包含函数中存在变量,可能存在文件包含漏洞",D:\phpstudy_pro\WWW\cms\xinhu\webmain\system\cog\cogAction.php,第274行,"		$da 	= require($path);
"
866,unlink,文件操作函数中存在变量，可能存在任意文件读取/删除/修改/写入等漏洞,D:\phpstudy_pro\WWW\cms\xinhu\webmain\system\cog\cogAction.php,第277行,"			@unlink($path);
"
867,`$,``反引号中包含变量，变量可控会导致命令执行漏洞,D:\phpstudy_pro\WWW\cms\xinhu\webmain\system\extent\extentAction.php,第55行,"			$this->db->insert($this->T('sjoin'),'`type`,`mid`,`sid`,`indate`',""select '$type','$mid',`id`,'$this->now' from `$ntable` where `id` in($checkaid)"",true);
"
868,`$,``反引号中包含变量，变量可控会导致命令执行漏洞,D:\phpstudy_pro\WWW\cms\xinhu\webmain\system\table\tableAction.php,第27行,"		$sql 	= ""ALTER TABLE `$id` COMMENT '$value';"";
"
869,`$,``反引号中包含变量，变量可控会导致命令执行漏洞,D:\phpstudy_pro\WWW\cms\xinhu\webmain\system\table\tableAction.php,第55行,"		$sql 	= ""ALTER TABLE `$table`"";
"
870,`$,``反引号中包含变量，变量可控会导致命令执行漏洞,D:\phpstudy_pro\WWW\cms\xinhu\webmain\system\table\tableAction.php,第61行,"		$sql.="" `$name`"";
"
871,`$,``反引号中包含变量，变量可控会导致命令执行漏洞,D:\phpstudy_pro\WWW\cms\xinhu\webmain\system\table\tableAction.php,第86行,"		$sql 	= ""ALTER table `$table` DROP COLUMN `$id`;"";
"
872,file_put_contents,文件操作函数中存在变量，可能存在任意文件读取/删除/修改/写入等漏洞,D:\phpstudy_pro\WWW\cms\xinhu\webmain\system\upgrade\upgradeAction.php,第8行,"class upgradeClassAction extends Action { public function initAction() { $this->keyss = $this->option->getval('systemnum'); if(isempt($this->keyss)){ $rnd = md5(str_shuffle('abcedfghijk').rand(1000,9999)); $this->option->setval('systemnum', $rnd); $this->keyss = $rnd; } } public function dataAjax() { $xinhu = c('xinhu'); $db = m('chargems'); $wet = $xinhu->getwebsite(); $barr = $xinhu->getdata('mode',array('sysnum'=>$this->keyss)); if($barr['code']!=200)exit($barr['msg']); $rows = array(); $wodekey= $this->jm->getRandkey(); foreach($barr['data'] as $k=>$rs){ $id = $rs['id']; $state = 0; $key = ''; $ors = $db->getone(""`type`=0 and `mid`='$id'""); if($ors){ $state = 1; if($rs['updatedt']>$ors['updatedt'])$state=2; $key= $ors['key']; } $view = '<a href=""'.$wet.'view_'.$rs['num'].'.html"" target=""_blank"" class=""a"">介绍</a>'; if($state==0 && $rs['price']>0)$view.=',<a href=""'.$wet.'view_'.$rs['num'].'.html"" target=""_blank"" style=""color:red"">去购买</a>'; $rows[] = array( 'id' => $id, 'name' => $rs['name'], 'price' => $rs['price'], 'isaz' => $rs['isaz'], 'explain' => $rs['explain'], 'updatedt' => $rs['updatedt'], 'key' => $key, 'view' => $view, 'opt' => $state ); if($k==0)$wodekey = $rs['wodekey']; } $arr['rows'] = $rows; $arr['wodekey'] = $wodekey; $this->returnjson($arr); } public function shengjianAjax() { $id = $this->post('id'); $key = $this->post('key'); if(!isempt($key) && $this->rock->isjm($key))$key = $this->jm->uncrypt($key); $barr = c('xinhu')->getdata('getinstallfile',array('id'=>$id,'sysnum'=>$this->keyss,'key'=>$key)); if($barr['code']!=200)showreturn('',$barr['msg'],201); $data = $barr['data']; $mrs = $data['rs']; $rows = $data['rows']; $uparr = array(); $huira = $this->gethuiarr($id); $morrs = $this->getmodeuprs($rows); foreach($rows as $k=>$rs){ $file = $rs['filepath']; $bo = true; if(file_exists($file)){ $_size = filesize($file); if($_size == $rs['filesize'])$bo = false; } if($rs['isup']==1)$bo = true; if(isset($huira[$rs['id']]))$bo = false; if(in_array($file, $morrs))$bo = false; if($bo){ $uparr[] = $rs; } } if(!$uparr){ $this->upsueecc($id, $mrs['updatedt'], $key); } showreturn($uparr); } private function upsueecc($id, $updatedt, $key) { $where = ""`type`=0 and `mid`='$id'""; $db = m('chargems'); if($db->rows($where)==0)$where=''; $db->record(array( 'type' => 0, 'mid' => $id, 'modeid' => $id, 'updatedt' => $updatedt, 'optdt' => $this->now, 'key' => $this->jm->encrypt($key) ),$where); } private function upsueeccmids($modeid, $mid, $updatedt, $type=1) { $where = ""`type`='$type' and `mid`='$mid'""; $db = m('chargems'); if($db->rows($where)==0)$where=''; $db->record(array( 'type' => $type, 'mid' => $mid, 'modeid' => $modeid, 'updatedt' => $updatedt, 'optdt' => $this->now, ),$where); } private function getmodeuprs($frows) { $rows = m('flow_set')->getall('1=1', '`num`,`status`,`isup`'); $hurs = array(); $nomok= array(); $huwj = getconfig('noupgrademode'); if($huwj)$nomok = explode(',', $huwj); foreach($rows as $k=>$rs){ $num = $rs['num']; if($rs['isup']=='0'){ $nomok[]= $num; } } foreach($nomok as $num){ $hurs[] = ''.P.'/flow/input/inputjs/mode_'.$num.'.js'; $hurs[] = ''.P.'/flow/input/mode_'.$num.'Action.php'; $hurs[] = ''.P.'/flow/page/input_'.$num.'.html'; $hurs[] = ''.P.'/flow/page/view_'.$num.'_0.html'; $hurs[] = ''.P.'/flow/page/view_'.$num.'_1.html'; $hurs[] = ''.P.'/flow/page/view_'.$num.'_2.html'; $hurs[] = ''.P.'/flow/page/viewpage_'.$num.'.html'; $hurs[] = ''.P.'/flow/page/viewpage_'.$num.'_0.html'; $hurs[] = ''.P.'/flow/page/viewpage_'.$num.'_1.html'; $hurs[] = ''.P.'/flow/page/rock_page_'.$num.'.php'; $hurs[] = ''.P.'/model/flow/'.$num.'Model.php'; } return $hurs; } public function shengjianssAjax() { $mid = (int)$this->post('id'); $fileid = (int)$this->post('fileid'); $key = $this->post('key'); if(!isempt($key) && $this->rock->isjm($key))$key = $this->jm->uncrypt($key); $oi = $this->post('oii'); $len = $this->post('lens'); $updatedt = $this->post('updatedt'); $upbo = true; $ors = m('chargems')->getone(""`type`=1 and `mid`='$fileid'""); if($ors && $updatedt<=$ors['optdt'])$upbo = false; if(isempt($updatedt))$upbo = true; if($upbo){ $barr = c('xinhu')->getdata('getinstallfileid',array('fid'=>$fileid,'sysnum'=>$this->keyss,'key'=>$key,'ban'=>$this->post('ban'))); if($barr['code'] != 200)exit($barr['msg']); $data = $barr['data']; $type = $data['type']; $filepath = $data['filepath']; $fcont = $this->jm->base64decode($data['content']); if($fcont != ''){ if($type==1){ $bmsg = m('beifen')->updatefabric($fcont); if($bmsg != 'ok')exit($bmsg); $this->upsueeccmids($mid, $fileid, $updatedt, 1); } if($type==9){ $this->rock->createdir($filepath); $this->beifenfile($filepath); @$bo = file_put_contents($filepath, $fcont); if(!$bo)exit('无法写入：'.$filepath.''); } if($type==10){ $this->rock->createdir($filepath); @file_put_contents($filepath, $fcont); $sbo = $this->db->query($fcont); } } $udt = $data['updatedt']; }else{ $udt = $this->now; } if($oi+1 == $len){ $this->upsueecc($mid, $udt, $key); } echo 'ok'; } private function beifenfile($path) { if(!file_exists($path))return; $wz = strripos($path, '/'); $dir = ''; if($wz===false){ $file = $path; }else{ $dir = substr($path, 0, $wz); $file = substr($path, $wz+1); } $dir = str_replace('/','-', $dir); $nfile = ''.$dir.''.date('YmdHis').'@'.$file.''; $topath = ''.UPDIR.'/logs/'.date('Y-m').'/'.$nfile.''; $this->rock->createdir($topath); @copy($path, $topath); } private function shengjifile($frs, $key, $modeid) { $fid = $frs['id']; $where = ""`type`=1 and `mid`='$fid'""; $db = m('chargems'); $ors = $db->getone($where); if($ors){ if($frs['updatedt']<=$ors['optdt'])return; }else{ $where = ''; } $barr = c('xinhu')->getdata('getfileinstall',array('id'=>$fid,'sysnum'=>$this->keyss,'key'=>$key)); if($barr['code']!=200)exit($barr['msg']); $fcont = $this->jm->base64decode($barr['data']); if(isempt($fcont))return; $mkdir = ''.UPDIR.'/'.date('Y-m'); if($frs['type']==0){ if(!is_dir($mkdir))mkdir($mkdir); $filemy = $mkdir.'/install'.time().rand(1000,9999).'.zip'; file_put_contents($filemy, $fcont); $bmsg = c('zip')->unzip($filemy,'./'); unlink($filemy); if($bmsg != 'ok')exit($bmsg); } if($frs['type']==1){ $bmsg = m('beifen')->updatefabric($fcont); if($bmsg != 'ok')exit($bmsg); } $db->record(array( 'type' => 1, 'mid' => $fid, 'modeid' => $modeid, 'updatedt' => $frs['updatedt'], 'optdt' => $this->now, ),$where); } public function tontbudataAjax() { $lx = (int)$this->get('lx'); $snum = $this->get('snum'); $barr = c('xinhu')->getdata('getaneydata', array('lx'=>$lx,'snum'=>$snum,'ban'=>$this->post('ban'))); if($barr['code']!=200)exit($barr['msg']); $data = $barr['data']; if(URL=='http://127.0.0.1/app/xinhu/')exit('本地测试完成'); $msgr = ''; if($lx==0)$this->tonbbumenu($data['menu']); if($lx==1)$msgr=$this->tonbbumode($data['mode']); if($lx==4)$this->tonbbumodewq($data['mode']); if($lx==2)$this->tonbbuying($data['yydata']); if($lx==3)$this->tonbbutask($data['task']); if($lx==5)$msgr=$this->tonbbumode($data['mode'],$snum); echo '同步完成'.$msgr.''; } private function tonbbumenu($data) { $db = m('menu'); $caid = '0'; foreach($data as $k=>$rs){ $id = $rs['id']; if($db->rows('id='.$id.'')>0){ unset($rs['status']); unset($rs['ispir']); unset($rs['ishs']); if(isempt($rs['num']))unset($rs['num']); if(isempt($rs['color']))unset($rs['color']); if(isempt($rs['icons']))unset($rs['icons']); $db->update($rs, 'id='.$id.''); }else{ $db->insert($rs); } $caid.=','.$id.''; } $db->update('status=0','id not in('.$caid.')'); } private function tonbbumenuss($data, $pid,$npid, $db){ foreach($data as $k=>$rs){ if($rs['pid']==$pid){ $name = $rs['name']; $id = $rs['id']; $where1 = "" and `name`='$name'""; if(!isempt($rs['url']))$where1 = "" and (`name`='$name' or `url`='"".$rs['url'].""')""; $where = ""`pid`='$npid' $where1""; $yid = (int)$db->getmou('id', $where); unset($rs['id']); $rs['optdt'] = $this->rock->now; if($yid==0){ $rs['pid']= $npid; $this->addci++; $yid= $db->insert($rs); }else{ $this->eddci++; unset($rs['status']); unset($rs['ispir']); unset($rs['ishs']); if(isempt($rs['num']))unset($rs['num']); if(isempt($rs['color']))unset($rs['color']); if(isempt($rs['icons']))unset($rs['icons']); $db->update($rs, $yid); } $npid1 = $yid; $this->tonbbumenuss($data, $id, $npid1, $db); } } } private function tonbbumode($data, $snum='') { $zcis = 0; $db = m('flow_set'); $db1 = m('flow_element'); $db2 = m('flow_menu'); $db3 = m('flow_extent'); $db5 = m('flow_course'); $db6 = m('flow_where'); $db7 = m('flow_todo'); $iszdbo = false; if(!isempt($snum))$iszdbo= true; foreach($data as $num=>$arr){ if($iszdbo && $num!=$snum)continue; $moders = $db->getone(""`num`='$num'"",'`id`,`isup`,`name`'); $modeid = 0; $isup = 1; if($moders){ $modeid = (int)$moders['id']; $isup = (int)$moders['isup']; if($isup==0){ if($num==$snum)exit('此['.$snum.'.'.$moders['name'].']模块未开启同步更新'); continue; } } $flow_set = $arr['flow_set']; if(isset($flow_set['id']))unset($flow_set['id']); $isadd = false; if($modeid==0){ $modeid = $db->insert($flow_set); $isadd = true; }else{ if($iszdbo){ unset($flow_set['name']); unset($flow_set['pctx']); unset($flow_set['mctx']); unset($flow_set['wxtx']); unset($flow_set['emtx']); unset($flow_set['receid']); unset($flow_set['recename']); unset($flow_set['status']); $db->update($flow_set, $modeid); }else{ $db->update(array( 'where' => $flow_set['where'], 'sort' => $flow_set['sort'], 'type' => $flow_set['type'], 'summary' => $flow_set['summary'], 'summarx' => $flow_set['summarx'], 'tables' => $flow_set['tables'], 'names' => $flow_set['names'], 'isscl' => $flow_set['isscl'], 'statusstr' => $flow_set['statusstr'] ), $modeid); } } $flow_where = $arr['flow_where']; $sid6 = '0'; foreach($flow_where as $k6=>$rs6){ $rs6['setid'] = $modeid; if(isset($rs6['id']))unset($rs6['id']); $num = $rs6['num']; if(isempt($num))continue; $where = ""`setid`='$modeid' and `num`='$num'""; if($db6->rows($where)==0){ $db6->insert($rs6); }else{ $db6->update($rs6, $where); } } $flow_element= $arr['flow_element']; $sid1s = '0'; foreach($flow_element as $k1=>$rs1){ $rs1['mid'] = $modeid; if(isset($rs1['id']))unset($rs1['id']); $where = ""`mid`='$modeid' and `fields`='"".$rs1['fields'].""' and `iszb`='"".$rs1['iszb'].""'""; if($db1->rows($where)==0){ $sid1 = $db1->insert($rs1); }else{ unset($rs1['name']); $db1->update($rs1, $where); $sid1 = $db1->getmou('id', $where); } $sid1s.=','.$sid1.''; } if($iszdbo){ $db1->delete(""`mid`='$modeid' and `id` not in($sid1s)""); } $flow_extent= $arr['flow_extent']; foreach($flow_extent as $k3=>$rs3){ $rs3['modeid'] = $modeid; $sid = $rs3['id']; if($db3->rows('id='.$sid.'')>0){ $db3->update($rs3, 'id='.$sid.''); }else{ $db3->insert($rs3); } } $flow_menu= $arr['flow_menu']; if($flow_menu){ $sids = '0'; foreach($flow_menu as $k2=>$rs2){ $rs2['setid'] = $modeid; $sid = $rs2['id']; if($db2->rows('id='.$sid.'')>0){ $sids.=','.$sid.''; $db2->update($rs2, 'id='.$sid.''); }else{ $db2->insert($rs2); $sids.=','.$this->db->insert_id().''; } } $db2->delete(""`setid`='$modeid' and `id` not in($sids)""); } if(isset($arr['flow_course'])){ if($db5->rows('setid='.$modeid.'')==0){ $flow_course = $arr['flow_course']; foreach($flow_course as $k5=>$rs5){ if(isset($rs5['id']))unset($rs5['id']); $rs5['setid'] = $modeid; $db5->insert($rs5); } } } if(isset($arr['flow_todo'])){ $flow_todo = $arr['flow_todo']; $sids7 = '0'; foreach($flow_todo as $k7=>$rs7){ if(isset($rs7['id']))unset($rs7['id']); $rs7['setid'] = $modeid; $where = ""`setid`='$modeid' and `name`='"".$rs7['name'].""'""; if($db7->rows($where)==0){ $sid7 = $db7->insert($rs7); }else{ $db7->update($rs7, $where); $sid7 = $db7->getmou('id', $where); } $sids7.=','.$sid7.''; } } $zcis++; } return '共'.$zcis.'个模块'; } private function tonbbumodewq($data) { $db = m('flow_set'); $this->initstalltable('flow_set'); $this->initstalltable('flow_element'); $this->initstalltable('flow_menu'); $this->initstalltable('flow_extent'); $this->initstalltable('flow_course'); $this->initstalltable('flow_where'); $this->initstalltable('flow_todo'); foreach($data as $num=>$arr){ $flow_set = $arr['flow_set']; $flow_element = $arr['flow_element']; $flow_menu = $arr['flow_menu']; $flow_extent = $arr['flow_extent']; $flow_course = $arr['flow_course']; $flow_where = $arr['flow_where']; $flow_todo = $arr['flow_todo']; $db->insert($flow_set); $this->insertdata($flow_element, 'flow_element'); $this->insertdata($flow_menu, 'flow_menu'); $this->insertdata($flow_extent, 'flow_extent'); $this->insertdata($flow_course, 'flow_course'); $this->insertdata($flow_where, 'flow_where'); $this->insertdata($flow_todo, 'flow_todo'); } } private function initstalltable($table) { $sql1 = ""delete from `[Q]"".$table.""`""; $sql2 = ""alter table `[Q]"".$table.""` AUTO_INCREMENT=1""; $this->db->query($sql1, false); $this->db->query($sql2, false); } private function insertdata($data, $table) { $db = m($table); if($data)foreach($data as $k=>$rs){ $db->insert($rs); } } private function tonbbuying($data) { $db = m('im_group'); $dbs = m('im_menu'); foreach($data as $k=>$yydata){ $rs = $yydata['data']; $menu = $yydata['menu']; $name = $rs['name']; unset($rs['id']); $where = ""`name`='$name' and `type`=2""; if(!isempt($rs['num']))$where = ""`num`='"".$rs['num'].""' and `type`=2""; if($db->rows($where)==0){ $mid = $db->insert($rs); $this->addyymenu($menu, $dbs, $mid, 0); }else{ $mid = (int)$db->getmou('id', $where); $db->update(array( 'face' => $rs['face'], 'url' => $rs['url'], 'types' => $rs['types'], 'sort' => $rs['sort'], 'urlpc' => $rs['urlpc'], 'urlm' => $rs['urlm'], 'yylx' => $rs['yylx'], 'name' => $rs['name'], 'iconfont' => $rs['iconfont'], 'iconcolor' => $rs['iconcolor'], 'explain' => $rs['explain'], ),$where); $this->addyymenu($menu, $dbs, $mid, 0); } } } private function addyymenu($menu, $dbs, $mid, $pid) { $ssid = '0'; foreach($menu as $k1=>$rs1){ unset($rs1['id']); $menusub = false; if(isset($rs1['menusub'])){ $menusub = $rs1['menusub']; unset($rs1['menusub']); } $rs1['mid'] = $mid; $rs1['pid'] = $pid; $where = ""`name`='"".$rs1['name'].""' and `pid`='$pid' and `mid`='$mid'""; $sid = (int)$dbs->getmou('id', $where); if($sid == 0){ $where = ''; } $dbs->record($rs1, $where); if($sid==0)$sid = $this->db->insert_id(); if($menusub)$this->addyymenu($menusub, $dbs, $mid, $sid); $ssid .= ','.$sid.''; } $dbs->delete(""pid='$pid' and `mid`='$mid' and `id` not in($ssid)""); } private function tonbbutask($data) { $db = m('task'); foreach($data as $k=>$rs){ $where = ""`url`='"".$rs['url'].""'""; $sid = (int)$db->getmou('id', $where); if($sid == 0){ $where = ''; }else{ unset($rs['todoid']); unset($rs['todoname']); } unset($rs['id']); unset($rs['state']); unset($rs['lastdt']); $db->record($rs, $where); } } public function delmodelAjax() { $id = (int)$this->post('id'); m('chargems')->delete(""`modeid`='$id' and `type`<>2 and `modeid`>0""); $this->showreturn(''); } public function datadubiAjax() { $id = (int)$this->get('id'); $barr = c('xinhu')->getdata('getinstallfile',array('id'=>$id,'sysnum'=>$this->keyss)); if($barr['code']!=200)showreturn('',$barr['msg'],201); $data = $barr['data']; $mrs = $data['rs']; $rows = $data['rows']; $uparr = array(); $morrs = $this->getmodeuprs($rows); foreach($rows as $k=>$rs){ $file = $rs['filepath']; $bo = true; $zt = 'add'; if(file_exists($file)){ $_size = filesize($file); if($_size == $rs['filesize'])$bo = false; $zt = 'edit'; } if($rs['type']==1)$zt = ''; if($rs['isup']==1)$bo = true; $rs['ting'] = 0; if(in_array($file, $morrs))$rs['ting'] = 1; if($bo){ $rs['zt']= $zt; $uparr[] = $rs; } } $huira = $this->gethuiarr($id); $sarr1 = $sarr2 = array(); $strh = ''; foreach($uparr as $k=>$rs1){ $ishui = 0; if(isset($huira[$rs1['id']]))$ishui = 1; if($rs1['ting']==1)$ishui=1; $uparr[$k]['ishui'] = $ishui; if($ishui==1){ $sarr2[] = $uparr[$k]; }else{ $sarr1[] = $uparr[$k]; } } $this->returnjson(array('strh'=>$strh,'rows'=>array_merge($sarr1, $sarr2))); } private function gethuiarr($id) { $hurs = m('chargems')->getall(""`modeid`='$id' and `type`=2"",'mid'); $huira = array(); foreach($hurs as $k2=>$rs2)$huira[$rs2['mid']] = 1; return $huira; } public function hullueAjax() { $id = (int)$this->post('id'); $lx = (int)$this->post('lx'); $sid = $this->post('sid'); $db = m('chargems'); $db->delete(""`modeid`='$id' and `mid` in($sid) and `type`=2""); $sad = explode(',', $sid); if($lx==0)foreach($sad as $sids){ $db->insert(array( 'optdt' => $this->now, 'type' => 2, 'mid' => $sids, 'modeid' => $id )); } echo 'ok'; } }"
873,unlink,文件操作函数中存在变量，可能存在任意文件读取/删除/修改/写入等漏洞,D:\phpstudy_pro\WWW\cms\xinhu\webmain\system\upgrade\upgradeAction.php,第8行,"class upgradeClassAction extends Action { public function initAction() { $this->keyss = $this->option->getval('systemnum'); if(isempt($this->keyss)){ $rnd = md5(str_shuffle('abcedfghijk').rand(1000,9999)); $this->option->setval('systemnum', $rnd); $this->keyss = $rnd; } } public function dataAjax() { $xinhu = c('xinhu'); $db = m('chargems'); $wet = $xinhu->getwebsite(); $barr = $xinhu->getdata('mode',array('sysnum'=>$this->keyss)); if($barr['code']!=200)exit($barr['msg']); $rows = array(); $wodekey= $this->jm->getRandkey(); foreach($barr['data'] as $k=>$rs){ $id = $rs['id']; $state = 0; $key = ''; $ors = $db->getone(""`type`=0 and `mid`='$id'""); if($ors){ $state = 1; if($rs['updatedt']>$ors['updatedt'])$state=2; $key= $ors['key']; } $view = '<a href=""'.$wet.'view_'.$rs['num'].'.html"" target=""_blank"" class=""a"">介绍</a>'; if($state==0 && $rs['price']>0)$view.=',<a href=""'.$wet.'view_'.$rs['num'].'.html"" target=""_blank"" style=""color:red"">去购买</a>'; $rows[] = array( 'id' => $id, 'name' => $rs['name'], 'price' => $rs['price'], 'isaz' => $rs['isaz'], 'explain' => $rs['explain'], 'updatedt' => $rs['updatedt'], 'key' => $key, 'view' => $view, 'opt' => $state ); if($k==0)$wodekey = $rs['wodekey']; } $arr['rows'] = $rows; $arr['wodekey'] = $wodekey; $this->returnjson($arr); } public function shengjianAjax() { $id = $this->post('id'); $key = $this->post('key'); if(!isempt($key) && $this->rock->isjm($key))$key = $this->jm->uncrypt($key); $barr = c('xinhu')->getdata('getinstallfile',array('id'=>$id,'sysnum'=>$this->keyss,'key'=>$key)); if($barr['code']!=200)showreturn('',$barr['msg'],201); $data = $barr['data']; $mrs = $data['rs']; $rows = $data['rows']; $uparr = array(); $huira = $this->gethuiarr($id); $morrs = $this->getmodeuprs($rows); foreach($rows as $k=>$rs){ $file = $rs['filepath']; $bo = true; if(file_exists($file)){ $_size = filesize($file); if($_size == $rs['filesize'])$bo = false; } if($rs['isup']==1)$bo = true; if(isset($huira[$rs['id']]))$bo = false; if(in_array($file, $morrs))$bo = false; if($bo){ $uparr[] = $rs; } } if(!$uparr){ $this->upsueecc($id, $mrs['updatedt'], $key); } showreturn($uparr); } private function upsueecc($id, $updatedt, $key) { $where = ""`type`=0 and `mid`='$id'""; $db = m('chargems'); if($db->rows($where)==0)$where=''; $db->record(array( 'type' => 0, 'mid' => $id, 'modeid' => $id, 'updatedt' => $updatedt, 'optdt' => $this->now, 'key' => $this->jm->encrypt($key) ),$where); } private function upsueeccmids($modeid, $mid, $updatedt, $type=1) { $where = ""`type`='$type' and `mid`='$mid'""; $db = m('chargems'); if($db->rows($where)==0)$where=''; $db->record(array( 'type' => $type, 'mid' => $mid, 'modeid' => $modeid, 'updatedt' => $updatedt, 'optdt' => $this->now, ),$where); } private function getmodeuprs($frows) { $rows = m('flow_set')->getall('1=1', '`num`,`status`,`isup`'); $hurs = array(); $nomok= array(); $huwj = getconfig('noupgrademode'); if($huwj)$nomok = explode(',', $huwj); foreach($rows as $k=>$rs){ $num = $rs['num']; if($rs['isup']=='0'){ $nomok[]= $num; } } foreach($nomok as $num){ $hurs[] = ''.P.'/flow/input/inputjs/mode_'.$num.'.js'; $hurs[] = ''.P.'/flow/input/mode_'.$num.'Action.php'; $hurs[] = ''.P.'/flow/page/input_'.$num.'.html'; $hurs[] = ''.P.'/flow/page/view_'.$num.'_0.html'; $hurs[] = ''.P.'/flow/page/view_'.$num.'_1.html'; $hurs[] = ''.P.'/flow/page/view_'.$num.'_2.html'; $hurs[] = ''.P.'/flow/page/viewpage_'.$num.'.html'; $hurs[] = ''.P.'/flow/page/viewpage_'.$num.'_0.html'; $hurs[] = ''.P.'/flow/page/viewpage_'.$num.'_1.html'; $hurs[] = ''.P.'/flow/page/rock_page_'.$num.'.php'; $hurs[] = ''.P.'/model/flow/'.$num.'Model.php'; } return $hurs; } public function shengjianssAjax() { $mid = (int)$this->post('id'); $fileid = (int)$this->post('fileid'); $key = $this->post('key'); if(!isempt($key) && $this->rock->isjm($key))$key = $this->jm->uncrypt($key); $oi = $this->post('oii'); $len = $this->post('lens'); $updatedt = $this->post('updatedt'); $upbo = true; $ors = m('chargems')->getone(""`type`=1 and `mid`='$fileid'""); if($ors && $updatedt<=$ors['optdt'])$upbo = false; if(isempt($updatedt))$upbo = true; if($upbo){ $barr = c('xinhu')->getdata('getinstallfileid',array('fid'=>$fileid,'sysnum'=>$this->keyss,'key'=>$key,'ban'=>$this->post('ban'))); if($barr['code'] != 200)exit($barr['msg']); $data = $barr['data']; $type = $data['type']; $filepath = $data['filepath']; $fcont = $this->jm->base64decode($data['content']); if($fcont != ''){ if($type==1){ $bmsg = m('beifen')->updatefabric($fcont); if($bmsg != 'ok')exit($bmsg); $this->upsueeccmids($mid, $fileid, $updatedt, 1); } if($type==9){ $this->rock->createdir($filepath); $this->beifenfile($filepath); @$bo = file_put_contents($filepath, $fcont); if(!$bo)exit('无法写入：'.$filepath.''); } if($type==10){ $this->rock->createdir($filepath); @file_put_contents($filepath, $fcont); $sbo = $this->db->query($fcont); } } $udt = $data['updatedt']; }else{ $udt = $this->now; } if($oi+1 == $len){ $this->upsueecc($mid, $udt, $key); } echo 'ok'; } private function beifenfile($path) { if(!file_exists($path))return; $wz = strripos($path, '/'); $dir = ''; if($wz===false){ $file = $path; }else{ $dir = substr($path, 0, $wz); $file = substr($path, $wz+1); } $dir = str_replace('/','-', $dir); $nfile = ''.$dir.''.date('YmdHis').'@'.$file.''; $topath = ''.UPDIR.'/logs/'.date('Y-m').'/'.$nfile.''; $this->rock->createdir($topath); @copy($path, $topath); } private function shengjifile($frs, $key, $modeid) { $fid = $frs['id']; $where = ""`type`=1 and `mid`='$fid'""; $db = m('chargems'); $ors = $db->getone($where); if($ors){ if($frs['updatedt']<=$ors['optdt'])return; }else{ $where = ''; } $barr = c('xinhu')->getdata('getfileinstall',array('id'=>$fid,'sysnum'=>$this->keyss,'key'=>$key)); if($barr['code']!=200)exit($barr['msg']); $fcont = $this->jm->base64decode($barr['data']); if(isempt($fcont))return; $mkdir = ''.UPDIR.'/'.date('Y-m'); if($frs['type']==0){ if(!is_dir($mkdir))mkdir($mkdir); $filemy = $mkdir.'/install'.time().rand(1000,9999).'.zip'; file_put_contents($filemy, $fcont); $bmsg = c('zip')->unzip($filemy,'./'); unlink($filemy); if($bmsg != 'ok')exit($bmsg); } if($frs['type']==1){ $bmsg = m('beifen')->updatefabric($fcont); if($bmsg != 'ok')exit($bmsg); } $db->record(array( 'type' => 1, 'mid' => $fid, 'modeid' => $modeid, 'updatedt' => $frs['updatedt'], 'optdt' => $this->now, ),$where); } public function tontbudataAjax() { $lx = (int)$this->get('lx'); $snum = $this->get('snum'); $barr = c('xinhu')->getdata('getaneydata', array('lx'=>$lx,'snum'=>$snum,'ban'=>$this->post('ban'))); if($barr['code']!=200)exit($barr['msg']); $data = $barr['data']; if(URL=='http://127.0.0.1/app/xinhu/')exit('本地测试完成'); $msgr = ''; if($lx==0)$this->tonbbumenu($data['menu']); if($lx==1)$msgr=$this->tonbbumode($data['mode']); if($lx==4)$this->tonbbumodewq($data['mode']); if($lx==2)$this->tonbbuying($data['yydata']); if($lx==3)$this->tonbbutask($data['task']); if($lx==5)$msgr=$this->tonbbumode($data['mode'],$snum); echo '同步完成'.$msgr.''; } private function tonbbumenu($data) { $db = m('menu'); $caid = '0'; foreach($data as $k=>$rs){ $id = $rs['id']; if($db->rows('id='.$id.'')>0){ unset($rs['status']); unset($rs['ispir']); unset($rs['ishs']); if(isempt($rs['num']))unset($rs['num']); if(isempt($rs['color']))unset($rs['color']); if(isempt($rs['icons']))unset($rs['icons']); $db->update($rs, 'id='.$id.''); }else{ $db->insert($rs); } $caid.=','.$id.''; } $db->update('status=0','id not in('.$caid.')'); } private function tonbbumenuss($data, $pid,$npid, $db){ foreach($data as $k=>$rs){ if($rs['pid']==$pid){ $name = $rs['name']; $id = $rs['id']; $where1 = "" and `name`='$name'""; if(!isempt($rs['url']))$where1 = "" and (`name`='$name' or `url`='"".$rs['url'].""')""; $where = ""`pid`='$npid' $where1""; $yid = (int)$db->getmou('id', $where); unset($rs['id']); $rs['optdt'] = $this->rock->now; if($yid==0){ $rs['pid']= $npid; $this->addci++; $yid= $db->insert($rs); }else{ $this->eddci++; unset($rs['status']); unset($rs['ispir']); unset($rs['ishs']); if(isempt($rs['num']))unset($rs['num']); if(isempt($rs['color']))unset($rs['color']); if(isempt($rs['icons']))unset($rs['icons']); $db->update($rs, $yid); } $npid1 = $yid; $this->tonbbumenuss($data, $id, $npid1, $db); } } } private function tonbbumode($data, $snum='') { $zcis = 0; $db = m('flow_set'); $db1 = m('flow_element'); $db2 = m('flow_menu'); $db3 = m('flow_extent'); $db5 = m('flow_course'); $db6 = m('flow_where'); $db7 = m('flow_todo'); $iszdbo = false; if(!isempt($snum))$iszdbo= true; foreach($data as $num=>$arr){ if($iszdbo && $num!=$snum)continue; $moders = $db->getone(""`num`='$num'"",'`id`,`isup`,`name`'); $modeid = 0; $isup = 1; if($moders){ $modeid = (int)$moders['id']; $isup = (int)$moders['isup']; if($isup==0){ if($num==$snum)exit('此['.$snum.'.'.$moders['name'].']模块未开启同步更新'); continue; } } $flow_set = $arr['flow_set']; if(isset($flow_set['id']))unset($flow_set['id']); $isadd = false; if($modeid==0){ $modeid = $db->insert($flow_set); $isadd = true; }else{ if($iszdbo){ unset($flow_set['name']); unset($flow_set['pctx']); unset($flow_set['mctx']); unset($flow_set['wxtx']); unset($flow_set['emtx']); unset($flow_set['receid']); unset($flow_set['recename']); unset($flow_set['status']); $db->update($flow_set, $modeid); }else{ $db->update(array( 'where' => $flow_set['where'], 'sort' => $flow_set['sort'], 'type' => $flow_set['type'], 'summary' => $flow_set['summary'], 'summarx' => $flow_set['summarx'], 'tables' => $flow_set['tables'], 'names' => $flow_set['names'], 'isscl' => $flow_set['isscl'], 'statusstr' => $flow_set['statusstr'] ), $modeid); } } $flow_where = $arr['flow_where']; $sid6 = '0'; foreach($flow_where as $k6=>$rs6){ $rs6['setid'] = $modeid; if(isset($rs6['id']))unset($rs6['id']); $num = $rs6['num']; if(isempt($num))continue; $where = ""`setid`='$modeid' and `num`='$num'""; if($db6->rows($where)==0){ $db6->insert($rs6); }else{ $db6->update($rs6, $where); } } $flow_element= $arr['flow_element']; $sid1s = '0'; foreach($flow_element as $k1=>$rs1){ $rs1['mid'] = $modeid; if(isset($rs1['id']))unset($rs1['id']); $where = ""`mid`='$modeid' and `fields`='"".$rs1['fields'].""' and `iszb`='"".$rs1['iszb'].""'""; if($db1->rows($where)==0){ $sid1 = $db1->insert($rs1); }else{ unset($rs1['name']); $db1->update($rs1, $where); $sid1 = $db1->getmou('id', $where); } $sid1s.=','.$sid1.''; } if($iszdbo){ $db1->delete(""`mid`='$modeid' and `id` not in($sid1s)""); } $flow_extent= $arr['flow_extent']; foreach($flow_extent as $k3=>$rs3){ $rs3['modeid'] = $modeid; $sid = $rs3['id']; if($db3->rows('id='.$sid.'')>0){ $db3->update($rs3, 'id='.$sid.''); }else{ $db3->insert($rs3); } } $flow_menu= $arr['flow_menu']; if($flow_menu){ $sids = '0'; foreach($flow_menu as $k2=>$rs2){ $rs2['setid'] = $modeid; $sid = $rs2['id']; if($db2->rows('id='.$sid.'')>0){ $sids.=','.$sid.''; $db2->update($rs2, 'id='.$sid.''); }else{ $db2->insert($rs2); $sids.=','.$this->db->insert_id().''; } } $db2->delete(""`setid`='$modeid' and `id` not in($sids)""); } if(isset($arr['flow_course'])){ if($db5->rows('setid='.$modeid.'')==0){ $flow_course = $arr['flow_course']; foreach($flow_course as $k5=>$rs5){ if(isset($rs5['id']))unset($rs5['id']); $rs5['setid'] = $modeid; $db5->insert($rs5); } } } if(isset($arr['flow_todo'])){ $flow_todo = $arr['flow_todo']; $sids7 = '0'; foreach($flow_todo as $k7=>$rs7){ if(isset($rs7['id']))unset($rs7['id']); $rs7['setid'] = $modeid; $where = ""`setid`='$modeid' and `name`='"".$rs7['name'].""'""; if($db7->rows($where)==0){ $sid7 = $db7->insert($rs7); }else{ $db7->update($rs7, $where); $sid7 = $db7->getmou('id', $where); } $sids7.=','.$sid7.''; } } $zcis++; } return '共'.$zcis.'个模块'; } private function tonbbumodewq($data) { $db = m('flow_set'); $this->initstalltable('flow_set'); $this->initstalltable('flow_element'); $this->initstalltable('flow_menu'); $this->initstalltable('flow_extent'); $this->initstalltable('flow_course'); $this->initstalltable('flow_where'); $this->initstalltable('flow_todo'); foreach($data as $num=>$arr){ $flow_set = $arr['flow_set']; $flow_element = $arr['flow_element']; $flow_menu = $arr['flow_menu']; $flow_extent = $arr['flow_extent']; $flow_course = $arr['flow_course']; $flow_where = $arr['flow_where']; $flow_todo = $arr['flow_todo']; $db->insert($flow_set); $this->insertdata($flow_element, 'flow_element'); $this->insertdata($flow_menu, 'flow_menu'); $this->insertdata($flow_extent, 'flow_extent'); $this->insertdata($flow_course, 'flow_course'); $this->insertdata($flow_where, 'flow_where'); $this->insertdata($flow_todo, 'flow_todo'); } } private function initstalltable($table) { $sql1 = ""delete from `[Q]"".$table.""`""; $sql2 = ""alter table `[Q]"".$table.""` AUTO_INCREMENT=1""; $this->db->query($sql1, false); $this->db->query($sql2, false); } private function insertdata($data, $table) { $db = m($table); if($data)foreach($data as $k=>$rs){ $db->insert($rs); } } private function tonbbuying($data) { $db = m('im_group'); $dbs = m('im_menu'); foreach($data as $k=>$yydata){ $rs = $yydata['data']; $menu = $yydata['menu']; $name = $rs['name']; unset($rs['id']); $where = ""`name`='$name' and `type`=2""; if(!isempt($rs['num']))$where = ""`num`='"".$rs['num'].""' and `type`=2""; if($db->rows($where)==0){ $mid = $db->insert($rs); $this->addyymenu($menu, $dbs, $mid, 0); }else{ $mid = (int)$db->getmou('id', $where); $db->update(array( 'face' => $rs['face'], 'url' => $rs['url'], 'types' => $rs['types'], 'sort' => $rs['sort'], 'urlpc' => $rs['urlpc'], 'urlm' => $rs['urlm'], 'yylx' => $rs['yylx'], 'name' => $rs['name'], 'iconfont' => $rs['iconfont'], 'iconcolor' => $rs['iconcolor'], 'explain' => $rs['explain'], ),$where); $this->addyymenu($menu, $dbs, $mid, 0); } } } private function addyymenu($menu, $dbs, $mid, $pid) { $ssid = '0'; foreach($menu as $k1=>$rs1){ unset($rs1['id']); $menusub = false; if(isset($rs1['menusub'])){ $menusub = $rs1['menusub']; unset($rs1['menusub']); } $rs1['mid'] = $mid; $rs1['pid'] = $pid; $where = ""`name`='"".$rs1['name'].""' and `pid`='$pid' and `mid`='$mid'""; $sid = (int)$dbs->getmou('id', $where); if($sid == 0){ $where = ''; } $dbs->record($rs1, $where); if($sid==0)$sid = $this->db->insert_id(); if($menusub)$this->addyymenu($menusub, $dbs, $mid, $sid); $ssid .= ','.$sid.''; } $dbs->delete(""pid='$pid' and `mid`='$mid' and `id` not in($ssid)""); } private function tonbbutask($data) { $db = m('task'); foreach($data as $k=>$rs){ $where = ""`url`='"".$rs['url'].""'""; $sid = (int)$db->getmou('id', $where); if($sid == 0){ $where = ''; }else{ unset($rs['todoid']); unset($rs['todoname']); } unset($rs['id']); unset($rs['state']); unset($rs['lastdt']); $db->record($rs, $where); } } public function delmodelAjax() { $id = (int)$this->post('id'); m('chargems')->delete(""`modeid`='$id' and `type`<>2 and `modeid`>0""); $this->showreturn(''); } public function datadubiAjax() { $id = (int)$this->get('id'); $barr = c('xinhu')->getdata('getinstallfile',array('id'=>$id,'sysnum'=>$this->keyss)); if($barr['code']!=200)showreturn('',$barr['msg'],201); $data = $barr['data']; $mrs = $data['rs']; $rows = $data['rows']; $uparr = array(); $morrs = $this->getmodeuprs($rows); foreach($rows as $k=>$rs){ $file = $rs['filepath']; $bo = true; $zt = 'add'; if(file_exists($file)){ $_size = filesize($file); if($_size == $rs['filesize'])$bo = false; $zt = 'edit'; } if($rs['type']==1)$zt = ''; if($rs['isup']==1)$bo = true; $rs['ting'] = 0; if(in_array($file, $morrs))$rs['ting'] = 1; if($bo){ $rs['zt']= $zt; $uparr[] = $rs; } } $huira = $this->gethuiarr($id); $sarr1 = $sarr2 = array(); $strh = ''; foreach($uparr as $k=>$rs1){ $ishui = 0; if(isset($huira[$rs1['id']]))$ishui = 1; if($rs1['ting']==1)$ishui=1; $uparr[$k]['ishui'] = $ishui; if($ishui==1){ $sarr2[] = $uparr[$k]; }else{ $sarr1[] = $uparr[$k]; } } $this->returnjson(array('strh'=>$strh,'rows'=>array_merge($sarr1, $sarr2))); } private function gethuiarr($id) { $hurs = m('chargems')->getall(""`modeid`='$id' and `type`=2"",'mid'); $huira = array(); foreach($hurs as $k2=>$rs2)$huira[$rs2['mid']] = 1; return $huira; } public function hullueAjax() { $id = (int)$this->post('id'); $lx = (int)$this->post('lx'); $sid = $this->post('sid'); $db = m('chargems'); $db->delete(""`modeid`='$id' and `mid` in($sid) and `type`=2""); $sad = explode(',', $sid); if($lx==0)foreach($sad as $sids){ $db->insert(array( 'optdt' => $this->now, 'type' => 2, 'mid' => $sids, 'modeid' => $id )); } echo 'ok'; } }"
874,copy,文件操作函数中存在变量，可能存在任意文件读取/删除/修改/写入等漏洞,D:\phpstudy_pro\WWW\cms\xinhu\webmain\system\upgrade\upgradeAction.php,第8行,"class upgradeClassAction extends Action { public function initAction() { $this->keyss = $this->option->getval('systemnum'); if(isempt($this->keyss)){ $rnd = md5(str_shuffle('abcedfghijk').rand(1000,9999)); $this->option->setval('systemnum', $rnd); $this->keyss = $rnd; } } public function dataAjax() { $xinhu = c('xinhu'); $db = m('chargems'); $wet = $xinhu->getwebsite(); $barr = $xinhu->getdata('mode',array('sysnum'=>$this->keyss)); if($barr['code']!=200)exit($barr['msg']); $rows = array(); $wodekey= $this->jm->getRandkey(); foreach($barr['data'] as $k=>$rs){ $id = $rs['id']; $state = 0; $key = ''; $ors = $db->getone(""`type`=0 and `mid`='$id'""); if($ors){ $state = 1; if($rs['updatedt']>$ors['updatedt'])$state=2; $key= $ors['key']; } $view = '<a href=""'.$wet.'view_'.$rs['num'].'.html"" target=""_blank"" class=""a"">介绍</a>'; if($state==0 && $rs['price']>0)$view.=',<a href=""'.$wet.'view_'.$rs['num'].'.html"" target=""_blank"" style=""color:red"">去购买</a>'; $rows[] = array( 'id' => $id, 'name' => $rs['name'], 'price' => $rs['price'], 'isaz' => $rs['isaz'], 'explain' => $rs['explain'], 'updatedt' => $rs['updatedt'], 'key' => $key, 'view' => $view, 'opt' => $state ); if($k==0)$wodekey = $rs['wodekey']; } $arr['rows'] = $rows; $arr['wodekey'] = $wodekey; $this->returnjson($arr); } public function shengjianAjax() { $id = $this->post('id'); $key = $this->post('key'); if(!isempt($key) && $this->rock->isjm($key))$key = $this->jm->uncrypt($key); $barr = c('xinhu')->getdata('getinstallfile',array('id'=>$id,'sysnum'=>$this->keyss,'key'=>$key)); if($barr['code']!=200)showreturn('',$barr['msg'],201); $data = $barr['data']; $mrs = $data['rs']; $rows = $data['rows']; $uparr = array(); $huira = $this->gethuiarr($id); $morrs = $this->getmodeuprs($rows); foreach($rows as $k=>$rs){ $file = $rs['filepath']; $bo = true; if(file_exists($file)){ $_size = filesize($file); if($_size == $rs['filesize'])$bo = false; } if($rs['isup']==1)$bo = true; if(isset($huira[$rs['id']]))$bo = false; if(in_array($file, $morrs))$bo = false; if($bo){ $uparr[] = $rs; } } if(!$uparr){ $this->upsueecc($id, $mrs['updatedt'], $key); } showreturn($uparr); } private function upsueecc($id, $updatedt, $key) { $where = ""`type`=0 and `mid`='$id'""; $db = m('chargems'); if($db->rows($where)==0)$where=''; $db->record(array( 'type' => 0, 'mid' => $id, 'modeid' => $id, 'updatedt' => $updatedt, 'optdt' => $this->now, 'key' => $this->jm->encrypt($key) ),$where); } private function upsueeccmids($modeid, $mid, $updatedt, $type=1) { $where = ""`type`='$type' and `mid`='$mid'""; $db = m('chargems'); if($db->rows($where)==0)$where=''; $db->record(array( 'type' => $type, 'mid' => $mid, 'modeid' => $modeid, 'updatedt' => $updatedt, 'optdt' => $this->now, ),$where); } private function getmodeuprs($frows) { $rows = m('flow_set')->getall('1=1', '`num`,`status`,`isup`'); $hurs = array(); $nomok= array(); $huwj = getconfig('noupgrademode'); if($huwj)$nomok = explode(',', $huwj); foreach($rows as $k=>$rs){ $num = $rs['num']; if($rs['isup']=='0'){ $nomok[]= $num; } } foreach($nomok as $num){ $hurs[] = ''.P.'/flow/input/inputjs/mode_'.$num.'.js'; $hurs[] = ''.P.'/flow/input/mode_'.$num.'Action.php'; $hurs[] = ''.P.'/flow/page/input_'.$num.'.html'; $hurs[] = ''.P.'/flow/page/view_'.$num.'_0.html'; $hurs[] = ''.P.'/flow/page/view_'.$num.'_1.html'; $hurs[] = ''.P.'/flow/page/view_'.$num.'_2.html'; $hurs[] = ''.P.'/flow/page/viewpage_'.$num.'.html'; $hurs[] = ''.P.'/flow/page/viewpage_'.$num.'_0.html'; $hurs[] = ''.P.'/flow/page/viewpage_'.$num.'_1.html'; $hurs[] = ''.P.'/flow/page/rock_page_'.$num.'.php'; $hurs[] = ''.P.'/model/flow/'.$num.'Model.php'; } return $hurs; } public function shengjianssAjax() { $mid = (int)$this->post('id'); $fileid = (int)$this->post('fileid'); $key = $this->post('key'); if(!isempt($key) && $this->rock->isjm($key))$key = $this->jm->uncrypt($key); $oi = $this->post('oii'); $len = $this->post('lens'); $updatedt = $this->post('updatedt'); $upbo = true; $ors = m('chargems')->getone(""`type`=1 and `mid`='$fileid'""); if($ors && $updatedt<=$ors['optdt'])$upbo = false; if(isempt($updatedt))$upbo = true; if($upbo){ $barr = c('xinhu')->getdata('getinstallfileid',array('fid'=>$fileid,'sysnum'=>$this->keyss,'key'=>$key,'ban'=>$this->post('ban'))); if($barr['code'] != 200)exit($barr['msg']); $data = $barr['data']; $type = $data['type']; $filepath = $data['filepath']; $fcont = $this->jm->base64decode($data['content']); if($fcont != ''){ if($type==1){ $bmsg = m('beifen')->updatefabric($fcont); if($bmsg != 'ok')exit($bmsg); $this->upsueeccmids($mid, $fileid, $updatedt, 1); } if($type==9){ $this->rock->createdir($filepath); $this->beifenfile($filepath); @$bo = file_put_contents($filepath, $fcont); if(!$bo)exit('无法写入：'.$filepath.''); } if($type==10){ $this->rock->createdir($filepath); @file_put_contents($filepath, $fcont); $sbo = $this->db->query($fcont); } } $udt = $data['updatedt']; }else{ $udt = $this->now; } if($oi+1 == $len){ $this->upsueecc($mid, $udt, $key); } echo 'ok'; } private function beifenfile($path) { if(!file_exists($path))return; $wz = strripos($path, '/'); $dir = ''; if($wz===false){ $file = $path; }else{ $dir = substr($path, 0, $wz); $file = substr($path, $wz+1); } $dir = str_replace('/','-', $dir); $nfile = ''.$dir.''.date('YmdHis').'@'.$file.''; $topath = ''.UPDIR.'/logs/'.date('Y-m').'/'.$nfile.''; $this->rock->createdir($topath); @copy($path, $topath); } private function shengjifile($frs, $key, $modeid) { $fid = $frs['id']; $where = ""`type`=1 and `mid`='$fid'""; $db = m('chargems'); $ors = $db->getone($where); if($ors){ if($frs['updatedt']<=$ors['optdt'])return; }else{ $where = ''; } $barr = c('xinhu')->getdata('getfileinstall',array('id'=>$fid,'sysnum'=>$this->keyss,'key'=>$key)); if($barr['code']!=200)exit($barr['msg']); $fcont = $this->jm->base64decode($barr['data']); if(isempt($fcont))return; $mkdir = ''.UPDIR.'/'.date('Y-m'); if($frs['type']==0){ if(!is_dir($mkdir))mkdir($mkdir); $filemy = $mkdir.'/install'.time().rand(1000,9999).'.zip'; file_put_contents($filemy, $fcont); $bmsg = c('zip')->unzip($filemy,'./'); unlink($filemy); if($bmsg != 'ok')exit($bmsg); } if($frs['type']==1){ $bmsg = m('beifen')->updatefabric($fcont); if($bmsg != 'ok')exit($bmsg); } $db->record(array( 'type' => 1, 'mid' => $fid, 'modeid' => $modeid, 'updatedt' => $frs['updatedt'], 'optdt' => $this->now, ),$where); } public function tontbudataAjax() { $lx = (int)$this->get('lx'); $snum = $this->get('snum'); $barr = c('xinhu')->getdata('getaneydata', array('lx'=>$lx,'snum'=>$snum,'ban'=>$this->post('ban'))); if($barr['code']!=200)exit($barr['msg']); $data = $barr['data']; if(URL=='http://127.0.0.1/app/xinhu/')exit('本地测试完成'); $msgr = ''; if($lx==0)$this->tonbbumenu($data['menu']); if($lx==1)$msgr=$this->tonbbumode($data['mode']); if($lx==4)$this->tonbbumodewq($data['mode']); if($lx==2)$this->tonbbuying($data['yydata']); if($lx==3)$this->tonbbutask($data['task']); if($lx==5)$msgr=$this->tonbbumode($data['mode'],$snum); echo '同步完成'.$msgr.''; } private function tonbbumenu($data) { $db = m('menu'); $caid = '0'; foreach($data as $k=>$rs){ $id = $rs['id']; if($db->rows('id='.$id.'')>0){ unset($rs['status']); unset($rs['ispir']); unset($rs['ishs']); if(isempt($rs['num']))unset($rs['num']); if(isempt($rs['color']))unset($rs['color']); if(isempt($rs['icons']))unset($rs['icons']); $db->update($rs, 'id='.$id.''); }else{ $db->insert($rs); } $caid.=','.$id.''; } $db->update('status=0','id not in('.$caid.')'); } private function tonbbumenuss($data, $pid,$npid, $db){ foreach($data as $k=>$rs){ if($rs['pid']==$pid){ $name = $rs['name']; $id = $rs['id']; $where1 = "" and `name`='$name'""; if(!isempt($rs['url']))$where1 = "" and (`name`='$name' or `url`='"".$rs['url'].""')""; $where = ""`pid`='$npid' $where1""; $yid = (int)$db->getmou('id', $where); unset($rs['id']); $rs['optdt'] = $this->rock->now; if($yid==0){ $rs['pid']= $npid; $this->addci++; $yid= $db->insert($rs); }else{ $this->eddci++; unset($rs['status']); unset($rs['ispir']); unset($rs['ishs']); if(isempt($rs['num']))unset($rs['num']); if(isempt($rs['color']))unset($rs['color']); if(isempt($rs['icons']))unset($rs['icons']); $db->update($rs, $yid); } $npid1 = $yid; $this->tonbbumenuss($data, $id, $npid1, $db); } } } private function tonbbumode($data, $snum='') { $zcis = 0; $db = m('flow_set'); $db1 = m('flow_element'); $db2 = m('flow_menu'); $db3 = m('flow_extent'); $db5 = m('flow_course'); $db6 = m('flow_where'); $db7 = m('flow_todo'); $iszdbo = false; if(!isempt($snum))$iszdbo= true; foreach($data as $num=>$arr){ if($iszdbo && $num!=$snum)continue; $moders = $db->getone(""`num`='$num'"",'`id`,`isup`,`name`'); $modeid = 0; $isup = 1; if($moders){ $modeid = (int)$moders['id']; $isup = (int)$moders['isup']; if($isup==0){ if($num==$snum)exit('此['.$snum.'.'.$moders['name'].']模块未开启同步更新'); continue; } } $flow_set = $arr['flow_set']; if(isset($flow_set['id']))unset($flow_set['id']); $isadd = false; if($modeid==0){ $modeid = $db->insert($flow_set); $isadd = true; }else{ if($iszdbo){ unset($flow_set['name']); unset($flow_set['pctx']); unset($flow_set['mctx']); unset($flow_set['wxtx']); unset($flow_set['emtx']); unset($flow_set['receid']); unset($flow_set['recename']); unset($flow_set['status']); $db->update($flow_set, $modeid); }else{ $db->update(array( 'where' => $flow_set['where'], 'sort' => $flow_set['sort'], 'type' => $flow_set['type'], 'summary' => $flow_set['summary'], 'summarx' => $flow_set['summarx'], 'tables' => $flow_set['tables'], 'names' => $flow_set['names'], 'isscl' => $flow_set['isscl'], 'statusstr' => $flow_set['statusstr'] ), $modeid); } } $flow_where = $arr['flow_where']; $sid6 = '0'; foreach($flow_where as $k6=>$rs6){ $rs6['setid'] = $modeid; if(isset($rs6['id']))unset($rs6['id']); $num = $rs6['num']; if(isempt($num))continue; $where = ""`setid`='$modeid' and `num`='$num'""; if($db6->rows($where)==0){ $db6->insert($rs6); }else{ $db6->update($rs6, $where); } } $flow_element= $arr['flow_element']; $sid1s = '0'; foreach($flow_element as $k1=>$rs1){ $rs1['mid'] = $modeid; if(isset($rs1['id']))unset($rs1['id']); $where = ""`mid`='$modeid' and `fields`='"".$rs1['fields'].""' and `iszb`='"".$rs1['iszb'].""'""; if($db1->rows($where)==0){ $sid1 = $db1->insert($rs1); }else{ unset($rs1['name']); $db1->update($rs1, $where); $sid1 = $db1->getmou('id', $where); } $sid1s.=','.$sid1.''; } if($iszdbo){ $db1->delete(""`mid`='$modeid' and `id` not in($sid1s)""); } $flow_extent= $arr['flow_extent']; foreach($flow_extent as $k3=>$rs3){ $rs3['modeid'] = $modeid; $sid = $rs3['id']; if($db3->rows('id='.$sid.'')>0){ $db3->update($rs3, 'id='.$sid.''); }else{ $db3->insert($rs3); } } $flow_menu= $arr['flow_menu']; if($flow_menu){ $sids = '0'; foreach($flow_menu as $k2=>$rs2){ $rs2['setid'] = $modeid; $sid = $rs2['id']; if($db2->rows('id='.$sid.'')>0){ $sids.=','.$sid.''; $db2->update($rs2, 'id='.$sid.''); }else{ $db2->insert($rs2); $sids.=','.$this->db->insert_id().''; } } $db2->delete(""`setid`='$modeid' and `id` not in($sids)""); } if(isset($arr['flow_course'])){ if($db5->rows('setid='.$modeid.'')==0){ $flow_course = $arr['flow_course']; foreach($flow_course as $k5=>$rs5){ if(isset($rs5['id']))unset($rs5['id']); $rs5['setid'] = $modeid; $db5->insert($rs5); } } } if(isset($arr['flow_todo'])){ $flow_todo = $arr['flow_todo']; $sids7 = '0'; foreach($flow_todo as $k7=>$rs7){ if(isset($rs7['id']))unset($rs7['id']); $rs7['setid'] = $modeid; $where = ""`setid`='$modeid' and `name`='"".$rs7['name'].""'""; if($db7->rows($where)==0){ $sid7 = $db7->insert($rs7); }else{ $db7->update($rs7, $where); $sid7 = $db7->getmou('id', $where); } $sids7.=','.$sid7.''; } } $zcis++; } return '共'.$zcis.'个模块'; } private function tonbbumodewq($data) { $db = m('flow_set'); $this->initstalltable('flow_set'); $this->initstalltable('flow_element'); $this->initstalltable('flow_menu'); $this->initstalltable('flow_extent'); $this->initstalltable('flow_course'); $this->initstalltable('flow_where'); $this->initstalltable('flow_todo'); foreach($data as $num=>$arr){ $flow_set = $arr['flow_set']; $flow_element = $arr['flow_element']; $flow_menu = $arr['flow_menu']; $flow_extent = $arr['flow_extent']; $flow_course = $arr['flow_course']; $flow_where = $arr['flow_where']; $flow_todo = $arr['flow_todo']; $db->insert($flow_set); $this->insertdata($flow_element, 'flow_element'); $this->insertdata($flow_menu, 'flow_menu'); $this->insertdata($flow_extent, 'flow_extent'); $this->insertdata($flow_course, 'flow_course'); $this->insertdata($flow_where, 'flow_where'); $this->insertdata($flow_todo, 'flow_todo'); } } private function initstalltable($table) { $sql1 = ""delete from `[Q]"".$table.""`""; $sql2 = ""alter table `[Q]"".$table.""` AUTO_INCREMENT=1""; $this->db->query($sql1, false); $this->db->query($sql2, false); } private function insertdata($data, $table) { $db = m($table); if($data)foreach($data as $k=>$rs){ $db->insert($rs); } } private function tonbbuying($data) { $db = m('im_group'); $dbs = m('im_menu'); foreach($data as $k=>$yydata){ $rs = $yydata['data']; $menu = $yydata['menu']; $name = $rs['name']; unset($rs['id']); $where = ""`name`='$name' and `type`=2""; if(!isempt($rs['num']))$where = ""`num`='"".$rs['num'].""' and `type`=2""; if($db->rows($where)==0){ $mid = $db->insert($rs); $this->addyymenu($menu, $dbs, $mid, 0); }else{ $mid = (int)$db->getmou('id', $where); $db->update(array( 'face' => $rs['face'], 'url' => $rs['url'], 'types' => $rs['types'], 'sort' => $rs['sort'], 'urlpc' => $rs['urlpc'], 'urlm' => $rs['urlm'], 'yylx' => $rs['yylx'], 'name' => $rs['name'], 'iconfont' => $rs['iconfont'], 'iconcolor' => $rs['iconcolor'], 'explain' => $rs['explain'], ),$where); $this->addyymenu($menu, $dbs, $mid, 0); } } } private function addyymenu($menu, $dbs, $mid, $pid) { $ssid = '0'; foreach($menu as $k1=>$rs1){ unset($rs1['id']); $menusub = false; if(isset($rs1['menusub'])){ $menusub = $rs1['menusub']; unset($rs1['menusub']); } $rs1['mid'] = $mid; $rs1['pid'] = $pid; $where = ""`name`='"".$rs1['name'].""' and `pid`='$pid' and `mid`='$mid'""; $sid = (int)$dbs->getmou('id', $where); if($sid == 0){ $where = ''; } $dbs->record($rs1, $where); if($sid==0)$sid = $this->db->insert_id(); if($menusub)$this->addyymenu($menusub, $dbs, $mid, $sid); $ssid .= ','.$sid.''; } $dbs->delete(""pid='$pid' and `mid`='$mid' and `id` not in($ssid)""); } private function tonbbutask($data) { $db = m('task'); foreach($data as $k=>$rs){ $where = ""`url`='"".$rs['url'].""'""; $sid = (int)$db->getmou('id', $where); if($sid == 0){ $where = ''; }else{ unset($rs['todoid']); unset($rs['todoname']); } unset($rs['id']); unset($rs['state']); unset($rs['lastdt']); $db->record($rs, $where); } } public function delmodelAjax() { $id = (int)$this->post('id'); m('chargems')->delete(""`modeid`='$id' and `type`<>2 and `modeid`>0""); $this->showreturn(''); } public function datadubiAjax() { $id = (int)$this->get('id'); $barr = c('xinhu')->getdata('getinstallfile',array('id'=>$id,'sysnum'=>$this->keyss)); if($barr['code']!=200)showreturn('',$barr['msg'],201); $data = $barr['data']; $mrs = $data['rs']; $rows = $data['rows']; $uparr = array(); $morrs = $this->getmodeuprs($rows); foreach($rows as $k=>$rs){ $file = $rs['filepath']; $bo = true; $zt = 'add'; if(file_exists($file)){ $_size = filesize($file); if($_size == $rs['filesize'])$bo = false; $zt = 'edit'; } if($rs['type']==1)$zt = ''; if($rs['isup']==1)$bo = true; $rs['ting'] = 0; if(in_array($file, $morrs))$rs['ting'] = 1; if($bo){ $rs['zt']= $zt; $uparr[] = $rs; } } $huira = $this->gethuiarr($id); $sarr1 = $sarr2 = array(); $strh = ''; foreach($uparr as $k=>$rs1){ $ishui = 0; if(isset($huira[$rs1['id']]))$ishui = 1; if($rs1['ting']==1)$ishui=1; $uparr[$k]['ishui'] = $ishui; if($ishui==1){ $sarr2[] = $uparr[$k]; }else{ $sarr1[] = $uparr[$k]; } } $this->returnjson(array('strh'=>$strh,'rows'=>array_merge($sarr1, $sarr2))); } private function gethuiarr($id) { $hurs = m('chargems')->getall(""`modeid`='$id' and `type`=2"",'mid'); $huira = array(); foreach($hurs as $k2=>$rs2)$huira[$rs2['mid']] = 1; return $huira; } public function hullueAjax() { $id = (int)$this->post('id'); $lx = (int)$this->post('lx'); $sid = $this->post('sid'); $db = m('chargems'); $db->delete(""`modeid`='$id' and `mid` in($sid) and `type`=2""); $sad = explode(',', $sid); if($lx==0)foreach($sad as $sids){ $db->insert(array( 'optdt' => $this->now, 'type' => 2, 'mid' => $sids, 'modeid' => $id )); } echo 'ok'; } }"
875,file_get_contents,文件操作函数中存在变量，可能存在任意文件读取/删除/修改/写入等漏洞,D:\phpstudy_pro\WWW\cms\xinhu\webmain\task\api\asynrunAction.php,第137行,"			$cont = file_get_contents($pdfpath);
"
876,file_get_contents,文件操作函数中存在变量，可能存在任意文件读取/删除/修改/写入等漏洞,D:\phpstudy_pro\WWW\cms\xinhu\webmain\task\api\loginAction.php,第73行,"			$str = base64_encode(file_get_contents($path));
"
877,file_get_contents,文件操作函数中存在变量，可能存在任意文件读取/删除/修改/写入等漏洞,D:\phpstudy_pro\WWW\cms\xinhu\webmain\task\api\loginAction.php,第73行,"			$str = base64_encode(file_get_contents($path));
"
878,file_get_contents,文件操作函数中存在变量，可能存在任意文件读取/删除/修改/写入等漏洞,D:\phpstudy_pro\WWW\cms\xinhu\webmain\task\api\uploadAction.php,第170行,"			@$cont = file_get_contents($path);
"
879,unlink,文件操作函数中存在变量，可能存在任意文件读取/删除/修改/写入等漏洞,D:\phpstudy_pro\WWW\cms\xinhu\webmain\task\api\uploadAction.php,第177行,"			@unlink($path);
"
880,`$,``反引号中包含变量，变量可控会导致命令执行漏洞,D:\phpstudy_pro\WWW\cms\xinhu\webmain\task\runt\beifenAction.php,第23行,"			$strstr	.= ""DROP TABLE IF EXISTS `$tabs`;\n"";
"
881,`$,``反引号中包含变量，变量可控会导致命令执行漏洞,D:\phpstudy_pro\WWW\cms\xinhu\webmain\task\runt\beifenAction.php,第35行,"				$strstr	.= ""INSERT INTO `$tabs` VALUES("".substr($vstr,1)."");\n"";
"
882,unlink,文件操作函数中存在变量，可能存在任意文件读取/删除/修改/写入等漏洞,D:\phpstudy_pro\WWW\cms\xinhu\webmain\task\runt\beifenAction.php,第52行,"		@unlink($filepath);
"
883,ob_start,"函数中存在变量,可能存在变量覆盖漏洞",D:\phpstudy_pro\WWW\cms\xinhu\webmain\task\runt\runtAction.php,第16行,"		ob_start(); //打开缓冲区
"
884,include_once,"文件包含函数中存在变量,可能存在文件包含漏洞",D:\phpstudy_pro\WWW\cms\xinhu\webmain\task\runt\runtAction.php,第135行,"					include_once($path);
"
885,file_get_contents,文件操作函数中存在变量，可能存在任意文件读取/删除/修改/写入等漏洞,D:\phpstudy_pro\WWW\cms\xinhu\webmain\task\runt\uptoxinhudocAction.php,第38行,"			$data   = base64_encode(file_get_contents($path));
"
886,file_get_contents,文件操作函数中存在变量，可能存在任意文件读取/删除/修改/写入等漏洞,D:\phpstudy_pro\WWW\cms\xinhu\webmain\task\runt\uptoxinhudocAction.php,第88行,"		$data   = base64_encode(file_get_contents($path));
"
887,unlink,文件操作函数中存在变量，可能存在任意文件读取/删除/修改/写入等漏洞,D:\phpstudy_pro\WWW\cms\xinhu\webmain\task\runt\uptoxinhudocAction.php,第138行,"		if(file_exists($path))@unlink($path);
"
888,include_once,"文件包含函数中存在变量,可能存在文件包含漏洞",D:\phpstudy_pro\WWW\cms\xinhu\webmain\we\ying\yingAction.php,第69行,"			include_once($classpath);
"
889,ob_start,"函数中存在变量,可能存在变量覆盖漏洞",D:\phpstudy_pro\WWW\cms\xinhu\install.php,第11行,"ob_start();
"
890,file_get_contents,文件操作函数中存在变量，可能存在任意文件读取/删除/修改/写入等漏洞,D:\phpstudy_pro\WWW\cms\xinhu\install.php,第360行,"					$plugin_config=file_get_contents($plugin_config);
"
891,file_get_contents,文件操作函数中存在变量，可能存在任意文件读取/删除/修改/写入等漏洞,D:\phpstudy_pro\WWW\cms\xinhu\install.php,第367行,"								$plugin_config['install']=file_get_contents($install_file);
"
892,unserialize,序列化函数，可能存在反序列化漏洞,D:\phpstudy_pro\WWW\cms\xinhu\install.php,第470行,"	$res=unserialize(base64_decode($res));
"
893,copy,文件操作函数中存在变量，可能存在任意文件读取/删除/修改/写入等漏洞,D:\phpstudy_pro\WWW\cms\xinhu\install.php,第479行,"	copy($res['files'],$temp);
"
894,unlink,文件操作函数中存在变量，可能存在任意文件读取/删除/修改/写入等漏洞,D:\phpstudy_pro\WWW\cms\xinhu\install.php,第484行,"	@unlink($temp);
"
所涉及敏感函数,漏洞描述,共计个数
eval,命令执行函数中存在变量，可能存在任意命令执行漏洞,9
exec,命令执行函数中存在变量，可能存在任意命令执行漏洞,8
escapeshellcmd,命令执行函数中存在变量，可能存在任意命令执行漏洞,7
require,"文件包含函数中存在变量,可能存在文件包含漏洞",20
require_once,"文件包含函数中存在变量,可能存在文件包含漏洞",9
include,"文件包含函数中存在变量,可能存在文件包含漏洞",7
include_once,"文件包含函数中存在变量,可能存在文件包含漏洞",18
parse_str,"函数中存在变量,可能存在变量覆盖漏洞",6
ob_start,"函数中存在变量,可能存在变量覆盖漏洞",10
foreach,"函数中存在变量,可能存在变量覆盖漏洞",12
foreach,"函数中存在变量,可能存在变量覆盖漏洞",12
foreach,"函数中存在变量,可能存在变量覆盖漏洞",12
foreach,"函数中存在变量,可能存在变量覆盖漏洞",12
file_put_contents,文件操作函数中存在变量，可能存在任意文件读取/删除/修改/写入等漏洞,22
file_get_contents,文件操作函数中存在变量，可能存在任意文件读取/删除/修改/写入等漏洞,173
unlink,文件操作函数中存在变量，可能存在任意文件读取/删除/修改/写入等漏洞,105
copy,文件操作函数中存在变量，可能存在任意文件读取/删除/修改/写入等漏洞,31
rmdirs,文件操作函数中存在变量，可能存在任意文件读取/删除/修改/写入等漏洞,6
fopen,读取文件函数中存在变量，可能存在任意文件读取漏洞,53
fwrite,读取文件函数中存在变量，可能存在任意文件读取漏洞,81
fgets,读取文件函数中存在变量，可能存在任意文件读取漏洞,26
fread,读取文件函数中存在变量，可能存在任意文件读取漏洞,67
$_SERVER['HTTP_X_FORWARDED_FOR'],获取IP地址方式可伪造，HTTP_REFERER可伪造，常见引发SQL注入等漏洞,5
$_SERVER['HTTP_REFERER'],获取IP地址方式可伪造，HTTP_REFERER可伪造，常见引发SQL注入等漏洞,1
array_map,参数包含变量，变量可控可能会导致代码执行漏洞,16
array_filter,参数包含变量，变量可控可能会导致代码执行漏洞,5
extract,函数中存在变量，可能存在变量覆盖漏洞,13
unserialize,序列化函数，可能存在反序列化漏洞,69
simplexml_load_string,可能存在信息泄露漏洞，读取任意文件,64
`$,``反引号中包含变量，变量可控会导致命令执行漏洞,51
